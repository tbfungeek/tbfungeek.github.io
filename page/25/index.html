
 <!DOCTYPE HTML>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  
    <title>Edgar&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Edgar">
    

    
    <meta name="description" content="Android | 全栈工程师">
<meta property="og:type" content="website">
<meta property="og:title" content="Edgar&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/25/index.html">
<meta property="og:site_name" content="Edgar&#39;s Blog">
<meta property="og:description" content="Android | 全栈工程师">
<meta property="og:locale">
<meta property="article:author" content="Edgar">
<meta name="twitter:card" content="summary">

    
    <link rel="alternative" href="atom.xml" title="Edgar&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/unnamed4_n_mSY_icon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/profile.png">
    <link rel="apple-touch-icon-precomposed" href="/img/profile.png">
    
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.2.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Edgar&#39;s Blog">Edgar&#39;s Blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
 					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" name="q" maxlength="20" placeholder="Search" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/12/Android-进阶之Android-绘图-三-画布Canvs以及SurfaceView/" title="Android 进阶之Android 绘图 三 画布Canvs以及SurfaceView" itemprop="url">Android 进阶之Android 绘图 三 画布Canvs以及SurfaceView</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-12T03:31:39.000Z" itemprop="datePublished"> Published 2016-04-12</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="画布-Canvus"><a href="#画布-Canvus" class="headerlink" title="画布 Canvus"></a>画布 Canvus</h3><p>canvas.drawARGB(255,0,0,255);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/1.png"><br>canvas.drawRGB(123,34,45);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/2.png"><br>canvas.drawColor(Color.parseColor(“#343434”));<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/3.png"><br>canvas.drawCircle(400,800,200,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/4.png"></p>
<p>public void drawArc(float left, float top, float right, float bottom, float startAngle,<br>            float sweepAngle, boolean useCenter, @NonNull Paint paint)<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/5.png"><br>canvas.drawArc(200,200,1000,1000,-90,90,false,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/6.png"><br>canvas.drawArc(200,200,1000,1000,-90,90,true,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/7.png"></p>
<p>canvas.drawPoint(100,100,mPaint);<br>canvas.drawPoints(new float[]{100,100,300,300,400,400},mPaint);<br>canvas.drawLine(100,100,400,400,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/8.png"><br>canvas.drawLines(new float[]{100,100,400,600,500,100,200,200},mPaint);<br>&#x2F;&#x2F;这里需要注意的是点坐标数，必须是4的倍数<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/9.png"><br>canvas.drawOval(200,400,800,800,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/10.png"></p>
<p>canvas.drawRect(100,100,600,600,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/11.png"><br>canvas.drawRoundRect(100,100,400,400,100,60,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/12.png"></p>
<p>mPaint.setTextSize(100);<br>canvas.drawText(“Hello Android”,300,400,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/13.png"><br>Path path &#x3D; new Path();<br>path.moveTo(200,200);<br>path.addRect(200,200,400,400, Path.Direction.CW);<br>path.addArc(200,200,800,800,100,300);<br>canvas.drawPath(path,mPaint);<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/14.png"></p>
<p>canvaus 画布操作：</p>
<p>Android 使用Layer堆栈来管理画布的，画布有多个图层，整个结构如下所示，下面就针对图层操作做将要介绍：<br><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/canvus.png"></p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">Canvas</span><span class="selector-class">.save</span>()  用来保存当前的matrix和<span class="attribute">clip</span>到私有的栈中。save之后，可以调用<span class="selector-tag">Canvas</span>的平移、放缩、旋转、错切、裁剪等操作。</span><br><span class="line">任何matrix变换和<span class="attribute">clip</span>操作都会在调用restore的时候还原,它有一个整形返回值可以传入到<span class="built_in">restoreToCount</span>()方法，以返回到某个save状态之前。也可以直接调用restore返回到前一个状态。</span><br><span class="line"><span class="selector-tag">Canvas</span><span class="selector-class">.restore</span>()  将save之前的所有操作和save之后的所有操作合并，它只回到上一个save调用之前的状态。</span><br><span class="line">save和restore要配对使用（restore可以比save少，但不能多），如果restore调用次数比save多，会引发Error。</span><br><span class="line"><span class="built_in">restoreToCount</span>()   回到任何一个<span class="built_in">save</span>()方法调用之前的状态</span><br><span class="line"><span class="selector-tag">Canvas</span><span class="selector-class">.getSaveCount</span>();    返回栈中保存的状态，值等于<span class="built_in">save</span>()调用次数<span class="built_in">-restore</span>()调用次数</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">Canvas</span><span class="selector-class">.translate</span>() 平移画布</span><br><span class="line"><span class="selector-tag">Canvas</span><span class="selector-class">.rotate</span>()    旋转画布</span><br><span class="line"><span class="selector-tag">Canvas</span><span class="selector-class">.saveLayer</span>(),<span class="built_in">saveLayerAlpha</span>() 将图层入栈</span><br><span class="line">本身和save方法差不多，但是它单独分配了一个画布用于绘制图层。它定义了一个画布区域（saveLayerAlpha可设置透明度），此方法之后的所有绘制都在此区域中绘制，直到调用<span class="selector-tag">canvas</span><span class="selector-class">.restore</span>()方法。</span><br><span class="line">Layer入栈时，后续的操作都发生在这个Layer上，而Layer退栈时，就会把本层绘制的图像“绘制”到上层.在绘制到上层或是<span class="selector-tag">Canvas</span>上时，可以指定Layer的透明度</span><br></pre></td></tr></table></figure>

<h3 id="Canvas-amp-amp-SurfaceView"><a href="#Canvas-amp-amp-SurfaceView" class="headerlink" title="Canvas &amp;&amp; SurfaceView"></a>Canvas &amp;&amp; SurfaceView</h3><p>在使用上面介绍的方式在View上绘图的时候，它是在GUI线程中绘制的，在GUI线程中同时也用来处理用户的交互事件，这是不大合理的，单绘制的元素太多时候，会阻塞线程，轻者影响用户体验，重则倒置ANR。<br>也许大家会想到将onDraw方法移到后台，但是这种方式是可行的，从后台线程修改GUI元素是不允许的。<br>并且我们知道View是通过系统发出VSYNC信号进行屏幕重绘的，一般刷新时间间隔为16ms，如果在16ms内可以完成所有的操作，那么将不会带来卡顿感觉，而如果超过这个时间还不能完成绘制任务，就会导致GUI线程的阻塞。<br>当需要快速更新View的UI，或者当前绘制阻塞GUI线程时间过长的时候，应该使用Surfaceview而不是View。SurfaceView封装的是Surface而不是Canvas。这一切原因是由于Surface使用后台线程进行绘制，而Canvase不能。<br>但是大家有时候会感到奇怪，为什么我们看到自定义View很多都是继承View而不是SurfaceView，这是因为SurfaceView使用的是后台线程进行绘制的，这回增加内存的消耗。所以一般能在16ms内完成绘制的话就直接继承View</p>
<p>所以最好在绘制高速图像，或者绘制工作不能在规定时间完成，又或者需要绘制3D图形的情况下才需要使用SurfaceView。</p>
<p>下面我们就来介绍下SurfaceView的用法：<br>在介绍SurfaceView的用法之前我们先了解下Surface、SurfaceView、SurfaceHolder及SurfaceHolder.Callback。</p>
<p>如上面所述SurfaceView提供了一个专门用于绘制的surface。它允许在后台线程中进行绘制，你可以通过SurfaceHolder控制这个Surface的格式和尺寸。Surfaceview控制让这个Surface显示在屏幕的正确绘制位置。<br>Surface是Z-ordered（Z轴排序），这表明它总在自己所在窗口的后面。surfaceview在显示窗口处为Surface提供了一个可见区域，通过这个区域，才能看到Surface里面的内容。<br>由于这个特性我们可以放置一些覆盖图层（overlays）在Surface上面，如Button、Textview之类的。但是，需要注意的是，如果Surface上面有全透明的控件，那么随着Surface的每一次变化，这些全透明的控件就会重新渲染，这样有可能会增加系统的负担。</p>
<p>可以通过SurfaceHolder这个接口去访问Surface，而执行getHolder()方法可以得到SurfaceHolder接口。<br>SurfaceHolder是控制surface的一个抽象接口，它是一个句柄得到了这个句柄就可以得到其中的Canvas、原生缓冲器以及其它方面的内容。你可以通过SurfaceHolder来控制surface的尺寸和格式，或者修改surface的像素，监视surface的变化等等。<br>与直接控制SurfaceView来修改surface不同，使用SurfaceHolder来修改surface时，需要注意lockCanvas()和Callback.surfaceCreated()这两个方法。<br>SurfaceView有如下重要方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">addCallback</span><span class="params">(SurfaceHolder.Callback callback)</span> 给SurfaceHolder添加一个一个回调对象。用于监视SurfaceView的某些状态，可以在这些回调方法中对某个特定事件发生的时候进行必要的处理</span><br><span class="line">SurfaceHolder.Callback将会在后面进行介绍</span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">removeCallback</span><span class="params">(SurfaceHolder.Callback callback)</span>  移除回调对象</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> Canvas <span class="title function_">lockCanvas</span><span class="params">(Rect dirty)</span></span><br><span class="line">锁定画布中的某一个区域，返回的画布对象Canvas（当更新的内容只有一个区域时，同时要追求高效，可以只更新一部分的区域，而不必更新全部画布区域）</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> Canvas <span class="title function_">lockCanvas</span><span class="params">()</span> 锁定画布，返回的画布对象Canvas，和上面不同的是这里锁定的是整个画布</span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">unlockCanvasAndPost</span><span class="params">(Canvas canvas)</span>  结束锁定画布，并提交改变。</span><br></pre></td></tr></table></figure>

<p>SurfaceHolder.Callback是监听surface改变的一个接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">surfaceChanged</span><span class="params">(SurfaceHolder holder, <span class="type">int</span> format, <span class="type">int</span> width, <span class="type">int</span> height)</span></span><br><span class="line">surface发生改变时被调用,传入的是新Surface的新尺寸</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">surfaceCreated</span><span class="params">(SurfaceHolder holder)</span></span><br><span class="line"></span><br><span class="line">在surface创建时被调用，一般在这个方法里面开启渲染屏幕的线程。</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="title function_">voidsurfaceDestroyed</span><span class="params">(SurfaceHolder holder)</span></span><br><span class="line">销毁时被调用，一般在这个方法里将渲染的线程停止。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>所有SurfaceView 和 SurfaceHolder.Callback的方法都应该在主线程（UI线程）里面调用。必须确保只有当Surface有效的时候，（也就是当Surface的生命周期在SurfaceHolder.Callback.surfaceCreated() 和SurfaceHolder.Callback.surfaceDestroyed()之间）才能让渲染进程访问。</p>
<h5 id="下面是这几个对象的关系图"><a href="#下面是这几个对象的关系图" class="headerlink" title="下面是这几个对象的关系图"></a>下面是这几个对象的关系图</h5><p><img src="/2016/04/12/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%89-%E7%94%BB%E5%B8%83Canvs%E4%BB%A5%E5%8F%8ASurfaceView/surfaceview.png"></p>
<p>SurfaceView 绘图的模板：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">surfaceView</span> <span class="keyword">extends</span> <span class="title class_">SurfaceView</span> <span class="keyword">implements</span> <span class="title class_">SurfaceHolder</span>.Callback, Runnable &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Context</span> <span class="variable">mContext</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">SurfaceHolder</span> <span class="variable">mHolder</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Canvas</span> <span class="variable">mCanvas</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">surfaceViewStatus</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Thread</span> <span class="variable">mDrawThread</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        mContext = context;</span><br><span class="line">        mHolder = getHolder();</span><br><span class="line">        mHolder.addCallback(<span class="built_in">this</span>);</span><br><span class="line">        setFocusable(<span class="literal">true</span>);</span><br><span class="line">        setFocusableInTouchMode(<span class="literal">true</span>);</span><br><span class="line">        setKeepScreenOn(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">surfaceView</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context);</span><br><span class="line">        init(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">surfaceView</span><span class="params">(Context context, AttributeSet attrs)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attrs);</span><br><span class="line">        init(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">surfaceView</span><span class="params">(Context context, AttributeSet attrs, <span class="type">int</span> defStyleAttr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">        init(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">surfaceCreated</span><span class="params">(SurfaceHolder holder)</span> &#123;</span><br><span class="line">        surfaceViewStatus = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(mDrawThread == <span class="literal">null</span>) &#123;</span><br><span class="line">            mDrawThread = <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        mDrawThread.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">surfaceChanged</span><span class="params">(SurfaceHolder holder, <span class="type">int</span> format, <span class="type">int</span> width, <span class="type">int</span> height)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">surfaceDestroyed</span><span class="params">(SurfaceHolder holder)</span> &#123;</span><br><span class="line">        surfaceViewStatus = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(mDrawThread != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                mDrawThread.join();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            mDrawThread = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (surfaceViewStatus) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                mCanvas = mHolder.lockCanvas();</span><br><span class="line">                <span class="comment">//在这里画图</span></span><br><span class="line">            &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(mCanvas != <span class="literal">null</span>) &#123;</span><br><span class="line">                    mHolder.unlockCanvasAndPost(mCanvas);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E8%BF%9B%E9%98%B6/">Android进阶</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android-绘图进阶/">Android 绘图进阶</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/12/Android-进阶之Android-绘图-三-画布Canvs以及SurfaceView/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/12/Android-进阶之Android-绘图-三-画布Canvs以及SurfaceView/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/11/Android-进阶之Android-绘图-二-画笔Paint/" title="Android 进阶之Android 绘图 二 画笔Paint" itemprop="url">Android 进阶之Android 绘图 二 画笔Paint</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-11T03:30:40.000Z" itemprop="datePublished"> Published 2016-04-11</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="画笔Paint"><a href="#画笔Paint" class="headerlink" title="画笔Paint"></a>画笔Paint</h4><p>在现实生活中我们要画一幅画需要有画笔，画布，还有颜料，Android系统中也是一样，在接下去的章节中将对这些绘画元素进行一一介绍，而在这个部分我们就先介绍画笔对象，画笔有很多重要的属性，比如画笔的颜色，画笔的线宽，画笔的样式等</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">画笔的基本属性：</span><br><span class="line"></span><br><span class="line">set<span class="constructor">ARGB(<span class="params">int</span> <span class="params">a</span>,<span class="params">int</span> <span class="params">r</span>,<span class="params">int</span> <span class="params">g</span>,<span class="params">int</span> <span class="params">b</span>)</span>;  设置绘制的颜色，a代表透明度，r，g，b代表颜色值。 </span><br><span class="line">set<span class="constructor">Alpha(<span class="params">int</span> <span class="params">a</span>)</span>;                    设置绘制图形的透明度，设置范围是<span class="literal">[<span class="number">0.</span>.<span class="number">255</span>]</span></span><br><span class="line">set<span class="constructor">Color(<span class="params">int</span> <span class="params">color</span>)</span>; 	            设置绘制的颜色，该颜色值包括透明度和RGB颜色。</span><br><span class="line">set<span class="constructor">AntiAlias(<span class="params">boolean</span> <span class="params">aa</span>)</span>;       	设置是否使用抗锯齿功能，会消耗较大资源，绘制图形速度会变慢。一般在绘制棱角分明的图像时不需要抗锯齿。</span><br><span class="line">set<span class="constructor">Dither(<span class="params">boolean</span> <span class="params">dither</span>)</span>;  	    设定是否使用图像抖动处理，会使绘制出来的图片颜色更加平滑和饱满，图像更加清晰 </span><br><span class="line">set<span class="constructor">Style(Paint.Style <span class="params">style</span>)</span>; 	    设置画笔的样式，Paint.Style.STROKE：描边，Paint.Style.FILL_AND_STROKE：描边并填充，Paint.Style.FILL：填充 </span><br><span class="line">set<span class="constructor">StrokeWidth(<span class="params">float</span> <span class="params">width</span>)</span>; 	    当画笔样式为STROKE或FILL_OR_STROKE时，设置笔刷的粗细度,也就是线条宽度</span><br><span class="line">set<span class="constructor">StrokeCap(Paint.Cap <span class="params">cap</span>)</span>; 	    当画笔样式为STROKE或FILL_OR_STROKE时，设置笔刷的图形样式，如圆形样Cap.ROUND,或方形样式Cap.SQUARE</span><br><span class="line">set<span class="constructor">StokeJoin(Paint.Join <span class="params">join</span>)</span>;  	设置绘制时各图形的结合方式，如平滑效果等</span><br><span class="line">set<span class="constructor">StrokeMiter(<span class="params">float</span> <span class="params">miter</span>)</span>：        设置画笔倾斜度</span><br></pre></td></tr></table></figure>
<p>这个部分重点介绍下setStrokeCap和setStokeJoin。</p>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/Cap.png"><br>Android StrokeCap 属性对比图</p>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/Joint.png"><br>Android StokeJoin 属性对比图</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">文字相关属性：</span><br><span class="line"></span><br><span class="line">set<span class="constructor">TextSize(<span class="params">float</span> <span class="params">textSize</span>)</span>;            设置绘制文字的字号大小</span><br><span class="line">set<span class="constructor">LetterSpacing(<span class="params">float</span> <span class="params">letterSpacing</span>)</span>   设置行间距，默认是<span class="number">0.</span></span><br><span class="line">set<span class="constructor">FakeBoldText(<span class="params">boolean</span> <span class="params">fakeBoldText</span>)</span>;      模拟实现粗体文字 </span><br><span class="line">set<span class="constructor">TextScaleX(<span class="params">float</span> <span class="params">scaleX</span>)</span>; 	    设置绘制文字x轴的缩放比例，可以实现文字的拉伸的效果，当值大于<span class="number">1</span>会沿X轴水平放大文本，当值小于<span class="number">1</span>会沿X轴水平缩放文本</span><br><span class="line">set<span class="constructor">TextSkewX(<span class="params">float</span> <span class="params">skewX</span>)</span>;      设置斜体文字，skewX为倾斜弧度，值为负右倾值为正左倾</span><br><span class="line">set<span class="constructor">UnderlineText(<span class="params">boolean</span> <span class="params">underlineText</span>)</span>; 	    设置带有下划线的文字效果</span><br><span class="line">set<span class="constructor">StrikeThruText(<span class="params">boolean</span> <span class="params">strikeThruText</span>)</span>;      设置带有删除线的效果</span><br><span class="line">set<span class="constructor">TextAlign(Paint.Align <span class="params">align</span>)</span>;        设置绘制文字的对齐方向 可供选的方式有三种：CENTER,LEFT和RIGHT。</span><br><span class="line">set<span class="constructor">Typeface(Typeface <span class="params">typeface</span>)</span>; 	设置Typeface对象，即字体风格，包括粗体，斜体以及衬线体，非衬线体等 </span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">画笔的特效</span><br><span class="line">set<span class="constructor">FilterBitmap(<span class="params">boolean</span> <span class="params">filter</span>)</span>;  	        如果该项设置为<span class="literal">true</span>，则图像在动画进行中会滤掉对Bitmap图像的优化操作，加快显示速度，本设置项依赖于dither和xfermode的设置</span><br><span class="line">set<span class="constructor">MaskFilter(MaskFilter <span class="params">maskfilter</span>)</span>; 	    设置MaskFilter，可以用不同的MaskFilter实现滤镜的效果，如滤化，立体等</span><br><span class="line">set<span class="constructor">ColorFilter(ColorFilter <span class="params">colorfilter</span>)</span>; 	        设置颜色过滤器，可以在绘制颜色时实现不用颜色的变换效果 </span><br><span class="line">set<span class="constructor">PathEffect(PathEffect <span class="params">effect</span>)</span>; 	        设置绘制路径的效果，如点画线等</span><br><span class="line">set<span class="constructor">Shader(Shader <span class="params">shader</span>)</span>; 	        设置图像效果，使用Shader可以绘制出各种渐变效果 </span><br><span class="line">set<span class="constructor">ShadowLayer(<span class="params">float</span> <span class="params">radius</span> ,<span class="params">float</span> <span class="params">dx</span>,<span class="params">float</span> <span class="params">dy</span>,<span class="params">int</span> <span class="params">color</span>)</span>; 	    在图形下面设置阴影层，产生阴影效果，radius为阴影的角度，dx和dy为阴影在x轴和y轴上的距离，color为阴影的颜色</span><br><span class="line">set<span class="constructor">Xfermode(Xfermode <span class="params">xfermode</span>)</span>; 设置图形重叠时的处理方式，如合并，取交集或并集，经常用来制作橡皮的擦除效果</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>画笔这部分最重要也是最难的就是画笔特效这部分。<br>接下来我们将会介绍<br>setMaskFilter<br>setColorFilter<br>setShader<br>setShadowLayer<br>setXfermode<br>setPathEffect</p>
<p>一、setMaskFilter(MaskFilter maskfilter)</p>
<p>setMaskFilter(MaskFilter maskfilter)是用来给画笔添加某种效果，这里的效果主要有两类一类是模糊效果，一类是浮雕效果，下面将对这两个效果进行介绍：</p>
<ul>
<li>BlurMaskFilter 主要是用来实现添加一些阴影轮廓效果,这里需要注意的是在使用这个效果的时候需要关闭硬件加速功能，这里的关闭有两种方式一种是在AndroidManifest中关闭，这种关闭是全局的在这个地方关闭将会导致整个应用都不能使用硬件加速，<br>还有一种方式是使用setLayerType(LAYER_TYPE_SOFTWARE, null); 将硬件加速给关闭，这种关闭方式只是针对某个具体的View，其他View还是可以使用硬件加速功能的</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void on<span class="constructor">Draw(Canvas <span class="params">canvas</span>)</span> &#123;</span><br><span class="line">    super.on<span class="constructor">Draw(<span class="params">canvas</span>)</span>;</span><br><span class="line">    mPaint.set<span class="constructor">MaskFilter(<span class="params">new</span> BlurMaskFilter(20, BlurMaskFilter.Blur.INNER)</span>);</span><br><span class="line">    canvas.draw<span class="constructor">Circle(400,200,100,<span class="params">mPaint</span>)</span>;</span><br><span class="line">    mPaint.set<span class="constructor">MaskFilter(<span class="params">new</span> BlurMaskFilter(20, BlurMaskFilter.Blur.NORMAL)</span>);</span><br><span class="line">    canvas.draw<span class="constructor">Circle(400,450,100,<span class="params">mPaint</span>)</span>;</span><br><span class="line">    mPaint.set<span class="constructor">MaskFilter(<span class="params">new</span> BlurMaskFilter(20, BlurMaskFilter.Blur.OUTER)</span>);</span><br><span class="line">    canvas.draw<span class="constructor">Circle(400,700,100,<span class="params">mPaint</span>)</span>;</span><br><span class="line">    mPaint.set<span class="constructor">MaskFilter(<span class="params">new</span> BlurMaskFilter(20, BlurMaskFilter.Blur.SOLID)</span>);</span><br><span class="line">    canvas.draw<span class="constructor">Circle(400,950,100,<span class="params">mPaint</span>)</span>;</span><br><span class="line"></span><br><span class="line">    Bitmap bitmap = <span class="module-access"><span class="module"><span class="identifier">BitmapFactory</span>.</span></span>decode<span class="constructor">Resource(<span class="params">getResources</span>()</span>,<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>drawable.test1);</span><br><span class="line">    Bitmap b = bitmap.extract<span class="constructor">Alpha()</span>;</span><br><span class="line">    canvas.draw<span class="constructor">Bitmap(<span class="params">b</span>,200,1150,<span class="params">mPaint</span>)</span>;</span><br><span class="line">    canvas.draw<span class="constructor">Bitmap(<span class="params">bitmap</span>,200,1150,<span class="params">null</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/burmasker.png"></p>
<p>EmbossMaskFilter 我个人几乎没有用到，所以这里先不作介绍，后续有机会使用的时候会增加该部分用法</p>
<p>ColorMatrix</p>
<p>在介绍ColorFilter之前我们先了解下色彩三元素的概念：<br>色彩三元素指的是色调（色相），饱和度，亮度：<br>下面是来自百度百科的解释：</p>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/color4.png"></p>
<p>色相</p>
<blockquote>
<p>色彩是由于物体上的物理性的光反射到人眼视神经上所产生的感觉。色的不同是由光的波长的长短差别所决定的。<br>作为色相，指的是这些不同波长的色的情况。波长最长的是红色，最短的是紫色。<br>把红、橙、黄、绿、蓝、紫和处在它们各自之间的红橙、黄橙、黄绿、蓝绿、蓝紫、红紫这6种中间色——共计12种色作为色相环。<br>在色相环上排列的色是纯度高的色，被称为纯色。这些色在环上的位置是根据视觉和感觉的相等间隔来进行安排的。用类似这样的方法还可以再分出差别细微的多种色来。<br>在色相环上，与环中心对称，并在180度的位置两端的色被称为互补色。</p>
</blockquote>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/color1.png"></p>
<p>饱和度</p>
<blockquote>
<p>用数值表示色的鲜艳或鲜明的程度称之为彩度。有彩色的各种色都具有彩度值，无彩色的色的彩度值为0，对于有彩色的色的彩度（纯度）的高低，区别方法是根据这种色中含灰色的程度来计算的。<br>彩度由于色相的不同而不同，而且即使是相同的色相，因为明度的不同，彩度也会随之变化的。</p>
</blockquote>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/color2.png"></p>
<p>亮度</p>
<blockquote>
<p>表示色彩所具有的亮度和暗度被称为明度。计算明度的基准是灰度测试卡。黑色为0，白色为10，在0—10之间等间隔的排列为9个阶段。色彩可以分为有彩色和无彩色，但后者仍然存在着明度。作为有彩色<br>，每种色各自的亮度、暗度在灰度测试卡上都具有相应的位置值。彩度高的色对明度有很大的影响，不太容易辨别。在明亮的地方鉴别色的明度比较容易的，在暗的地方就难以鉴别。</p>
</blockquote>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/color3.png"></p>
<p>在Android系统中用一个4*5的矩阵对图像进行处理。<br>颜色矩阵如下所示：</p>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/colormatrix1.png"></p>
<p>将M乘以如下的列矩阵：</p>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/colormatrix2.png"></p>
<p>得到如下的变换结果：</p>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/colormatrix3.png"></p>
<p>从上面可以看出：<br>M矩阵的第一行决定了变换后的红色，第二行决定了变换后的绿色，第三行决定了变换后的蓝色，最后一行决定了变换后的透明度</p>
<p>下面是一个测试ColorMatrix的实例：</p>
<p>但是对于矩阵的方式这种方法比较不直观，因此Android提供了一种单独设置H，S，V的方式来改变图像的色彩属性：<br>下面是使用的例子</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.example.jimmy.customviewtest.MainActivity&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/imageview&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;15dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SeekBar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:max</span>=<span class="string">&quot;180&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/hvalue&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SeekBar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/svalue&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SeekBar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/vvalue&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> MainActivity extends AppCompatActivity implements SeekBar.OnSeekBarChangeListener &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ImageView mImageView = null;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> Hvalue;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> Svalue;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">float</span> Vvalue;</span><br><span class="line">    <span class="keyword">private</span> SeekBar mHvalue;</span><br><span class="line">    <span class="keyword">private</span> SeekBar mSvalue;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> SMAX;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> VMAX;</span><br><span class="line">    <span class="keyword">private</span> SeekBar mVvalue;</span><br><span class="line">    <span class="keyword">private</span> Bitmap mBitmap;</span><br><span class="line">    protected void on<span class="constructor">Create(Bundle <span class="params">savedInstanceState</span>)</span> &#123;</span><br><span class="line">        super.on<span class="constructor">Create(<span class="params">savedInstanceState</span>)</span>;</span><br><span class="line">        set<span class="constructor">ContentView(R.<span class="params">layout</span>.<span class="params">activity_main</span>)</span>;</span><br><span class="line">        mImageView = (ImageView) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">imageview</span>)</span>;</span><br><span class="line">        mHvalue = (SeekBar) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">hvalue</span>)</span>;</span><br><span class="line">        mSvalue = (SeekBar) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">svalue</span>)</span>;</span><br><span class="line">        mVvalue = (SeekBar) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">vvalue</span>)</span>;</span><br><span class="line">        mHvalue.set<span class="constructor">OnSeekBarChangeListener(<span class="params">this</span>)</span>;</span><br><span class="line">        mSvalue.set<span class="constructor">OnSeekBarChangeListener(<span class="params">this</span>)</span>;</span><br><span class="line">        SMAX = mSvalue.get<span class="constructor">Max()</span>;</span><br><span class="line">        VMAX = mVvalue.get<span class="constructor">Max()</span>;</span><br><span class="line">        mVvalue.set<span class="constructor">OnSeekBarChangeListener(<span class="params">this</span>)</span>;</span><br><span class="line">        mBitmap = <span class="module-access"><span class="module"><span class="identifier">BitmapFactory</span>.</span></span>decode<span class="constructor">Resource(<span class="params">getResources</span>()</span>, <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>drawable.test1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void on<span class="constructor">ProgressChanged(SeekBar <span class="params">seekBar</span>, <span class="params">int</span> <span class="params">progress</span>, <span class="params">boolean</span> <span class="params">fromUser</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">        switch (seekBar.get<span class="constructor">Id()</span>) &#123;</span><br><span class="line">            case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.hvalue:</span><br><span class="line">                Hvalue = progress;</span><br><span class="line">                break;</span><br><span class="line">            case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.svalue:</span><br><span class="line">                <span class="keyword">if</span> (SMAX != <span class="number">0</span>) &#123;</span><br><span class="line">                    Svalue = progress*<span class="number">1.0</span>F/SMAX;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.vvalue:</span><br><span class="line">                <span class="keyword">if</span>(VMAX != <span class="number">0</span>) &#123;</span><br><span class="line">                    Vvalue = progress*<span class="number">1.0</span>F/VMAX;;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        set<span class="constructor">HSV()</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> void set<span class="constructor">HSV()</span> &#123;</span><br><span class="line">        </span><br><span class="line">        ColorMatrix hutMatrix = <span class="keyword">new</span> <span class="constructor">ColorMatrix()</span>;</span><br><span class="line">        <span class="comment">//设置RGB 的色调值  第一个参数为R，G，B，第二个参数为具体的色调 </span></span><br><span class="line">        hutMatrix.set<span class="constructor">Rotate(0,Hvalue)</span>;</span><br><span class="line">        hutMatrix.set<span class="constructor">Rotate(1,Hvalue)</span>;</span><br><span class="line">        hutMatrix.set<span class="constructor">Rotate(2,Hvalue)</span>;</span><br><span class="line"></span><br><span class="line">        ColorMatrix saturation = <span class="keyword">new</span> <span class="constructor">ColorMatrix()</span>;</span><br><span class="line">         <span class="comment">//设置饱和度</span></span><br><span class="line">        saturation.set<span class="constructor">Saturation(Svalue)</span>;</span><br><span class="line"></span><br><span class="line">        ColorMatrix lumMatrix = <span class="keyword">new</span> <span class="constructor">ColorMatrix()</span>;</span><br><span class="line">        <span class="comment">//设置亮度</span></span><br><span class="line">        lumMatrix.set<span class="constructor">Scale(Vvalue,Vvalue,Vvalue,1f)</span>;</span><br><span class="line"></span><br><span class="line">        ColorMatrix colorMatrix = <span class="keyword">new</span> <span class="constructor">ColorMatrix()</span>;</span><br><span class="line">        <span class="comment">//postConcat 用于将矩阵的作用效果混合，从而产生叠加效果</span></span><br><span class="line">        colorMatrix.post<span class="constructor">Concat(<span class="params">hutMatrix</span>)</span>;</span><br><span class="line">        colorMatrix.post<span class="constructor">Concat(<span class="params">saturation</span>)</span>;</span><br><span class="line">        colorMatrix.post<span class="constructor">Concat(<span class="params">lumMatrix</span>)</span>;</span><br><span class="line"></span><br><span class="line">        Paint paint = <span class="keyword">new</span> <span class="constructor">Paint()</span>;</span><br><span class="line">        paint.set<span class="constructor">AntiAlias(<span class="params">true</span>)</span>;</span><br><span class="line">        paint.set<span class="constructor">Dither(<span class="params">true</span>)</span>;</span><br><span class="line">        paint.set<span class="constructor">ColorFilter(<span class="params">new</span> ColorMatrixColorFilter(<span class="params">colorMatrix</span>)</span>);</span><br><span class="line">        Bitmap bitmap = <span class="module-access"><span class="module"><span class="identifier">Bitmap</span>.</span></span>create<span class="constructor">Bitmap(<span class="params">mBitmap</span>.<span class="params">getWidth</span>()</span>, mBitmap.get<span class="constructor">Height()</span>, Bitmap.Config.ARGB_8888);</span><br><span class="line">        Canvas canvas = <span class="keyword">new</span> <span class="constructor">Canvas(<span class="params">bitmap</span>)</span>;</span><br><span class="line">        canvas.draw<span class="constructor">Bitmap(<span class="params">mBitmap</span>,0,0,<span class="params">paint</span>)</span>;</span><br><span class="line">        mImageView.set<span class="constructor">ImageBitmap(<span class="params">bitmap</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void on<span class="constructor">StartTrackingTouch(SeekBar <span class="params">seekBar</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void on<span class="constructor">StopTrackingTouch(SeekBar <span class="params">seekBar</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/HSV.png"></p>
<p>着色器Shader</p>
<p>Android提供了四种着色器：</p>
<p>LinearGradient<br>RadialGradient<br>SweepGradient</p>
<p>BitmapShader<br>ComposeShader</p>
<p>下面将对这些着色器作简单介绍，都很简单主要用于填充画笔的</p>
<p><em>LinearGradient 线性变化</em>：</p>
<p>构造函数如下：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="constructor">LinearGradient(<span class="params">float</span> <span class="params">x0</span>, <span class="params">float</span> <span class="params">y0</span>, <span class="params">float</span> <span class="params">x1</span>, <span class="params">float</span> <span class="params">y1</span>, <span class="params">int</span>[] <span class="params">colors</span>, <span class="params">float</span>[] <span class="params">positions</span>,Shader.TileMode <span class="params">tile</span>)</span></span><br><span class="line">参数:</span><br><span class="line"><span class="built_in">float</span> x0: 渐变起始点x坐标</span><br><span class="line"><span class="built_in">float</span> y0:渐变起始点y坐标</span><br><span class="line"><span class="built_in">float</span> x1:渐变结束点x坐标</span><br><span class="line"><span class="built_in">float</span> y1:渐变结束点y坐标</span><br><span class="line"><span class="built_in">int</span><span class="literal">[]</span> colors:颜色 的<span class="built_in">int</span> 数组</span><br><span class="line"><span class="built_in">float</span><span class="literal">[]</span> positions: 相对位置的颜色数组,可为null, 如果为null,颜色沿渐变线均匀分布</span><br><span class="line">Shader.TileMode tile: 渲染器平铺模式</span><br><span class="line"></span><br><span class="line">public <span class="constructor">LinearGradient(<span class="params">float</span> <span class="params">x0</span>, <span class="params">float</span> <span class="params">y0</span>, <span class="params">float</span> <span class="params">x1</span>, <span class="params">float</span> <span class="params">y1</span>, <span class="params">int</span> <span class="params">color0</span>, <span class="params">int</span> <span class="params">color1</span>,Shader.TileMode <span class="params">tile</span>)</span></span><br><span class="line"><span class="built_in">float</span> x0: 渐变起始点x坐标</span><br><span class="line"><span class="built_in">float</span> y0:渐变起始点y坐标</span><br><span class="line"><span class="built_in">float</span> x1:渐变结束点x坐标</span><br><span class="line"><span class="built_in">float</span> y1:渐变结束点y坐标</span><br><span class="line"><span class="built_in">int</span> color0: 起始渐变色</span><br><span class="line"><span class="built_in">int</span> color1: 结束渐变色</span><br><span class="line">Shader.TileMode tile: 渲染器平铺模式</span><br></pre></td></tr></table></figure>

<p><em>RadialGradient 光束变化</em>：</p>
<p>构造函数如下：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="constructor">RadialGradient(<span class="params">float</span> <span class="params">x</span>, <span class="params">float</span> <span class="params">y</span>, <span class="params">float</span> <span class="params">radius</span>, <span class="params">int</span>[] <span class="params">colors</span>, <span class="params">float</span>[] <span class="params">positions</span>,Shader.TileMode <span class="params">tile</span>)</span></span><br><span class="line"><span class="built_in">float</span> x:  圆心X坐标</span><br><span class="line"><span class="built_in">float</span> y:  圆心Y坐标</span><br><span class="line"><span class="built_in">float</span> radius: 半径</span><br><span class="line"><span class="built_in">int</span><span class="literal">[]</span> colors:  渲染颜色数组</span><br><span class="line">floate<span class="literal">[]</span> positions: 相对位置数组,可为null, 如果为null,颜色沿渐变线均匀分布</span><br><span class="line">Shader.TileMode tile:渲染器平铺模式</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public <span class="constructor">RadialGradient(<span class="params">float</span> <span class="params">x</span>, <span class="params">float</span> <span class="params">y</span>, <span class="params">float</span> <span class="params">radius</span>, <span class="params">int</span> <span class="params">color0</span>, <span class="params">int</span> <span class="params">color1</span>,Shader.TileMode <span class="params">tile</span>)</span></span><br><span class="line"><span class="built_in">float</span> x:  圆心X坐标</span><br><span class="line"><span class="built_in">float</span> y:  圆心Y坐标</span><br><span class="line"><span class="built_in">float</span> radius: 半径</span><br><span class="line"><span class="built_in">int</span> color0: 圆心颜色</span><br><span class="line"><span class="built_in">int</span> color1: 圆边缘颜色</span><br><span class="line">Shader.TileMode tile:渲染器平铺模式</span><br></pre></td></tr></table></figure>

<p><em>SweepGradient 辐射变化</em>：<br>构造函数如下：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="constructor">SweepGradient(<span class="params">float</span> <span class="params">cx</span>, <span class="params">float</span> <span class="params">cy</span>, <span class="params">int</span>[] <span class="params">colors</span>, <span class="params">float</span>[] <span class="params">positions</span>)</span></span><br><span class="line">Parameters:</span><br><span class="line">cx	渲染中心点x 坐标</span><br><span class="line">cy	渲染中心y 点坐标</span><br><span class="line">colors	围绕中心渲染的颜色数组，至少要有两种颜色值</span><br><span class="line">positions	相对位置的颜色数组,可为null, 如果为null,颜色沿渐变线均匀分布</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public <span class="constructor">SweepGradient(<span class="params">float</span> <span class="params">cx</span>, <span class="params">float</span> <span class="params">cy</span>, <span class="params">int</span> <span class="params">color0</span>, <span class="params">int</span> <span class="params">color1</span>)</span></span><br><span class="line">Parameters:</span><br><span class="line">cx	渲染中心点x 坐标</span><br><span class="line">cy	渲染中心点y 坐标</span><br><span class="line">color0	起始渲染颜色</span><br><span class="line">color1	结束渲染颜色</span><br></pre></td></tr></table></figure>


<p><em>ComposeShader 两种shader混合</em>：<br>构造函数</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">public ComposeShader(<span class="keyword">Shader </span><span class="keyword">shaderA,Shader </span><span class="keyword">shaderB, </span>Xfermode mode)</span><br><span class="line">Parameters</span><br><span class="line"><span class="keyword">shaderA	</span>渲染器A,<span class="keyword">Shader及其子类对象</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">shaderB	</span>渲染器<span class="keyword">B,Shader及其子类对象</span></span><br><span class="line"><span class="keyword"></span>mode	 两种渲染器组合的模式,Xfermode对象</span><br><span class="line"></span><br><span class="line">public ComposeShader(<span class="keyword">Shader </span><span class="keyword">shaderA,Shader </span><span class="keyword">shaderB, </span>PorterDuff.Mode mode)</span><br><span class="line">Parameters</span><br><span class="line"><span class="keyword">shaderA	</span>渲染器A,<span class="keyword">Shader及其子类对象</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">shaderB	</span>渲染器<span class="keyword">B,Shader及其子类对象</span></span><br><span class="line"><span class="keyword"></span>mode	.两种渲染器组合的模式,ProterDuff.Mode对象</span><br></pre></td></tr></table></figure>

<p><em>BitmapShader 位图Shader</em>：<br>构造函数</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">public   <span class="keyword">BitmapShader(Bitmap </span><span class="keyword">bitmap,Shader.TileMode </span>tileX,<span class="keyword">Shader.TileMode </span>tileY)</span><br><span class="line"></span><br><span class="line"><span class="keyword">bitmap </span>  在渲染器内使用的位图</span><br><span class="line">tileX      The tiling mode for x to draw the <span class="keyword">bitmap </span>in.   在位图上X方向渲染器平铺模式</span><br><span class="line">tileY     The tiling mode for y to draw the <span class="keyword">bitmap </span>in.    在位图上Y方向渲染器平铺模式</span><br><span class="line">TileMode：</span><br></pre></td></tr></table></figure>

<p>下面代码是上述Shader的使用方法例子：<br>在看下面的例子的时候需要先明确下填充方式：</p>
<figure class="highlight monkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">CLAMP</span>  ：如果渲染器超出原始边界范围，会复制范围内边缘染色。</span><br><span class="line"><span class="keyword">REPEAT</span> : 重复渲染器图片平铺。</span><br><span class="line">MIRROR ：重复渲染器图片，以镜像方式平铺。</span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> ShaderView extends View &#123;</span><br><span class="line">    <span class="keyword">private</span> Context mContext = null;</span><br><span class="line">    public <span class="constructor">ShaderView(Context <span class="params">context</span>)</span> &#123;</span><br><span class="line">        super(context);</span><br><span class="line">        mContext = context;</span><br><span class="line">        init<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="constructor">ShaderView(Context <span class="params">context</span>, AttributeSet <span class="params">attrs</span>)</span> &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">        mContext = context;</span><br><span class="line">        init<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="constructor">ShaderView(Context <span class="params">context</span>, AttributeSet <span class="params">attrs</span>, <span class="params">int</span> <span class="params">defStyleAttr</span>)</span> &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">        mContext = context;</span><br><span class="line">        init<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;</span><br><span class="line">    <span class="keyword">private</span> void init<span class="literal">()</span> &#123;</span><br><span class="line">        mPaint = <span class="keyword">new</span> <span class="constructor">Paint()</span>;</span><br><span class="line">        mPaint.set<span class="constructor">Dither(<span class="params">true</span>)</span>;</span><br><span class="line">        mPaint.set<span class="constructor">AntiAlias(<span class="params">true</span>)</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    protected void on<span class="constructor">Draw(Canvas <span class="params">canvas</span>)</span> &#123;</span><br><span class="line">        super.on<span class="constructor">Draw(<span class="params">canvas</span>)</span>;</span><br><span class="line">        mPaint.set<span class="constructor">Shader(<span class="params">new</span> LinearGradient(0,0,200,200, Color.BLUE,Color.YELLOW, Shader.TileMode.CLAMP)</span>);</span><br><span class="line">        canvas.draw<span class="constructor">RoundRect(0,0,1024,400,2F,3F,<span class="params">mPaint</span>)</span>;</span><br><span class="line"></span><br><span class="line">        mPaint.set<span class="constructor">Shader(<span class="params">new</span> RadialGradient(400,800,500, Color.YELLOW,Color.BLUE, Shader.TileMode.CLAMP)</span>);</span><br><span class="line">        canvas.draw<span class="constructor">RoundRect(0,400,1024,800,2F,3F,<span class="params">mPaint</span>)</span>;</span><br><span class="line"></span><br><span class="line">        mPaint.set<span class="constructor">Shader(<span class="params">new</span> SweepGradient(400,1200,Color.BLUE,Color.RED)</span>);</span><br><span class="line">        canvas.draw<span class="constructor">RoundRect(0,800,1024,1200,2F,3F,<span class="params">mPaint</span>)</span>;</span><br><span class="line"></span><br><span class="line">        Bitmap bitmap = <span class="module-access"><span class="module"><span class="identifier">BitmapFactory</span>.</span></span>decode<span class="constructor">Resource(<span class="params">mContext</span>.<span class="params">getResources</span>()</span>, <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>drawable.test1);</span><br><span class="line">        mPaint.set<span class="constructor">Shader(<span class="params">new</span> BitmapShader(<span class="params">bitmap</span>, Shader.TileMode.REPEAT, Shader.TileMode.REPEAT)</span>);</span><br><span class="line">        canvas.draw<span class="constructor">Circle(500,1600,400,<span class="params">mPaint</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/shader.png"></p>
<p>使用setShadowLayer 给TextView 以及Button添加阴影：</p>
<p>上面介绍setMatrixFilder的时候介绍过给某个图形添加阴影，这里将要介绍的是给文本以及按钮添加阴影，这部分十分简单，只要熟悉下各个参数即可：</p>
<p>setShadowLayer共有4个参数：<br>第一个参数为模糊半径，越大越模糊。<br>第二个参数是阴影的横向偏移距离。<br>第三个参数是阴影的纵向偏移距离。<br>第四个参数是阴影颜色。<br>下面是该方法是使用例子</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">TextView textView = (TextView) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">text1</span>)</span>;</span><br><span class="line">textView.set<span class="constructor">ShadowLayer(20,30,20, Color.DKGRAY)</span>;</span><br><span class="line"></span><br><span class="line">Button ButtomView = (Button) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">text2</span>)</span>;</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">ButtomView</span>.</span></span>set<span class="constructor">ShadowLayer(30,50,80, Color.DKGRAY)</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/layershader.png"></p>
<p>接下来我们介绍下setXfermode，这个主要用于图层的混合，它包含AvoidXfermode，PixelXorXfermode以及PorterDuffXfermode，前两者不常用所以在这里不做过多的介绍：<br>这里重点介绍下PorterDuffXfermode。<br>我们先看下下面这张图，总共有16种模式：<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/mode.png"></p>
<p>下面就使用如下的例子对这16种图层混合模式进行介绍：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XfermodeView</span> <span class="keyword">extends</span> <span class="title class_">View</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">XfermodeView</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context);</span><br><span class="line">        init(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">XfermodeView</span><span class="params">(Context context, AttributeSet attrs)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attrs);</span><br><span class="line">        init(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">XfermodeView</span><span class="params">(Context context, AttributeSet attrs, <span class="type">int</span> defStyleAttr)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">        init(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Paint</span> <span class="variable">mPaint</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Bitmap</span> <span class="variable">mSourceImage</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Bitmap</span> <span class="variable">mDestImage</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">PorterDuffXfermode</span> <span class="variable">duff</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        mPaint = <span class="keyword">new</span> <span class="title class_">Paint</span>();</span><br><span class="line">        mSourceImage = BitmapFactory.decodeResource(context.getResources(), R.drawable.test);</span><br><span class="line">        mDestImage = BitmapFactory.decodeResource(context.getResources(), R.drawable.background);</span><br><span class="line">        duff = <span class="keyword">new</span> <span class="title class_">PorterDuffXfermode</span>(PorterDuff.Mode.SCREEN);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDraw</span><span class="params">(Canvas canvas)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDraw(canvas);</span><br><span class="line">        canvas.drawColor(Color.WHITE);</span><br><span class="line">        <span class="type">int</span> <span class="variable">saveCount</span> <span class="operator">=</span> canvas.saveLayer(<span class="number">0</span>, <span class="number">0</span>, mTotalWidth, mTotalHeight, mPaint,</span><br><span class="line">                Canvas.ALL_SAVE_FLAG);</span><br><span class="line">        canvas.drawBitmap(mDestImage,<span class="number">0</span>,<span class="number">0</span>,mPaint);</span><br><span class="line">        mPaint.setXfermode(duff);</span><br><span class="line">        canvas.drawBitmap(mSourceImage,<span class="number">100</span>,<span class="number">600</span>,mPaint);</span><br><span class="line">        mPaint.setXfermode(<span class="literal">null</span>);</span><br><span class="line">        canvas.restoreToCount(saveCount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> mTotalWidth;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> mTotalHeight;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onSizeChanged</span><span class="params">(<span class="type">int</span> w, <span class="type">int</span> h, <span class="type">int</span> oldw, <span class="type">int</span> oldh)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onSizeChanged(w, h, oldw, oldh);</span><br><span class="line">        mTotalWidth = w;</span><br><span class="line">        mTotalHeight = h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="0">
<li>不使用任何效果的原图<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/origin.png"></li>
<li>CLEAR SRC会将DST部分给清除掉所以画出来的效果只有白色背景(所绘制不会提交到画布上)：<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/clear.png"></li>
<li>SRC 只保留源图像的 alpha 和 color<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/src.png"></li>
<li>DST 只保留目标图像的 alpha 和 color<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/dst.png"></li>
<li>SRC_OVER 在目标图片顶部绘制源图像,两个图都会显示<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/srcover.png"></li>
<li>DST_OVER 将目标图像绘制在上方。两个图都会显示<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/dstover.png"></li>
<li>SRC_IN 在两者相交的地方绘制源图像，<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/srcin.png"></li>
<li>DST_IN 在两者相交的地方绘制目标图像<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/dstin.png"></li>
<li>SRC_OUT 在不相交的地方绘制 源图像<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/srcout.png"></li>
<li>DST_OUT 在不相交的地方绘制 目标图像<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/dstout.png"></li>
<li>SRC_ATOP 源图像和目标图像相交处绘制源图像，不相交的地方绘制目标图像<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/srcatop.png"></li>
<li>DST_ATOP 源图像和目标图像相交处绘制目标图像，不相交的地方绘制源图像<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/dstatop.png"></li>
<li>XOR 在不相交的地方按原样绘制源图像和目标图像，相交的地方受到对应alpha和色值影响<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/xor.png"></li>
<li>DARKEN 该模式处理过后，会感觉效果变暗，即进行对应像素的比较，取较暗值<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/darken.png"></li>
<li>LIGHTEN 该模式处理过后，会感觉效果变亮<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/lighten.png"></li>
<li>MULTIPLY 将基色与混合色复合。结果色总是较暗的颜色<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/multipy.png"></li>
<li>SCREEN 保留两个图层中较白的部分，较暗的部分被遮盖<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/screen.png"></li>
</ol>
<p>我们知道现实生活中有两种常见的线条，一种是实线，一种是虚线，要绘制虚线我们就需要用到PathEffect<br>接下来的部分将会介绍使用setPathEffect()以及各种PathEffect</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> PathEffectView extends View &#123;</span><br><span class="line"></span><br><span class="line">    public <span class="constructor">PathEffectView(Context <span class="params">context</span>)</span> &#123;</span><br><span class="line">        super(context);</span><br><span class="line">        init<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="constructor">PathEffectView(Context <span class="params">context</span>, AttributeSet <span class="params">attrs</span>)</span> &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">        init<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="constructor">PathEffectView(Context <span class="params">context</span>, AttributeSet <span class="params">attrs</span>, <span class="params">int</span> <span class="params">defStyleAttr</span>)</span> &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">        init<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Paint mPaint;</span><br><span class="line">    <span class="keyword">private</span> void init<span class="literal">()</span> &#123;</span><br><span class="line">        mPaint = <span class="keyword">new</span> <span class="constructor">Paint()</span>;</span><br><span class="line">        mPaint.set<span class="constructor">AntiAlias(<span class="params">true</span>)</span>;</span><br><span class="line">        mPaint.set<span class="constructor">Style(Paint.Style.STROKE)</span>;</span><br><span class="line">        mPaint.set<span class="constructor">StrokeWidth(3)</span>;</span><br><span class="line">        init<span class="constructor">Path()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Path mPath;</span><br><span class="line">    <span class="keyword">private</span> void init<span class="constructor">Path()</span> &#123;</span><br><span class="line">        mPath = <span class="keyword">new</span> <span class="constructor">Path()</span>;</span><br><span class="line">        mPath.move<span class="constructor">To(10, 50)</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">30</span>; i++) &#123;</span><br><span class="line">            mPath.line<span class="constructor">To(<span class="params">i</span> <span class="operator">*</span> 35, (<span class="params">float</span>)</span> (<span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>random<span class="literal">()</span><span class="operator"> * </span><span class="number">500</span>+<span class="number">300</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void on<span class="constructor">Draw(Canvas <span class="params">canvas</span>)</span> &#123;</span><br><span class="line">        super.on<span class="constructor">Draw(<span class="params">canvas</span>)</span>;</span><br><span class="line">        canvas.draw<span class="constructor">Path(<span class="params">mPath</span>,<span class="params">mPaint</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>没有用任何效果的情况<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/none.png"><br>CornerPathEffect<br>CornerPathEffect的作用是将路径的转角变得圆滑，CornerPathEffect的构造方法接受一个参数radius，用于表示转角处的圆滑程度。<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/corner.png"><br>DiscretePathEffect 会在路径上绘制很多“杂点”。它的构造方法有两个参数：<br>第一个指定这些突出的“杂点”的密度，值越小杂点越密集；第二个参数是“杂点”突出的大小，值越大突出的距离越大。</p>
<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/dscreb.png"></p>
<p>DashPathEffect 它用于产生点画线，它的构造函数有两个：<br>第一个参数是一个浮点型的数组，在定义该参数的时候只要浮点型数组中元素个数大于等于2即可，<br>数组中偶数索引的值代表实线的长度，而奇数索引的值表示虚线的长度，<br>第二个参数为偏移值，动态改变其值会让路径产生动画的效果。<br><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/dist.png"><br>PathDashPathEffect<br>PathDashPathEffect和DashPathEffect是类似的，不同的是PathDashPathEffect可以让我们自己定义路径虚线的样式，比如我们将其换成一个个小圆组成的虚线：</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Path</span> <span class="keyword">path</span> = <span class="built_in">new</span> Path();</span><br><span class="line"><span class="type">path</span>.addRect(<span class="number">0</span>,<span class="number">0</span>,<span class="number">20</span>,<span class="number">20</span>, <span class="type">Path</span>.Direction.CCW);</span><br><span class="line">PathEffect pathEffect = <span class="built_in">new</span> PathDashPathEffect(<span class="type">path</span>, <span class="number">20</span>, <span class="number">1</span>, PathDashPathEffect.Style.ROTATE);</span><br><span class="line">mPaint.setPathEffect(pathEffect);</span><br></pre></td></tr></table></figure>

<p><img src="/2016/04/11/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%BA%8C-%E7%94%BB%E7%AC%94Paint/pathdash.png"></p>
<p>ComposePathEffect&amp;&amp;SumPathEffect<br>ComposePathEffect和SumPathEffect都可以用来组合两种路径效果，就是把两种效果二合一。唯一不同的是组合的方式：<br>ComposePathEffect(PathEffect outerpe, PathEffect innerpe)会先将路径变成innerpe的效果，再去复合outerpe的路径效果，即：outerpe(innerpe(Path))；<br>SumPathEffect(PathEffect first, PathEffect second)则会把两种路径效果加起来再作用于路径。</p>
<h3 id="颜色Color"><a href="#颜色Color" class="headerlink" title="颜色Color"></a>颜色Color</h3><p>开发一款Apk色彩搭配也是很重要的一个要素，今后会针对这个专题做个总结，在这里只是简单介绍下Android中颜色的使用：<br>我们可以按照如下方式使用Android已经提供了的颜色，这些颜色一般都是一些标准颜色：<br>Color.RED;<br>@android:color&#x2F;xxxxxx</p>
<p>还可以通过各个颜色分量的数值设置颜色<br>Color.argb(123, 45, 56, 67);<br>Color.rgb(123,23,44);</p>
<p>在只知道十六进制的情况下个人比较喜欢用下面的方式，一般UE给出的颜色也是这种形式<br>Color.parseColor(“#343434”);</p>
<p>Android 开发中常用的颜色，这个是网上找的。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;white&quot;</span>&gt;</span>#ffffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 白色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;ivory&quot;</span>&gt;</span>#fffff0<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 象牙色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightyellow&quot;</span>&gt;</span>#ffffe0<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮黄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;yellow&quot;</span>&gt;</span>#ffff00<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 黄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;snow&quot;</span>&gt;</span>#fffafa<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 雪白色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;floralwhite&quot;</span>&gt;</span>#fffaf0<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 花白色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lemonchiffon&quot;</span>&gt;</span>#fffacd<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 柠檬绸色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;cornsilk&quot;</span>&gt;</span>#fff8dc<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 米绸色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;seaShell&quot;</span>&gt;</span>#fff5ee<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 海贝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lavenderblush&quot;</span>&gt;</span>#fff0f5<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 淡紫红 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;papayawhip&quot;</span>&gt;</span>#ffefd5<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 番木色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;blanchedalmond&quot;</span>&gt;</span>#ffebcd<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 白杏色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mistyrose&quot;</span>&gt;</span>#ffe4e1<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 浅玫瑰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;bisque&quot;</span>&gt;</span>#ffe4c4<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 桔黄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;moccasin&quot;</span>&gt;</span>#ffe4b5<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 鹿皮色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;navajowhite&quot;</span>&gt;</span>#ffdead<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 纳瓦白 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;peachpuff&quot;</span>&gt;</span>#ffdab9<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 桃色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;gold&quot;</span>&gt;</span>#ffd700<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 金色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;pink&quot;</span>&gt;</span>#ffc0cb<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 粉红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightpink&quot;</span>&gt;</span>#ffb6c1<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮粉红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;orange&quot;</span>&gt;</span>#ffa500<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 橙色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightsalmon&quot;</span>&gt;</span>#ffa07a<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮肉色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkorange&quot;</span>&gt;</span>#ff8c00<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗桔黄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;coral&quot;</span>&gt;</span>#ff7f50<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 珊瑚色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;hotpink&quot;</span>&gt;</span>#ff69b4<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 热粉红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;tomato&quot;</span>&gt;</span>#ff6347<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 西红柿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;orangered&quot;</span>&gt;</span>#ff4500<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 红橙色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;deeppink&quot;</span>&gt;</span>#ff1493<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 深粉红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;fuchsia&quot;</span>&gt;</span>#ff00ff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 紫红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;magenta&quot;</span>&gt;</span>#ff00ff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 红紫色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;red&quot;</span>&gt;</span>#ff0000<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;oldlace&quot;</span>&gt;</span>#fdf5e6<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 老花色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightgoldenrodyellow&quot;</span>&gt;</span>#fafad2<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮金黄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;linen&quot;</span>&gt;</span>#faf0e6<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亚麻色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;antiquewhite&quot;</span>&gt;</span>#faebd7<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 古董白 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;salmon&quot;</span>&gt;</span>#fa8072<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 鲜肉色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;ghostwhite&quot;</span>&gt;</span>#f8f8ff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 幽灵白 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mintcream&quot;</span>&gt;</span>#f5fffa<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 薄荷色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;whitesmoke&quot;</span>&gt;</span>#f5f5f5<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 烟白色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;beige&quot;</span>&gt;</span>#f5f5dc<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 米色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;wheat&quot;</span>&gt;</span>#f5deb3<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 浅黄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;sandybrown&quot;</span>&gt;</span>#f4a460<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 沙褐色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;azure&quot;</span>&gt;</span>#f0ffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 天蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;honeydew&quot;</span>&gt;</span>#f0fff0<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 蜜色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;aliceblue&quot;</span>&gt;</span>#f0f8ff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 艾利斯兰 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;khaki&quot;</span>&gt;</span>#f0e68c<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 黄褐色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightcoral&quot;</span>&gt;</span>#f08080<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮珊瑚色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;palegoldenrod&quot;</span>&gt;</span>#eee8aa<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 苍麒麟色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;violet&quot;</span>&gt;</span>#ee82ee<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 紫罗兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darksalmon&quot;</span>&gt;</span>#e9967a<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗肉色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lavender&quot;</span>&gt;</span>#e6e6fa<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 淡紫色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightcyan&quot;</span>&gt;</span>#e0ffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮青色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;burlywood&quot;</span>&gt;</span>#deb887<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 实木色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;plum&quot;</span>&gt;</span>#dda0dd<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 洋李色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;gainsboro&quot;</span>&gt;</span>#dcdcdc<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 淡灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;crimson&quot;</span>&gt;</span>#dc143c<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗深红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;palevioletred&quot;</span>&gt;</span>#db7093<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 苍紫罗兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;goldenrod&quot;</span>&gt;</span>#daa520<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 金麒麟色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;orchid&quot;</span>&gt;</span>#da70d6<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 淡紫色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;thistle&quot;</span>&gt;</span>#d8bfd8<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 蓟色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightgray&quot;</span>&gt;</span>#d3d3d3<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightgrey&quot;</span>&gt;</span>#d3d3d3<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;tan&quot;</span>&gt;</span>#d2b48c<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 茶色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;chocolate&quot;</span>&gt;</span>#d2691e<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 巧可力色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;peru&quot;</span>&gt;</span>#cd853f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 秘鲁色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;indianred&quot;</span>&gt;</span>#cd5c5c<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 印第安红 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumvioletred&quot;</span>&gt;</span>#c71585<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中紫罗兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;silver&quot;</span>&gt;</span>#c0c0c0<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 银色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkkhaki&quot;</span>&gt;</span>#bdb76b<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗黄褐色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;rosybrown&quot;</span>&gt;</span>#bc8f8f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 褐玫瑰红 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumorchid&quot;</span>&gt;</span>#ba55d3<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中粉紫色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkgoldenrod&quot;</span>&gt;</span>#b8860b<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗金黄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;firebrick&quot;</span>&gt;</span>#b22222<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 火砖色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;powderblue&quot;</span>&gt;</span>#b0e0e6<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 粉蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightsteelblue&quot;</span>&gt;</span>#b0c4de<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮钢兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;paleturquoise&quot;</span>&gt;</span>#afeeee<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 苍宝石绿 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;greenyellow&quot;</span>&gt;</span>#adff2f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 黄绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightblue&quot;</span>&gt;</span>#add8e6<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkgray&quot;</span>&gt;</span>#a9a9a9<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkgrey&quot;</span>&gt;</span>#a9a9a9<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;brown&quot;</span>&gt;</span>#a52a2a<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 褐色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;sienna&quot;</span>&gt;</span>#a0522d<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 赭色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkorchid&quot;</span>&gt;</span>#9932cc<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗紫色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;palegreen&quot;</span>&gt;</span>#98fb98<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 苍绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkviolet&quot;</span>&gt;</span>#9400d3<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗紫罗兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumpurple&quot;</span>&gt;</span>#9370db<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中紫色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightgreen&quot;</span>&gt;</span>#90ee90<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkseagreen&quot;</span>&gt;</span>#8fbc8f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗海兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;saddlebrown&quot;</span>&gt;</span>#8b4513<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 重褐色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkmagenta&quot;</span>&gt;</span>#8b008b<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗洋红 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkred&quot;</span>&gt;</span>#8b0000<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗红色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;blueviolet&quot;</span>&gt;</span>#8a2be2<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 紫罗兰蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightskyblue&quot;</span>&gt;</span>#87cefa<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮天蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;skyblue&quot;</span>&gt;</span>#87ceeb<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 天蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;gray&quot;</span>&gt;</span>#808080<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;grey&quot;</span>&gt;</span>#808080<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;olive&quot;</span>&gt;</span>#808000<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 橄榄色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;purple&quot;</span>&gt;</span>#800080<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 紫色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;maroon&quot;</span>&gt;</span>#800000<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 粟色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;aquamarine&quot;</span>&gt;</span>#7fffd4<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 碧绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;chartreuse&quot;</span>&gt;</span>#7fff00<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 黄绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lawngreen&quot;</span>&gt;</span>#7cfc00<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 草绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumslateblue&quot;</span>&gt;</span>#7b68ee<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中暗蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightslategray&quot;</span>&gt;</span>#778899<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮蓝灰 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightslategrey&quot;</span>&gt;</span>#778899<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮蓝灰 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;slategray&quot;</span>&gt;</span>#708090<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 灰石色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;slategrey&quot;</span>&gt;</span>#708090<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 灰石色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;olivedrab&quot;</span>&gt;</span>#6b8e23<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 深绿褐色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;slateblue&quot;</span>&gt;</span>#6a5acd<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 石蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;dimgray&quot;</span>&gt;</span>#696969<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;dimgrey&quot;</span>&gt;</span>#696969<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumaquamarine&quot;</span>&gt;</span>#66cdaa<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;cornflowerblue&quot;</span>&gt;</span>#6495ed<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 菊兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;cadetblue&quot;</span>&gt;</span>#5f9ea0<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 军兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkolivegreen&quot;</span>&gt;</span>#556b2f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗橄榄绿 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;indigo&quot;</span>&gt;</span>#4b0082<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 靛青色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumturquoise&quot;</span>&gt;</span>#48d1cc<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中绿宝石 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkslateblue&quot;</span>&gt;</span>#483d8b<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗灰蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;steelblue&quot;</span>&gt;</span>#4682b4<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 钢兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;royalblue&quot;</span>&gt;</span>#4169e1<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 皇家蓝 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;turquoise&quot;</span>&gt;</span>#40e0d0<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 青绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumseagreen&quot;</span>&gt;</span>#3cb371<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中海蓝 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;limegreen&quot;</span>&gt;</span>#32cd32<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 橙绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkslategray&quot;</span>&gt;</span>#2f4f4f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗瓦灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkslategrey&quot;</span>&gt;</span>#2f4f4f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗瓦灰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;seagreen&quot;</span>&gt;</span>#2e8b57<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 海绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;forestgreen&quot;</span>&gt;</span>#228b22<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 森林绿 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lightseagreen&quot;</span>&gt;</span>#20b2aa<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 亮海蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;dodgerblue&quot;</span>&gt;</span>#1e90ff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 闪兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;midnightblue&quot;</span>&gt;</span>#191970<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中灰兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;aqua&quot;</span>&gt;</span>#00ffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 浅绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;cyan&quot;</span>&gt;</span>#00ffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 青色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;springgreen&quot;</span>&gt;</span>#00ff7f<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 春绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;lime&quot;</span>&gt;</span>#00ff00<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 酸橙色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumspringgreen&quot;</span>&gt;</span>#00fa9a<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中春绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkturquoise&quot;</span>&gt;</span>#00ced1<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗宝石绿 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;deepskyblue&quot;</span>&gt;</span>#00bfff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 深天蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkcyan&quot;</span>&gt;</span>#008b8b<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗青色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;teal&quot;</span>&gt;</span>#008080<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 水鸭色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;green&quot;</span>&gt;</span>#008000<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkgreen&quot;</span>&gt;</span>#006400<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗绿色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>#0000ff<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;mediumblue&quot;</span>&gt;</span>#0000cd<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 中兰色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;darkblue&quot;</span>&gt;</span>#00008b<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 暗蓝色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;navy&quot;</span>&gt;</span>#000080<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 海军色 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;black&quot;</span>&gt;</span>#000000<span class="tag">&lt;/<span class="name">color</span>&gt;</span> <span class="comment">&lt;!-- 黑色 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>


        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E8%BF%9B%E9%98%B6/">Android进阶</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android-绘图进阶/">Android 绘图进阶</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/11/Android-进阶之Android-绘图-二-画笔Paint/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/11/Android-进阶之Android-绘图-二-画笔Paint/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/10/Android-进阶之Android-绘图-一-Android坐标体系及屏幕尺寸相关概念/" title="Android 进阶之Android 绘图 一 Android坐标体系及屏幕尺寸相关概念" itemprop="url">Android 进阶之Android 绘图 一 Android坐标体系及屏幕尺寸相关概念</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-10T03:30:06.000Z" itemprop="datePublished"> Published 2016-04-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="Android-坐标体系"><a href="#Android-坐标体系" class="headerlink" title="Android 坐标体系"></a>Android 坐标体系</h3><p>&#x2F;home&#x2F;jimmy&#x2F;Blog&#x2F;tbfungeek.github.io&#x2F;source&#x2F;_posts&#x2F;Android-进阶之Android-绘图-一-Android坐标体系及屏幕尺寸相关概念<br><img src="/2016/04/10/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E4%B8%80-Android%E5%9D%90%E6%A0%87%E4%BD%93%E7%B3%BB%E5%8F%8A%E5%B1%8F%E5%B9%95%E5%B0%BA%E5%AF%B8%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/axis.png"></p>
<p>Android 坐标体系如上图所示，竖直向下为Y轴的正方向，水平向右边为X轴的正方向。手机屏幕的左上角为坐标原点</p>
<p>这里我们可以通过如下方法获得关键的坐标点坐标：</p>
<ul>
<li><p>第一类为当前坐标所处的屏幕位置，这些坐标是相对于父View的相对位置：<br>getLeft() 当前View  左边缘距离父视图最左边的距离<br>getRight() 当前View 右边缘距离父视图最左边的距离<br>getTop() 当前View 上边缘距离父视图最上边的距离<br>getBottom() 当前View 下边缘距离父视图最上边的距离</p>
</li>
<li><p>第二类为当前触点的位置：<br>getX() 当前触点距离所处View的左边边距的位置<br>getY() 当前触点距离所处View的上边边距的位置<br>getRawX()  当前触点距离屏幕左边边距的位置<br>getRawY()  当前触点距离屏幕上边边距的位置</p>
</li>
</ul>
<h3 id="屏幕尺寸相关概念"><a href="#屏幕尺寸相关概念" class="headerlink" title="屏幕尺寸相关概念"></a>屏幕尺寸相关概念</h3><p>屏幕大小：屏幕对角线的长度，单位为英寸<br>分辨率：手机屏幕的像素点个数<br>像素密度：每英寸像素个数，它是对角线的像素除以屏幕大小<br>目前收集根据像素密度可以分成如下几类，其中Android系统中以160dpi mdpi作为参考，也就是说以mdpi的1像素，作为1dpi<br>各个dpi之间的换算比为3：4：6：8：12</p>
<p>| ldpi | mdpi |hdpi | xhdpi | xxhdpi |<br>|——–|——–|——–|——–|——–|——–|——–|——–|<br>|    120dip |   160dpi     |  240dpi      |    320dip    | 480dip       |</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E8%BF%9B%E9%98%B6/">Android进阶</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android-绘图进阶/">Android 绘图进阶</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/10/Android-进阶之Android-绘图-一-Android坐标体系及屏幕尺寸相关概念/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/10/Android-进阶之Android-绘图-一-Android坐标体系及屏幕尺寸相关概念/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/09/Android-进阶之Android-绘图-零-大纲/" title="Android 进阶之Android 绘图 零 大纲" itemprop="url">Android 进阶之Android 绘图 零 大纲</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-09T03:32:42.000Z" itemprop="datePublished"> Published 2016-04-09</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>接下来的几个章节将对Android绘图部分进行一个简单的总结，大致的内容如下图所示：</p>
<p><img src="/2016/04/09/Android-%E8%BF%9B%E9%98%B6%E4%B9%8BAndroid-%E7%BB%98%E5%9B%BE-%E9%9B%B6-%E5%A4%A7%E7%BA%B2/all.png"></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E8%BF%9B%E9%98%B6/">Android进阶</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android-绘图进阶/">Android 绘图进阶</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/09/Android-进阶之Android-绘图-零-大纲/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/09/Android-进阶之Android-绘图-零-大纲/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/08/Android-初步之语音朗读和语音识别/" title="Android 初步之语音朗读和语音识别" itemprop="url">Android 初步之语音朗读和语音识别</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-08T12:05:35.000Z" itemprop="datePublished"> Published 2016-04-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="语音朗读"><a href="#语音朗读" class="headerlink" title="语音朗读"></a>语音朗读</h4><p>语音朗读：Text-to-Speech</p>
<ul>
<li>首先确认是否安装了语音包</li>
</ul>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Intent</span> <span class="keyword">intent</span> = new <span class="keyword">Intent</span>(Engine.ACTION_CHECK_TTS_DATA);</span><br><span class="line">startActivityForResult(<span class="keyword">intent</span>, TTS_DATA_CHECK);</span><br></pre></td></tr></table></figure>

<p>如果安装了语言包那么返回的将是Engine.CHECK_VOICE_DATA_PASS</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">protected void on<span class="constructor">ActivityResult(<span class="params">int</span> <span class="params">requestCode</span>, <span class="params">int</span> <span class="params">resultCode</span>, Intent <span class="params">data</span>)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (requestCode<span class="operator"> == </span>TTS_DATA_CHECK) &#123;</span><br><span class="line">		<span class="keyword">if</span> (resultCode<span class="operator"> == </span>Engine.CHECK_VOICE_DATA_PASS) &#123;</span><br><span class="line">			<span class="comment">//表示已经安装了语言包</span></span><br><span class="line">		&#125;</span><br><span class="line">		super.on<span class="constructor">ActivityResult(<span class="params">requestCode</span>, <span class="params">resultCode</span>, <span class="params">data</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建并初始化TTS</li>
</ul>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">protected</span> void onActivityResult(int requestCode, int resultCode, <span class="type">Intent</span> <span class="class"><span class="keyword">data</span>) &#123;</span></span><br><span class="line"><span class="class">	<span class="title">if</span> (<span class="title">requestCode</span> == <span class="type">TTS_DATA_CHECK</span>) &#123;</span></span><br><span class="line"><span class="class">        <span class="title">if</span> (<span class="title">resultCode</span> == <span class="type">Engine</span>.<span class="type">CHECK_VOICE_DATA_PASS</span>) &#123;</span></span><br><span class="line"><span class="class">            <span class="title">tts</span> = <span class="title">new</span> <span class="type">TextToSpeech</span>(<span class="type">MainActivity</span>.<span class="title">this</span>, <span class="title">new</span> <span class="type">OnInitListener</span>() &#123;</span></span><br><span class="line"><span class="class">                <span class="title">public</span> <span class="title">void</span> <span class="title">onInit</span>(<span class="title">int</span> <span class="title">status</span>) &#123;</span></span><br><span class="line"><span class="class">                    <span class="title">if</span> (<span class="title">status</span> == <span class="type">TextToSpeech</span>.<span class="type">SUCCESS</span>) &#123;</span></span><br><span class="line"><span class="class">                        <span class="title">ttsInit</span> = <span class="title">true</span>;</span></span><br><span class="line"><span class="class">                        <span class="title">if</span> (<span class="title">tts</span>.<span class="title">isLanguageAvailable</span>(<span class="type">Locale</span>.<span class="type">UK</span>) &gt; 0) &#123;</span></span><br><span class="line"><span class="class">                            <span class="title">tts</span>.<span class="title">setLanguage</span>(<span class="type">Locale</span>.<span class="type">UK</span>);</span></span><br><span class="line"><span class="class">                            <span class="title">tts</span>.<span class="title">setPitch</span>(0.8<span class="title">f</span>);</span></span><br><span class="line"><span class="class">                            <span class="title">tts</span>.<span class="title">setSpeechRate</span>(1.1<span class="title">f</span>);</span></span><br><span class="line"><span class="class">                        &#125;</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="type">Intent</span> intent = new <span class="type">Intent</span>(</span><br><span class="line">                        <span class="type">Engine</span>.<span class="type">ACTION_INSTALL_TTS_DATA</span>);</span><br><span class="line">                        startActivity(intent);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	super.onActivityResult(requestCode, resultCode, <span class="class"><span class="keyword">data</span>);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用TTS朗读</li>
</ul>
<figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> onClick(View v) &#123;</span><br><span class="line">	String <span class="built_in">str</span> = mTextToSpeechEt.getText().toString().trim();</span><br><span class="line">	<span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">        <span class="keyword">case</span> R.id.readBtn:</span><br><span class="line">            <span class="keyword">if</span> (!TextUtils.isEmpty(<span class="built_in">str</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tts != <span class="literal">null</span> &amp;&amp; ttsInit) &#123;</span><br><span class="line">                    tts.speak(<span class="built_in">str</span>, TextToSpeech.QUEUE_ADD, <span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="literal">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在销毁的时候关闭TTS资源</li>
</ul>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">protected void <span class="built_in">onDestroy</span>() &#123;</span><br><span class="line">	if (tts != null) &#123;</span><br><span class="line">		tts<span class="selector-class">.stop</span>();</span><br><span class="line">		tts<span class="selector-class">.shutdown</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	super<span class="selector-class">.onDestroy</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="语音识别"><a href="#语音识别" class="headerlink" title="语音识别"></a>语音识别</h4><h5 id="应用程序中接收输入语音"><a href="#应用程序中接收输入语音" class="headerlink" title="应用程序中接收输入语音"></a>应用程序中接收输入语音</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*允许在应用程序中接收输入语音*/</span></span><br><span class="line"><span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span>  <span class="title class_">Intent</span>(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);</span><br><span class="line"><span class="comment">/*指定用于分析输入音频的语言模型*/</span></span><br><span class="line">intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);</span><br><span class="line"><span class="comment">/*指定返回潜在识别的结果*/</span></span><br><span class="line">intent.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, <span class="number">1</span>);</span><br><span class="line">intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE, Locale.CHINA);</span><br><span class="line"><span class="comment">/*提示用户讲话*/</span></span><br><span class="line">intent.putExtra(RecognizerIntent.EXTRA_PROMPT, <span class="string">&quot;请讲话&quot;</span>);</span><br><span class="line">startActivityForResult(intent, RECOGNIZE);</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onActivityResult</span><span class="params">(<span class="type">int</span> requestCode, <span class="type">int</span> resultCode, Intent data)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span>(requestCode==RECOGNIZE)&#123;</span><br><span class="line">	<span class="keyword">if</span>(resultCode==RESULT_OK)&#123;</span><br><span class="line">		 ArrayList&lt;String&gt; result = data.getStringArrayListExtra(</span><br><span class="line">				RecognizerIntent.EXTRA_RESULTS);</span><br><span class="line">		<span class="type">float</span> [] configence = 		</span><br><span class="line">		            data.getFloatArrayExtra(</span><br><span class="line">				RecognizerIntent.EXTRA_CONFIDENCE_SCORES);</span><br><span class="line">		<span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;result.size();i++)&#123;</span><br><span class="line">			sb.append(result.get(i)+<span class="string">&quot;:   &quot;</span>+configence[i]+<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		mResultTV.setText(sb.toString());</span><br><span class="line">	&#125;&#125;</span><br><span class="line">	<span class="built_in">super</span>.onActivityResult(requestCode, resultCode, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="启动网络搜索"><a href="#启动网络搜索" class="headerlink" title="启动网络搜索"></a>启动网络搜索</h5><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Intent webIntent = <span class="keyword">new</span> <span class="constructor">Intent(RecognizerIntent.ACTION_WEB_SEARCH)</span>;</span><br><span class="line">webIntent.put<span class="constructor">Extra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_WEB_SEARCH)</span>;</span><br><span class="line">start<span class="constructor">ActivityForResult(<span class="params">webIntent</span>, 0)</span>;</span><br></pre></td></tr></table></figure>


        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/08/Android-初步之语音朗读和语音识别/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/08/Android-初步之语音朗读和语音识别/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/07/Android-初步之剪贴板/" title="Android 初步之剪贴板" itemprop="url">Android 初步之剪贴板</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-07T11:55:34.000Z" itemprop="datePublished"> Published 2016-04-07</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="剪贴板"><a href="#剪贴板" class="headerlink" title="剪贴板"></a>剪贴板</h4><p>Android 3.0 引入了使用ClipBoard Manager在应用程序内部之间进行完全复制和粘贴操作，剪贴板的获得如下：</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">ClipboardManager clipBoard <span class="operator">=</span> (ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>剪贴板支持文本字符串，URI通常指向一个Content Provider项，Intent用于复制应用程序的快捷方式。</p>
<p>要想把数据添加到剪贴板上可以使用setPrimaryClip(new Clip);</p>
<h4 id="复制"><a href="#复制" class="headerlink" title="复制"></a>复制</h4><p>ClipData类提供了大量的方法用来创建一个ClipData：<br>使用newPaintText方法创建一个新的ClipData对象，该对象包含一个字符用于对当前的数据进行描述，并且把数据类型设置为MIMETYPE_TEXT_PLAIN.</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">ClipData newClip = <span class="module-access"><span class="module"><span class="identifier">ClipData</span>.</span></span><span class="keyword">new</span><span class="constructor">PlainText(<span class="string">&quot;newClips&quot;</span>, <span class="params">mSetClipEt</span>.<span class="params">getText</span>()</span>.<span class="keyword">to</span><span class="constructor">String()</span>);</span><br></pre></td></tr></table></figure>

<p>对于基于Content Provider的项，可以使用newUri方法，指定一个Content Resolver，标签和待粘贴数据的URI</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">ClipData</span>.</span></span><span class="keyword">new</span><span class="constructor">Uri(<span class="params">getContentResolver</span>()</span>, <span class="string">&quot;label&quot;</span>, uri);</span><br></pre></td></tr></table></figure>

<h4 id="粘贴"><a href="#粘贴" class="headerlink" title="粘贴"></a>粘贴</h4><p><img src="/2016/04/07/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%89%AA%E8%B4%B4%E6%9D%BF/1.png"></p>
<h4 id="粘贴自定义对象"><a href="#粘贴自定义对象" class="headerlink" title="粘贴自定义对象"></a>粘贴自定义对象</h4><p>读取自定义对象，并将其转换为字符串，写入剪切板:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">MyData md = <span class="keyword">new</span> <span class="constructor">MyData(<span class="string">&quot;kimifdw&quot;</span>,26)</span>;  </span><br><span class="line"><span class="comment">//定义字符串  </span></span><br><span class="line">String baseToString =<span class="string">&quot;&quot;</span>;  </span><br><span class="line"><span class="comment">//1.将对象转换成字符串  </span></span><br><span class="line">ByteArrayOutputStream byteArrayOutputStream = <span class="keyword">new</span> <span class="constructor">ByteArrayOutputStream()</span>;  </span><br><span class="line"><span class="keyword">try</span>  </span><br><span class="line">&#123;  </span><br><span class="line">    ObjectOutputStream objectOutputStream = <span class="keyword">new</span> <span class="constructor">ObjectOutputStream(<span class="params">byteArrayOutputStream</span>)</span>;  </span><br><span class="line">    objectOutputStream.write<span class="constructor">Object(<span class="params">md</span>)</span>;  </span><br><span class="line">    baseToString = <span class="module-access"><span class="module"><span class="identifier">Base64</span>.</span></span>encode<span class="constructor">ToString(<span class="params">byteArrayOutputStream</span>.<span class="params">toByteArray</span>()</span>, Base64.DEFAULT);  </span><br><span class="line">    objectOutputStream.close<span class="literal">()</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">catch(Exception e)  </span><br><span class="line">&#123;  </span><br><span class="line">    e.print<span class="constructor">StackTrace()</span>;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>读取剪切板的字符串，并将其转换为对象</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">byte<span class="literal">[]</span> base64ToString = <span class="module-access"><span class="module"><span class="identifier">Base64</span>.</span></span>decode(item.get<span class="constructor">Text()</span>.<span class="keyword">to</span><span class="constructor">String()</span>, Base64.DEFAULT);  </span><br><span class="line"><span class="comment">//从流中读取数据  </span></span><br><span class="line">ByteArrayInputStream byteArrayInputStream = <span class="keyword">new</span> <span class="constructor">ByteArrayInputStream(<span class="params">base64ToString</span>)</span>;  </span><br><span class="line"><span class="keyword">try</span>  </span><br><span class="line">&#123;  </span><br><span class="line">      ObjectInputStream objectInputStream = <span class="keyword">new</span> <span class="constructor">ObjectInputStream(<span class="params">byteArrayInputStream</span>)</span>;  </span><br><span class="line">      MyData md = (MyData)objectInputStream.read<span class="constructor">Object()</span>;  </span><br><span class="line">     objectInputStream.close<span class="literal">()</span>;  </span><br><span class="line">      txtView.set<span class="constructor">Text(<span class="params">md</span>.<span class="params">toString</span>()</span>);  </span><br><span class="line">&#125;  </span><br><span class="line">catch(Exception e)  </span><br><span class="line">&#123;  </span><br><span class="line">      e.print<span class="constructor">StackTrace()</span>;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="一个简单的例子"><a href="#一个简单的例子" class="headerlink" title="一个简单的例子"></a>一个简单的例子</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">	<span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">	setContentView(R.layout.activity_main);</span><br><span class="line">	mShowClipTv = (TextView) findViewById(R.id.showClip);</span><br><span class="line">	mSetClipEt = (EditText) findViewById(R.id.setClip);</span><br><span class="line">	mClipBtn = (Button) findViewById(R.id.clipBtn);</span><br><span class="line">	mPasteBtn = (Button) findViewById(R.id.pasteBtn);</span><br><span class="line">	clipBoard = (ClipboardManager)getSystemService(Context.CLIPBOARD_SERVICE);</span><br><span class="line">	mClipBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">	mPasteBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">	<span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">		<span class="keyword">case</span> R.id.clipBtn:</span><br><span class="line">		<span class="type">ClipData</span> <span class="variable">newClip</span> <span class="operator">=</span> ClipData.newPlainText(<span class="string">&quot;newClips&quot;</span>,mSetClipEt.getText().toString());</span><br><span class="line">		clipBoard.setPrimaryClip(newClip);</span><br><span class="line">		Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;复制成功&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.pasteBtn:</span><br><span class="line">		<span class="keyword">if</span>(clipBoard.getPrimaryClipDescription()</span><br><span class="line">		.hasMimeType(ClipDescription</span><br><span class="line">		.MIMETYPE_TEXT_PLAIN)) &#123;</span><br><span class="line">			<span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> clipBoard.getPrimaryClip().getItemAt(<span class="number">0</span>);</span><br><span class="line">			mShowClipTv.setText(item.getText());</span><br><span class="line">			Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;粘贴成功&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;文本格式&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/07/Android-初步之剪贴板/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/07/Android-初步之剪贴板/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/06/Android-初步之Android-安全机制/" title="Android 初步之Android 安全机制" itemprop="url">Android 初步之Android 安全机制</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-06T11:51:27.000Z" itemprop="datePublished"> Published 2016-04-06</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><p>Android 是一个多任务的系统,所以安全成了一个系统中一大重要的课题，为了保证应用的数据安全采用了应用签名，沙箱机制，权限机制等三种机制，在Android系统中用户在安装了一个应用程序后，操作系统为该应用程序创建一个与之关联的新的用户配置文件，每个应用程序都作为不同的用户运行，它在文件系统中拥有自己的文件，用户ID和一个安全的操作环境。应用程序在操作系统上使用自己的用户ID，自己的Dalvik虚拟机实例运行在自己的进程内。要访问系统上的共享资源，Android应用程序需要注册所需的权限，同时可以将自己的权限声明为可供其他程序使用，也可以为了更加精细得控制应程序而声明任意数量的不同权限，如只读，读写权限。作为内容提供的应用程序也可能需要为其他应用程序提供即时的权限，以共享特定的信息，这可以通过使用URI来进行临时的授权与撤销。应用程序通过签名建立用户信任，所有的Android应用程序包都使用证书进行了签名，这样用户可以了解应用程序的可靠性。证书的私钥为开发人员所有，这有助于在开发人员和用户之间建立一种信任关系。要在Android市场上发布应用程序，开发人员需要创建一个账号，Android市场管理非常严密，不允许出现任何的恶意软件。Android平台上没有本地应用和开发人员创建的第三方应用程序的区别，在为应用程序提供适当授权后，所有的应用程序都具有对核心库和底层硬件接口的访问权。</p>
<p><img src="/2016/04/06/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/1.png"></p>
<p><img src="/2016/04/06/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/2.png"></p>
<h4 id="沙箱机制"><a href="#沙箱机制" class="headerlink" title="沙箱机制"></a>沙箱机制</h4><p>应用的签名已经在之前的博客中已经做了介绍，这里就不再详细展开。</p>
<p>下面重点介绍沙箱机制和权限机制：</p>
<p>上面介绍过Linux内核给每个用户分配一个UID，用户可同时拥有多个运行进程，每个进程都运行于各自独立的内存空间，进程与进程之前无法进行数据访问，Android为每个应用程序分配一个UID，通过这种方式将每一个应用程序置于“沙箱”之内，实现应用程序之间的隔离，通过权限限制API调用及数据访问</p>
<p>不同数据之间数据是不能相互访问是，而同一个UID的应用之间可以共享数据，如下图所示：</p>
<p><img src="/2016/04/06/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/3.png"><br><img src="/2016/04/06/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/4.png"></p>
<p>要想两个应用通过UID共享数据需要在在Manifest节点中增加相同的android:sharedUserId属性，并确保共享数据的两个应用拥有相同的签名</p>
<h4 id="Android系统权限机制"><a href="#Android系统权限机制" class="headerlink" title="Android系统权限机制"></a>Android系统权限机制</h4><p>系统已定义的权限，我们可以通过执行</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>adb shell pm list permissions查看</span><br></pre></td></tr></table></figure>

<p>我们可以通过在应用的Manifest使用这些权限来达到访问被保护的API或资源的目的，但并不是使用了就一定能够访问的，需要看指定权限的保护级别。</p>
<h5 id="定义权限："><a href="#定义权限：" class="headerlink" title="定义权限："></a>定义权限：</h5><p>在应用中自定义权限，我们可以在应用的Manifest文件中进行权限声明，基本格式如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span>       </span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.tct.permission.START_JIMMY_ACTIVITY&quot;</span>        </span></span><br><span class="line"><span class="tag">    <span class="attr">android:protectionLevel</span>=<span class="string">&quot;normal&quot;</span>        </span></span><br><span class="line"><span class="tag">    <span class="attr">android:label</span>=<span class="string">&quot;@string/lable_start_Act&quot;</span>        </span></span><br><span class="line"><span class="tag">    <span class="attr">android:description</span>=<span class="string">&quot;@string/permdesc_startAct&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">permission</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>定义权限的四个关键属性如下所示：</p>
<p><img src="/2016/04/06/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/5.png"><br><img src="/2016/04/06/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/6.png"><br><img src="/2016/04/06/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid-%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/8.png"></p>
<p>权限的使用方式，通过在Manifest文件中声明<uses-permission>标签来使用已定义的权限，从而达到访问受保护数据的目的：</uses-permission></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission android:<span class="attribute">name</span>=<span class="string">&quot;com.idealist.permission.START_JIMMY_ACTIVITY&quot;</span>/&gt;</span><br><span class="line">&lt;uses-permission android:<span class="attribute">name</span>=<span class="string">&quot;com.idealist.permission.WRITE_CONTENTPROVIDER&quot;</span>/&gt;</span><br><span class="line">&lt;uses-permission android:<span class="attribute">name</span>=<span class="string">&quot;com.idealist.permission.READ_CONTENTPROVIDER&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>下面是几个比较典型的例子：</p>
<h5 id="从一个应用的Activity启动另一个应用中的Activity"><a href="#从一个应用的Activity启动另一个应用中的Activity" class="headerlink" title="从一个应用的Activity启动另一个应用中的Activity"></a>从一个应用的Activity启动另一个应用中的Activity</h5><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">ComponentName componentName = <span class="keyword">new</span> <span class="type">ComponentName</span>(</span><br><span class="line"><span class="string">&quot;com.idealist.test.activity&quot;</span>,<span class="comment">/*包路径*/</span></span><br><span class="line"><span class="string">&quot;com.idealist.test.activity.DemoActivity&quot;</span><span class="comment">/*Activity类*/</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">Intent intent = <span class="keyword">new</span> <span class="type">Intent</span>();</span><br><span class="line">Bundle bundle = <span class="keyword">new</span> <span class="type">Bundle</span>();</span><br><span class="line">bundle.putString(<span class="string">&quot;resUrl&quot;</span>, resurl);</span><br><span class="line">bundle.putSerializable(<span class="string">&quot;picUrlList&quot;</span>, picurllist);</span><br><span class="line">intent.putExtras(bundle);</span><br><span class="line">intent.setComponent(componentName);</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure>

<h5 id="从一个应用中控制另一个应用中的服务"><a href="#从一个应用中控制另一个应用中的服务" class="headerlink" title="从一个应用中控制另一个应用中的服务"></a>从一个应用中控制另一个应用中的服务</h5><p>首先需要在声明服务的时候将enable和exported设置为true</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;service Android:<span class="attribute">name</span>=<span class="string">&quot;.xxxService&quot;</span> android:<span class="attribute">enabled</span>=<span class="string">&quot;true&quot;</span> android:<span class="attribute">exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>然后和上一个例子一样使用完整的包名来设置component</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Intent  testIntent = <span class="keyword">new</span><span class="constructor">Intent()</span>;</span><br><span class="line">testIntent.set<span class="constructor">Component(<span class="params">new</span> ComponentName(<span class="string">&quot;包名&quot;</span>,<span class="string">&quot;包名.xxxService&quot;</span>)</span>);</span><br><span class="line">booleanisbind=bind<span class="constructor">Service(<span class="params">testIntent</span>,<span class="params">serviceConnection</span>,Context.BIND_AUTO_CREATE)</span>;</span><br></pre></td></tr></table></figure>


<h5 id="发送带权限的广播以及给广播接收器添加权限"><a href="#发送带权限的广播以及给广播接收器添加权限" class="headerlink" title="发送带权限的广播以及给广播接收器添加权限"></a>发送带权限的广播以及给广播接收器添加权限</h5><ul>
<li>权限定义，并且使用自定义权限</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.idealist.permissions.MY_BROADCAST&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.idealist.permissions.MY_BROADCAST&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:protectionLevel</span>=<span class="string">&quot;signature&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">permission</span>&gt;</span></span><br></pre></td></tr></table></figure>


<ul>
<li>自定义并注册广播</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BROADCAST_PERMISSION_DISC</span> <span class="operator">=</span> <span class="string">&quot;com.idealist.permissions.MY_BROADCAST&quot;</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BROADCAST_ACTION_DISC</span> <span class="operator">=</span> <span class="string">&quot;com.idealist.permissions.my_broadcast&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.test_permissions_activity);</span><br><span class="line">    <span class="comment">//......................................</span></span><br><span class="line">    <span class="comment">// 注册广播接收</span></span><br><span class="line">    <span class="type">BroadcastReceiver</span> <span class="variable">receiveBroadCast</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReceiveBroadCast</span>();</span><br><span class="line">    <span class="type">IntentFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntentFilter</span>();</span><br><span class="line">    filter.addAction(BROADCAST_ACTION_DISC); </span><br><span class="line">    registerReceiver(receiveBroadCast, filter,BROADCAST_PERMISSION_DISC,<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveBroadCast</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        Toast.makeText(BroadcastPermissionsActivity.<span class="built_in">this</span>,</span><br><span class="line">                <span class="string">&quot;Hello!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注册一个广播，并且申明，这个广播需要BROADCAST_PERMISSION_DISC权限才能收到消息。但是我们应用程序已经注册了这个权限。所以是有这个权限的。</p>
<ul>
<li>发送广播<br>发送广播的函数有好几个，其中一个是sendBroadcast(Intent intent, String receiverPermission)。使用这个函数发送广播之后，接收器需要先注册权限才可以接收的。<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> void sendBroadcastWithPermissions() &#123;</span><br><span class="line">    <span class="keyword">Intent</span> <span class="keyword">intent</span> = new <span class="keyword">Intent</span>();  </span><br><span class="line">    <span class="keyword">intent</span>.setAction(BROADCAST_ACTION_DISC);   </span><br><span class="line">    sendBroadcast(<span class="keyword">intent</span>,BROADCAST_PERMISSION_DISC);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="给Content-Provider设置权限"><a href="#给Content-Provider设置权限" class="headerlink" title="给Content Provider设置权限"></a>给Content Provider设置权限</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">     <span class="attr">android:name</span>=<span class="string">&quot;com.example.activityplancontentprovider.contentprovider.CustomProvider&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">android:authorities</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">android:readPermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.READPROVIDER&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">android:writePermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.WRITEPROVIDER&quot;</span> &gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">path-permission</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:pathPattern</span>=<span class="string">&quot;/activity&quot;</span> <span class="attr">android:readPermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.READACTIVITY_PROVIDER&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">path-permission</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:pathPattern</span>=<span class="string">&quot;/attend_person&quot;</span> <span class="attr">android:readPermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.READATTEND_PEOPLE_PROVIDER&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中为整个数据库的写入设置了<br>android:writePermission&#x3D;”com.example.provider.activityplancontentprovider.permission.WRITEPROVIDER”权限，<br>为整个数据库的读设置了<br>android:readPermission&#x3D;”com.example.provider.activityplancontentprovider.permission.READPROVIDER”权限<br>为activity表格设置了<br>android:readPermission&#x3D;”com.example.provider.activityplancontentprovider.permission.READACTIVITY_PROVIDER”权限<br>为attend_person表格设置了<br>android:readPermission&#x3D;”com.example.provider.activityplancontentprovider.permission.READATTEND_PEOPLE_PROVIDER”权限</p>
<h5 id="将权限临时赋予另一个没有权限的Activity"><a href="#将权限临时赋予另一个没有权限的Activity" class="headerlink" title="将权限临时赋予另一个没有权限的Activity"></a>将权限临时赋予另一个没有权限的Activity</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.activityplancontentprovider.contentprovider.CustomProvider&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:authorities</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:readPermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.READPROVIDER&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:writePermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.WRITEPROVIDER&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path-permission</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">android:pathPattern</span>=<span class="string">&quot;/activity&quot;</span> <span class="attr">android:readPermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.READACTIVITY_PROVIDER&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path-permission</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">android:pathPattern</span>=<span class="string">&quot;/attend_person&quot;</span> <span class="attr">android:readPermission</span>=<span class="string">&quot;com.example.provider.activityplancontentprovider.permission.READATTEND_PEOPLE_PROVIDER&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">grant-uri-permission</span> <span class="attr">android:pathPrefix</span>=<span class="string">&quot;/activity&quot;</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>假设ActivityWithNoPermission中没有访问活动表格的权限，但是在ActivityPlans启动ActivityWithNoPermission的时候使用<br>startActivityIntent.setData(Uri.parse(“content:&#x2F;&#x2F;com.example.provider.activityplancontentprovider&#x2F;activity”));<br>startActivityIntent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);<br>自己拥有的访问活动表格的权限通过Intent赋予ActivityWithNoPermission，这样在ActivityWithNoPermission就可以使用临时的访问权限，以及传递过来的Uri访问活动表格。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/06/Android-初步之Android-安全机制/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/06/Android-初步之Android-安全机制/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/05/Android-studio-下使用JNI/" title="Android studio 下使用JNI" itemprop="url">Android studio 下使用JNI</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-05T13:17:46.000Z" itemprop="datePublished"> Published 2016-04-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Android studio 版本： Android Studio 2.0 Beta 6.0<br>Gradle 版本：gradle-2.10<br>NDK    版本：android-ndk-r10e</p>
<ol>
<li>创建一个空项目<br>![](Android studio 下使用JNI&#x2F;project.png)</li>
<li>打开Setting 在 Setting中设置NDK的路径：	<br>![](Android studio 下使用JNI&#x2F;setNDK.png)</li>
<li>添加Native代码，以及LoadLibrary，由于这里还没生成这些所以还是显示错误的，但是不要管它。<br>![](Android studio 下使用JNI&#x2F;native.png)</li>
<li>点击Build-&gt; make project 编译项目：<br>![](Android studio 下使用JNI&#x2F;makepro.png)	<br>这时候会在，[项目名]&#x2F;app&#x2F;build&#x2F;intermediates&#x2F;classes&#x2F;debug&#x2F;com&#x2F;idealist&#x2F;testjniusage 下产生编译出来的class文件<br>进入到[项目名]&#x2F;app&#x2F;src&#x2F;main 目录下，运行如下javah命令：<br>![](Android studio 下使用JNI&#x2F;path.png)	<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">javah -d jni -<span class="keyword">classpath</span> <span class="regexp">/home/</span>jimmy<span class="regexp">/Dev/</span>sdk_m<span class="regexp">/sdk/</span>platforms<span class="regexp">/android-23/</span>android.jar:<span class="regexp">/home/</span>jimmy<span class="regexp">/Dev/</span>sdk_m<span class="regexp">/sdk/</span>extras<span class="regexp">/android/</span>support<span class="regexp">/v7/</span>appcompat<span class="regexp">/libs/</span>android-support-v4.jar:<span class="regexp">/home/</span>jimmy<span class="regexp">/Dev/</span>sdk_m<span class="regexp">/sdk/</span>extras<span class="regexp">/android/</span>support<span class="regexp">/v7/</span>appcompat<span class="regexp">/libs/</span>android-support-v7-appcompat.jar:<span class="regexp">/home/</span>jimmy<span class="regexp">/GitHub_Opensrc/</span>TestJNIUsage<span class="regexp">/app/</span>build<span class="regexp">/intermediates/</span>classes<span class="regexp">/debug/</span> com.idealist.testjniusage.MainActivity</span><br></pre></td></tr></table></figure>
这时候会在项目目录树下产生一个jni的文件夹，如下图所示：<br>![](Android studio 下使用JNI&#x2F;protree.png)</li>
</ol>
<p>	</p>
<p>打开生成的头文件可以看到如下内容：	</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* DO NOT EDIT THIS FILE - it is machine generated */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="comment">/* Header for class com_idealist_testjniusage_MainActivity */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _Included_com_idealist_testjniusage_MainActivity</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _Included_com_idealist_testjniusage_MainActivity</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_ABOVE_CLIENT</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_ABOVE_CLIENT 8L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_ADJUST_WITH_ACTIVITY</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_ADJUST_WITH_ACTIVITY 128L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_ALLOW_OOM_MANAGEMENT</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_ALLOW_OOM_MANAGEMENT 16L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_AUTO_CREATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_AUTO_CREATE 1L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_DEBUG_UNBIND</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_DEBUG_UNBIND 2L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_IMPORTANT</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_IMPORTANT 64L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_NOT_FOREGROUND</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_NOT_FOREGROUND 4L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_BIND_WAIVE_PRIORITY</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_BIND_WAIVE_PRIORITY 32L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_CONTEXT_IGNORE_SECURITY</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_CONTEXT_IGNORE_SECURITY 2L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_CONTEXT_INCLUDE_CODE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_CONTEXT_INCLUDE_CODE 1L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_CONTEXT_RESTRICTED</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_CONTEXT_RESTRICTED 4L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MODE_APPEND</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MODE_APPEND 32768L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MODE_ENABLE_WRITE_AHEAD_LOGGING</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MODE_ENABLE_WRITE_AHEAD_LOGGING 8L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MODE_MULTI_PROCESS</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MODE_MULTI_PROCESS 4L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MODE_PRIVATE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MODE_PRIVATE 0L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MODE_WORLD_READABLE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MODE_WORLD_READABLE 1L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MODE_WORLD_WRITEABLE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MODE_WORLD_WRITEABLE 2L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_DIALER</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_DIALER 1L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_DISABLE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_DISABLE 0L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_SEARCH_GLOBAL</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_SEARCH_GLOBAL 4L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_SEARCH_LOCAL</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_SEARCH_LOCAL 3L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_SHORTCUT</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_DEFAULT_KEYS_SHORTCUT 2L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_RESULT_CANCELED</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_RESULT_CANCELED 0L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_RESULT_FIRST_USER</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_RESULT_FIRST_USER 1L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_RESULT_OK</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_RESULT_OK -1L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_HONEYCOMB</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_HONEYCOMB 11L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MSG_REALLY_STOPPED</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MSG_REALLY_STOPPED 1L</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> com_idealist_testjniusage_MainActivity_MSG_RESUME_PENDING</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> com_idealist_testjniusage_MainActivity_MSG_RESUME_PENDING 2L</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Class:     com_idealist_testjniusage_MainActivity</span></span><br><span class="line"><span class="comment"> * Method:    getNativeString</span></span><br><span class="line"><span class="comment"> * Signature: ()Ljava/lang/String;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">JNIEXPORT jstring JNICALL <span class="title">Java_com_idealist_testjniusage_MainActivity_getNativeString</span></span></span><br><span class="line"><span class="function">  <span class="params">(JNIEnv *, jobject)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>创建对应的源码文件如下：	很简单就是返回一个Hello From JNI!字符串。</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;android/log.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> LOG_TAG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOG_TAG <span class="string">&quot;ANDROID_LAB&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LOGE(...) __android_log_print(ANDROID_LOG_ERROR, LOG_TAG, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _Included_com_idealist_testjniusage_MainActivity</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _Included_com_idealist_testjniusage_MainActivity</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Class: lab_sodino_jnitest_MainActivity</span></span><br><span class="line"><span class="comment"> * Method: getStringFromNative</span></span><br><span class="line"><span class="comment"> * Signature: ()Ljava/lang/String;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">JNIEXPORT jstring JNICALL <span class="title">Java_com_idealist_testjniusage_MainActivity_getNativeString</span></span></span><br><span class="line"><span class="function">        <span class="params">(JNIEnv * env, jobject jObj)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (*env)-&gt;<span class="built_in">NewStringUTF</span>(env,<span class="string">&quot;Hello From JNI!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>点击运行按钮，这时候很有可能会出现如下的错误：<br>![](Android studio 下使用JNI&#x2F;ndkbug.png)	<br>这个问题很简单其实上面已经给出解决方案了，就是在gradle.property这个文件下添加如下配置：<br>![](Android studio 下使用JNI&#x2F;fixed.png)	</p>
<p>6.修改Module 下的 gradle.build	</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">apply plugin: <span class="string">&#x27;com.android.application&#x27;</span></span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion <span class="number">23</span></span><br><span class="line">    buildToolsVersion <span class="string">&quot;23.0.1&quot;</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">&quot;com.idealist.testjni&quot;</span></span><br><span class="line">        minSdkVersion <span class="number">15</span></span><br><span class="line">        targetSdkVersion <span class="number">23</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">&quot;1.0&quot;</span></span><br><span class="line">        <span class="regexp">//</span>这里是新增加的 </span><br><span class="line">        ndk &#123;</span><br><span class="line">            moduleName <span class="string">&quot;Testjni&quot;</span>   <span class="regexp">//</span>这个是LoadLibary 参数相同的名字</span><br><span class="line">            ldLibs <span class="string">&quot;log&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;m&quot;</span></span><br><span class="line">            abiFilters <span class="string">&quot;armeabi&quot;</span>, <span class="string">&quot;armeabi-v7a&quot;</span>, <span class="string">&quot;x86&quot;</span></span><br><span class="line">            <span class="regexp">//</span>ldLibs <span class="string">&quot;log&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;m&quot;</span>  <span class="regexp">//</span>链接时使用到的库，对应LOCAL_LDLIBS</span><br><span class="line">            <span class="regexp">//</span>cFlags 编译gcc的flag，对应LOCAL_CFLAGS</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled false</span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span></span><br><span class="line">            <span class="regexp">//</span>这里是新增加的，用于支持JNIdebug的</span><br><span class="line">            ndk &#123;</span><br><span class="line">                debuggable = true</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        debug &#123;</span><br><span class="line">            <span class="regexp">//</span>这里是新增加的，用于支持JNIdebug的</span><br><span class="line">            debuggable = true</span><br><span class="line">            jniDebuggable = true</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    compile fileTree(dir: <span class="string">&#x27;libs&#x27;</span>, include: [<span class="string">&#x27;*.jar&#x27;</span>])</span><br><span class="line">    testCompile <span class="string">&#x27;junit:junit:4.12&#x27;</span></span><br><span class="line">    compile <span class="string">&#x27;com.android.support:appcompat-v7:23.1.0&#x27;</span></span><br><span class="line">    compile <span class="string">&#x27;com.android.support:design:23.1.0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="7">
<li><p>点击运行。<br>在手机上就可以看到如下的界面了：</p>
<p> ![](Android studio 下使用JNI&#x2F;result.png)</p>
</li>
</ol>
<p>	</p>
<p>可能长期被eclipse虐惯的人会问了，不用写mk吗？是不用写了，其实在bradle.build上面已经做了类似的工作，这个mk文件会根据你的配置在output 目录下生成，包括各个平台的库文件都会在这个目录下生成，如下图所示：<br>![](Android studio 下使用JNI&#x2F;output.png)	</p>
<p>下面是生成的mk文件内容：<br>![](Android studio 下使用JNI&#x2F;mk.png)	</p>
<p>Demo可以在如下地址进行下载：<br><a target="_blank" rel="noopener" href="https://github.com/tbfungeek/TestJni">Demo Github</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/05/Android-studio-下使用JNI/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/05/Android-studio-下使用JNI/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/04/Android-初步之AIDL/" title="Android 初步之 使用Android studio 开发 AIDL" itemprop="url">Android 初步之 使用Android studio 开发 AIDL</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-04T13:17:46.000Z" itemprop="datePublished"> Published 2016-04-04</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>在Android中每个应用程序都运行在自己的进程空间，不同的进程不能直接访问对方的进程空间，如果要在进程间通信，必须将传递对象解析成操作系统可以理解的基本类型，通过操作系统作为桥梁来传递到对方的进程。<br>AIDL(Android  Interface Definition Language) Android 接口定义语言用于生成两个进程之间进行进程间通信的代码。</p>
<h4 id="AIDL服务端实现"><a href="#AIDL服务端实现" class="headerlink" title="AIDL服务端实现"></a>AIDL服务端实现</h4><h5 id="定义AIDL接口"><a href="#定义AIDL接口" class="headerlink" title="定义AIDL接口"></a>定义AIDL接口</h5><ul>
<li>AIDL接口文件的后缀名为.aidl.保存在src目录下</li>
<li>AIDL接口文件与一般的接口大体相似，都是以interface作为关键字，每个aidl文件只能定义一个接口，与一般接口不同的是AIDL文件只能定义接口声明和方法声明，不能定义静态常量。</li>
<li>AIDL文件中方法声明的参数和返回值可以是基本数据类型,String,CharSequence,List，Map，实现了Parcelable接口的类，甚至是其他AIDL生成的接口。其中后两者即使位于同一个包也需要使用import包含进来。实现了Parcelable接口的类除了要建立一个实现android.os.Parcelable接口的类外，还需要为这个类单独建立一个aidl文件，并使用parcelable关键字进行声明。</li>
<li>除了基本类型，String，CharSequence这些类型，其他的都需要指明方向，in表示由客户端设置，out表示由服务端设置，inout表示两者均可设置。</li>
<li>如果其他应用程序需要进行IPC，则这些应用程序的src也需要有这个aidl文件</li>
</ul>
<ol>
<li>首先，先创建一个继承Service的服务类 MyAIDLService</li>
</ol>
<p><img src="/2016/04/04/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAIDL/1.png"></p>
<ol start="2">
<li>紧接着选中刚刚创建的MyAIDLService.java文件在右键弹出的菜单中选择File-&gt;New-&gt;AIDL-&gt;AIDL File<br>这时候就会在main目录下自动创建一个aidl目录，并且在MyAIDLService.java 平行的对应包下创建一个aidl文件。</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.idealist.testaidl.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.idealist.testaidl.bean.Person;</span><br><span class="line"><span class="keyword">import</span> com.idealist.testaidl.callback.IResultCallback;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IMyAidlInterface</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">savePersonInfo</span><span class="params">(in Person person,IResultCallback callback)</span>;<span class="comment">//保存用户信息</span></span><br><span class="line">    List&lt;Person&gt; <span class="title function_">getPersonInfos</span><span class="params">()</span>;<span class="comment">//获取所有用户信息的列表</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里用到了Person这个Bean以及IResultCallback这个回调接口，前者是实现了Parcelable接口的类，后者是其他AIDL生成的接口。具体如下：<br>com&#x2F;idealist&#x2F;testaidl&#x2F;callback&#x2F;IResultCallback.aidl</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.idealist.testaidl.callback;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IResultCallback</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reportResult</span><span class="params">(String result)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>com&#x2F;idealist&#x2F;testaidl&#x2F;bean&#x2F;Person.aidl</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">package com.idealist.testaidl.bean<span class="comment">;</span></span><br><span class="line">parcelable Person<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>下面是Person的实现类：<br>com.idealist.testaidl.bean.Person</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">package com.<span class="property">idealist</span>.<span class="property">testaidl</span>.<span class="property">bean</span>;</span><br><span class="line"><span class="keyword">import</span> android.<span class="property">os</span>.<span class="property">Parcel</span>;</span><br><span class="line"><span class="keyword">import</span> android.<span class="property">os</span>.<span class="property">Parcelable</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Parcelable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title class_">Person</span>() &#123;&#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="title class_">Person</span>(<span class="title class_">Parcel</span> <span class="keyword">in</span>) &#123;</span><br><span class="line">        name = <span class="keyword">in</span>.<span class="title function_">readString</span>();</span><br><span class="line">        tel = <span class="keyword">in</span>.<span class="title function_">readString</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> final <span class="title class_">Creator</span>&lt;<span class="title class_">Person</span>&gt; <span class="variable constant_">CREATOR</span> = <span class="keyword">new</span> <span class="title class_">Creator</span>&lt;<span class="title class_">Person</span>&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title class_">Person</span> <span class="title function_">createFromParcel</span>(<span class="params">Parcel <span class="keyword">in</span></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="keyword">in</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title class_">Person</span>[] <span class="title function_">newArray</span>(<span class="params">int size</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Person</span>[size];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setName</span>(<span class="params"><span class="built_in">String</span> name</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getTel</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> tel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">setTel</span>(<span class="params"><span class="built_in">String</span> tel</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">tel</span> = tel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title class_">String</span> name = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="title class_">String</span> tel = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> int <span class="title function_">describeContents</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">void</span> <span class="title function_">writeToParcel</span>(<span class="params">Parcel parcel, int i</span>) &#123;</span><br><span class="line">        parcel.<span class="title function_">writeString</span>(name);</span><br><span class="line">        parcel.<span class="title function_">writeString</span>(tel);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>点击build后就可以编译，编译结束后就可以产生如下的Stub文件了：<br><img src="/2016/04/04/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAIDL/12.png"></p>
<ol start="3">
<li>实现MyAIDLService类：<br>这里实现的功能很简单就是在客户端绑定并调用Serive的savePersonInfo方法的时候，将会存储起来，如果客户端调用getPersonInfos将会返回存储信息的列表。</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.idealist.testaidl.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Service;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.IBinder;</span><br><span class="line"><span class="keyword">import</span> android.os.RemoteException;</span><br><span class="line"><span class="keyword">import</span> android.support.annotation.Nullable;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.idealist.testaidl.bean.Person;</span><br><span class="line"><span class="keyword">import</span> com.idealist.testaidl.callback.IResultCallback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAIDLService</span> <span class="keyword">extends</span> <span class="title class_">Service</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Person&gt; mPersonInfoList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Person&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IMyAidlInterface.<span class="type">Stub</span> <span class="variable">mIBinder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IMyAidlInterface</span>.Stub() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">savePersonInfo</span><span class="params">(Person person, IResultCallback callback)</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">            <span class="keyword">if</span>(mPersonInfoList != <span class="literal">null</span> &amp;&amp; person != <span class="literal">null</span>) &#123;</span><br><span class="line">                mPersonInfoList.add(person);</span><br><span class="line">                Log.i(<span class="string">&quot;xiaohai.lin&quot;</span>, <span class="string">&quot;Name = &quot;</span> + person.getName() + <span class="string">&quot; -- &quot;</span> + </span><br><span class="line">                        <span class="string">&quot;Tel &quot;</span> + person.getTel() + <span class="string">&quot; Has add to list&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(callback != <span class="literal">null</span>) &#123;</span><br><span class="line">                callback.reportResult(<span class="string">&quot;Person info had add Sucessfully !&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">getPersonInfos</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">            <span class="keyword">return</span> mPersonInfoList;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IBinder <span class="title function_">onBind</span><span class="params">(Intent intent)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mIBinder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onUnbind</span><span class="params">(Intent intent)</span> &#123;</span><br><span class="line">        Log.i(<span class="string">&quot;xiaohai.lin&quot;</span>, <span class="string">&quot;客户端解除绑定&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onUnbind(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>最后一定要注意在AndroidManifest.xml文件中作如下声明：</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">service</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;.service.MyAIDLService&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:enabled</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MyAIDLService&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.DEFAULT&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>整个服务端源码结构如下：</p>
<p><img src="/2016/04/04/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAIDL/13.png"></p>
<h4 id="AIDL客户端实现"><a href="#AIDL客户端实现" class="headerlink" title="AIDL客户端实现"></a>AIDL客户端实现</h4><p>创建一个新的Android项目工程，将服务器端的AIDL相关的文件连同包复制到客户端项目，项目结构如下图所示:<br><img src="/2016/04/04/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAIDL/14.png"></p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">package com.ideallist.testaidlclient;</span><br><span class="line"></span><br><span class="line">import android.content.ComponentName;</span><br><span class="line">import android.content.Intent;</span><br><span class="line">import android.content.ServiceConnection;</span><br><span class="line">import android.os.IBinder;</span><br><span class="line">import android.os.RemoteException;</span><br><span class="line">import android.support.v7.app.AppCompatActivity;</span><br><span class="line">import android.os.Bundle;</span><br><span class="line">import android.util.Log;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.widget.Button;</span><br><span class="line">import android.widget.Toast;</span><br><span class="line"></span><br><span class="line">import com.idealist.testaidl.bean.Person;</span><br><span class="line">import com.idealist.testaidl.callback.IResultCallback;</span><br><span class="line">import com.idealist.testaidl.service.IMyAidlInterface;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> MainActivity extends AppCompatActivity implements View.OnClickListener &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IMyAidlInterface mInterface = null;</span><br><span class="line">    <span class="keyword">private</span> Button mBindServiceBtn = null;</span><br><span class="line">    <span class="keyword">private</span> Button mUnbindServceBtn = null;</span><br><span class="line">    <span class="keyword">private</span> Button mSetPersonInfoBtn = null;</span><br><span class="line">    <span class="keyword">private</span> Button mGetPersonInfoBtn = null;</span><br><span class="line">    <span class="keyword">private</span> boolean isBind = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> ServiceConnection conn = <span class="keyword">new</span> <span class="constructor">ServiceConnection()</span> &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void on<span class="constructor">ServiceConnected(ComponentName <span class="params">componentName</span>, IBinder <span class="params">iBinder</span>)</span> &#123;</span><br><span class="line">            mInterface = <span class="module-access"><span class="module"><span class="identifier">IMyAidlInterface</span>.</span><span class="module"><span class="identifier">Stub</span>.</span></span><span class="keyword">as</span><span class="constructor">Interface(<span class="params">iBinder</span>)</span>;</span><br><span class="line">            isBind = <span class="literal">true</span>;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(MainActivity.<span class="params">this</span>, <span class="string">&quot;Binded to Server !&quot;</span>,Toast.LENGTH_LONG)</span>.show<span class="literal">()</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void on<span class="constructor">ServiceDisconnected(ComponentName <span class="params">componentName</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(mInterface != null) &#123;</span><br><span class="line">                mInterface = null;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(MainActivity.<span class="params">this</span>, <span class="string">&quot;Ubind to Server !&quot;</span>,Toast.LENGTH_LONG)</span>.show<span class="literal">()</span>;</span><br><span class="line">            isBind = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void on<span class="constructor">Create(Bundle <span class="params">savedInstanceState</span>)</span> &#123;</span><br><span class="line">        super.on<span class="constructor">Create(<span class="params">savedInstanceState</span>)</span>;</span><br><span class="line">        set<span class="constructor">ContentView(R.<span class="params">layout</span>.<span class="params">activity_main</span>)</span>;</span><br><span class="line">        mBindServiceBtn = (Button) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">bindservice</span>)</span>;</span><br><span class="line">        mUnbindServceBtn = (Button) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">unbindservice</span>)</span>;</span><br><span class="line">        mSetPersonInfoBtn = (Button) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">setpersonInfo</span>)</span>;</span><br><span class="line">        mGetPersonInfoBtn = (Button) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">getpersonInfo</span>)</span>;</span><br><span class="line"></span><br><span class="line">        mBindServiceBtn.set<span class="constructor">OnClickListener(<span class="params">this</span>)</span>;</span><br><span class="line">        mUnbindServceBtn.set<span class="constructor">OnClickListener(<span class="params">this</span>)</span>;</span><br><span class="line">        mSetPersonInfoBtn.set<span class="constructor">OnClickListener(<span class="params">this</span>)</span>;</span><br><span class="line">        mGetPersonInfoBtn.set<span class="constructor">OnClickListener(<span class="params">this</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IResultCallback.Stub mResultCallBack = <span class="keyword">new</span> IResultCallback.<span class="constructor">Stub()</span> &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void report<span class="constructor">Result(String <span class="params">result</span>)</span> throws RemoteException &#123;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(MainActivity.<span class="params">this</span>, <span class="string">&quot;Result = &quot;</span> + <span class="params">result</span>,Toast.LENGTH_LONG)</span>.show<span class="literal">()</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void on<span class="constructor">Click(View <span class="params">view</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">int</span> id = view.get<span class="constructor">Id()</span>;</span><br><span class="line">        switch (id) &#123;</span><br><span class="line">            case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.bindservice:</span><br><span class="line">                <span class="keyword">if</span>(!isBind) &#123;</span><br><span class="line">                    Intent intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="string">&quot;android.intent.action.MyAIDLService&quot;</span>)</span>;</span><br><span class="line">                    intent.set<span class="constructor">Package(<span class="string">&quot;com.idealist.testaidl&quot;</span>)</span>;</span><br><span class="line">                    bind<span class="constructor">Service(<span class="params">intent</span>, <span class="params">conn</span>, BIND_AUTO_CREATE)</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.unbindservice:</span><br><span class="line">                <span class="keyword">if</span>(isBind) &#123;</span><br><span class="line">                    unbind<span class="constructor">Service(<span class="params">conn</span>)</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.setpersonInfo:</span><br><span class="line">                <span class="keyword">if</span>(mInterface != null ) &#123;</span><br><span class="line">                    Person person = <span class="keyword">new</span> <span class="constructor">Person()</span>;</span><br><span class="line">                    person.set<span class="constructor">Name(<span class="string">&quot;Jimmy&quot;</span>)</span>;</span><br><span class="line">                    person.set<span class="constructor">Tel(<span class="string">&quot;1111111111&quot;</span>)</span>;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        mInterface.save<span class="constructor">PersonInfo(<span class="params">person</span>,<span class="params">mResultCallBack</span>)</span>;</span><br><span class="line">                    &#125; catch (RemoteException e) &#123;</span><br><span class="line">                        e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.getpersonInfo:</span><br><span class="line">                <span class="keyword">if</span>(mInterface != null ) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        List&lt;Person&gt; mList = mInterface.get<span class="constructor">PersonInfos()</span>;</span><br><span class="line">                        <span class="keyword">for</span> (Person p : mList) &#123;</span><br><span class="line">                            <span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(MainActivity.<span class="params">this</span>,<span class="string">&quot;Name = &quot;</span> + <span class="params">p</span>.<span class="params">getName</span>()</span>+<span class="string">&quot; : &quot;</span>+ <span class="string">&quot; Tel &quot;</span>+ p.get<span class="constructor">Tel()</span>,Toast.LENGTH_LONG).show<span class="literal">()</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; catch (RemoteException e) &#123;</span><br><span class="line">                        e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>写客户端最需要注意的就是每个类和Service中的对应关系。一旦对应错误就有可能访问不到对应的方法。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/04/Android-初步之AIDL/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/04/Android-初步之AIDL/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/03/Android-初步之网络与定位服务/" title="Android 初步之网络与定位服务" itemprop="url">Android 初步之网络与定位服务</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-03T13:15:39.000Z" itemprop="datePublished"> Published 2016-04-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="Android的定位技术"><a href="#Android的定位技术" class="headerlink" title="Android的定位技术"></a>Android的定位技术</h4><p>在开发Android位置相关的应用的时候，可以从GPS或者网络获取用户位置，通过GPS能够获得最精确的信息，但是仅适于户外，不但耗电，而且不能及时返回用户需要的信息，使用网络能从发射塔和Wifi信号获得用户位置，提供一种适用于户内和户外的获取位置信息的方式。不但相应速度迅速，而且更加省电。</p>
<p>在Android系统中，开发人员需要使用如下的类来访问定位服务。</p>
<ul>
<li><p>LocationManager：该类提供系统定位服务访问功能</p>
</li>
<li><p>LocationListener ：当位置发生变化的时候，该接口从LocationManager中获得通知</p>
</li>
<li><p>Location:该类表示特定时间地理位置变化信息，位置由经度，纬度，UTC时间戳以及可选的高度，速度，方向等组成</p>
</li>
<li><p>获取可用定位服务</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">protected void on<span class="constructor">Create(Bundle <span class="params">savedInstanceState</span>)</span> &#123;</span><br><span class="line">    super.on<span class="constructor">Create(<span class="params">savedInstanceState</span>)</span>;</span><br><span class="line">    set<span class="constructor">ContentView(R.<span class="params">layout</span>.<span class="params">activity_main</span>)</span>;</span><br><span class="line">    tv= (TextView) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">tv</span>)</span>;</span><br><span class="line">    LocationManager manager = (LocationManager) get<span class="constructor">SystemService(LOCATION_SERVICE)</span>;</span><br><span class="line">    List&lt;String&gt; <span class="built_in">list</span> = manager.get<span class="constructor">AllProviders()</span>;</span><br><span class="line">    StringBuilder sb = <span class="keyword">new</span> <span class="constructor">StringBuilder()</span>;</span><br><span class="line">    <span class="keyword">for</span>(String locationResouse:<span class="built_in">list</span>)&#123;</span><br><span class="line">        sb.append(locationResouse+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    tv.set<span class="constructor">Text(<span class="params">sb</span>.<span class="params">toString</span>()</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>查看位置源属性<br>对于位置源而言，精度和耗电量是用户十分关心的属性。</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">LocationManager manager = (LocationManager) getSystemService(LOCATION_SERVICE);</span><br><span class="line">LocationProvider provider = manager.getProvider(LocationManager.GPS_PROVIDER);</span><br><span class="line"><span class="keyword">int</span> accuracy = provider.getAccuracy();</span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">sb.<span class="keyword">append</span>(<span class="string">&quot;GPS Info:\n&quot;</span>);</span><br><span class="line"><span class="keyword">switch</span> (accuracy) &#123;</span><br><span class="line">	<span class="keyword">case</span> Criteria.ACCURACY_HIGH: </span><br><span class="line">		sb.<span class="keyword">append</span>(<span class="string">&quot;accuracy:High\n&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> Criteria.ACCURACY_LOW: 	</span><br><span class="line">		sb.<span class="keyword">append</span>(<span class="string">&quot;accuracy:Low\n&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> Criteria.ACCURACY_MEDIUM:</span><br><span class="line">		sb.<span class="keyword">append</span>(<span class="string">&quot;accuracy:Medium\n&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">power</span> = provider.getPowerRequirement();</span><br><span class="line"><span class="keyword">switch</span> (<span class="keyword">power</span>) &#123;</span><br><span class="line">	<span class="keyword">case</span> Criteria.POWER_LOW: </span><br><span class="line">		sb.<span class="keyword">append</span>(<span class="string">&quot;power:Low\n&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> Criteria.POWER_HIGH:</span><br><span class="line">		sb.<span class="keyword">append</span>(<span class="string">&quot;power:High\n&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> Criteria.POWER_MEDIUM: </span><br><span class="line">		sb.<span class="keyword">append</span>(<span class="string">&quot;power:Medium\n&quot;</span>);<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>监听位置变化事件<br>对于位置变化的用户，可以在变化后接收到相关的通知，在LocationManager中定义了多个requestLocationUpdates()方法，它用来为当前Activity注册位置变化通知事件。</p>
</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">request<span class="constructor">LocationUpdates(<span class="params">provider</span>, <span class="params">minTime</span>, <span class="params">minDistance</span>, <span class="params">listener</span>)</span></span><br></pre></td></tr></table></figure>

<p>参数说明如下:</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">provider:</span>注册的provider的名称</span><br><span class="line"><span class="symbol">minTime:</span>通知间隔的最小事件，单位是毫秒，系统为了省电可以延长该时间</span><br><span class="line">minDistance：更新通知的最小变化距离，单位是米。</span><br><span class="line"><span class="symbol">listener:</span>用于处理通知的监听器，可以是下表的其中一种:</span><br></pre></td></tr></table></figure>
<p><img src="/2016/04/03/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%9A%E4%BD%8D%E6%9C%8D%E5%8A%A1/1.png"></p>
<h4 id="Android-网络访问技术"><a href="#Android-网络访问技术" class="headerlink" title="Android 网络访问技术"></a>Android 网络访问技术</h4><h5 id="使用HttpURLConnection访问网络"><a href="#使用HttpURLConnection访问网络" class="headerlink" title="使用HttpURLConnection访问网络"></a>使用HttpURLConnection访问网络</h5><p>HttpURLConnection 位于java.net包中,用于发送Http请求和获取Http响应，由于该类是抽象类，不能直接实例化对象，需要使用URL的openConnection()方法来获取.</p>
<ol>
<li>创建HttpURLConnection对象：</li>
</ol>
<ul>
<li>Get方式：</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="comment">//创建一个URL对象</span></span><br><span class="line">uri = <span class="keyword">new</span> <span class="constructor">URL(<span class="string">&quot;http://php.weather.sina.com.cn/xml.php&amp;city=&quot;</span>+ URLEncoder.<span class="params">encode</span>(“惠州”, <span class="string">&quot;gb2312&quot;</span>)</span>+ <span class="string">&quot;&amp;password=DJOYnieT8234jlsK&amp;day=0&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获得HttpURLConnection 实例</span></span><br><span class="line">HttpURLConnection  urlConnection = (HttpURLConnection)url.<span class="keyword">open</span><span class="constructor">Connection()</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>Post方式:</li>
</ul>
<figure class="highlight d"><table><tr><td class="code"><pre><span class="line">uri = <span class="keyword">new</span> URL(“http:<span class="comment">//php.weather.sina.com.cn/xml.php”);</span></span><br><span class="line">HttpURLConnection  urlConnection = (HttpURLConnection)url.openConnection();</span><br><span class="line"><span class="comment">// 设置连接属性</span></span><br><span class="line">urlConn.setDoInput(<span class="literal">true</span>);</span><br><span class="line">urlConn.setDoOutput(<span class="literal">true</span>);</span><br><span class="line">urlConn.setRequestMethod(<span class="string">&quot;POST&quot;</span>);  <span class="comment">// 设置POST方式</span></span><br><span class="line">urlConn.setUseCaches(<span class="literal">false</span>); <span class="comment">// 不设置缓存</span></span><br><span class="line">urlConn.setInstanceFollowRedirects(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">// 配置本次连接的Content-type</span></span><br><span class="line">urlConn.setRequestProperty(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">urlConn.connect(); <span class="comment">// 连接</span></span><br><span class="line"><span class="keyword">out</span> = <span class="keyword">new</span> DataOutputStream(urlConn.getOutputStream());</span><br><span class="line">String content =“city=<span class="string">&quot;+ URLEncoder.encode(“惠州”, &quot;</span>gb2312<span class="string">&quot;)+ &quot;</span>&amp;password=DJOYnieT8234jlsK&amp;day=<span class="number">0</span><span class="string">&quot;);</span></span><br><span class="line"><span class="string">out.writeBytes(content); // 写入输出流</span></span><br><span class="line"><span class="string">out.flash();</span></span><br><span class="line"><span class="string">out.close();</span></span><br></pre></td></tr></table></figure>

<ul>
<li>判断是否成功建立连接：</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">int responseCode <span class="operator">=</span> conn.getResponseCode()<span class="comment">;</span></span><br><span class="line">if (responseCode <span class="operator">=</span><span class="operator">=</span> HttpURLConnection.HTTP_OK) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>获得InputStream读取流数据：</li>
</ul>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line">InputStreamReader  in = <span class="keyword">new</span> InputStreamReader(urlConn.getInputStream());</span><br><span class="line">BufferedReader <span class="built_in">buffer</span> = <span class="keyword">new</span> BufferedReader(in);</span><br><span class="line">Stream inputLine = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">While</span>((inputLine=<span class="built_in">buffer</span>.readLine())!=<span class="literal">null</span>)&#123;</span><br><span class="line">	result += inputLine+”\n”;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>关闭流，关闭连接：</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">In.close()<span class="comment">;</span></span><br><span class="line">urlConn.disconnect()<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>设置网络访问权限：</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;uses-permission android:<span class="attribute">name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>访问网络需要在工作线程中完成否则会产生ANR</p>
<h4 id="使用HttpClient访问网络"><a href="#使用HttpClient访问网络" class="headerlink" title="使用HttpClient访问网络"></a>使用HttpClient访问网络</h4><p>一般情况下如果只需完成简单的页面提交请求并获取服务器的响应，可以使用HttpURLConnection来实现，而对于比较复杂的联网操作则需要使用Apache组织提供的一个HttpClient来访问网络。<br>HttpClient实际上是对Java提供的访问网络的方法的封装，在HttpURLConnection类中的输入输出流操作，在HttpClient类中都被统一封装成HttpGet,HttpPost，HttpResponse这几类，从而减少了操作的繁琐性。</p>
<p>Get方式：</p>
<ul>
<li>创建HttpGet对象</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">HttpGet httpget = <span class="keyword">new</span> <span class="constructor">HttpGet(<span class="string">&quot;http://php.weather.sina.com.cn/xml.php&amp;city=&quot;</span> + URLEncoder.<span class="params">encode</span>(“惠州”, <span class="string">&quot;gb2312&quot;</span>)</span>+ <span class="string">&quot;&amp;password=DJOYnieT8234jlsK&amp;day=0&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>创建HttpClient对象</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">HttpClient httpclient <span class="operator">=</span>  new DefaultHttpClient()<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>调用HttpClient对象的excute()方法发送请求，返回一个HttpResponse对象。</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">HttpResponse  httpresponse<span class="operator">=</span> httpclient.execute(httpget)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>判断连接状态</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="constructor">If(<span class="params">httpresponse</span>.<span class="params">getStatusLine</span>()</span>.get<span class="constructor">StatusCode()</span>==HttpStatus.SC_OK)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>调用HttpResponse的getEntity()方法，可以获得包含服务器响应内容的HttpEntity对象，通过该对象可以获取服务器的响应内容。</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">EntityUtils</span>.</span></span><span class="keyword">to</span><span class="constructor">String(<span class="params">httpresponse</span>.<span class="params">getEntity</span>()</span>);</span><br><span class="line">EntityUtils. toByteArray (httpresponse.get<span class="constructor">Entity()</span>);</span><br><span class="line">httpresponse.get<span class="constructor">Entity()</span>.get<span class="constructor">Content()</span></span><br></pre></td></tr></table></figure>

<p>Post方式：</p>
<ul>
<li>创建HttpPost对象</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">HttpPost  httppost = <span class="keyword">new</span> <span class="constructor">HttpPost(“<span class="params">http</span>:<span class="operator">/</span><span class="operator">/</span><span class="params">php</span>.<span class="params">weather</span>.<span class="params">sina</span>.<span class="params">com</span>.<span class="params">cn</span><span class="operator">/</span><span class="params">xml</span>.<span class="params">php</span>”)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>如果需要发送请求参数，可调用HttpGet、HttpPost共同的setParams(HttpParams params)方法来添加请求参数；也可调用HttpPost对象的setEntity(HttpEntity entity)方法来设置请求参数。</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">List&lt;NameValuePair&gt; param = <span class="keyword">new</span> ArrayList&lt;NameValuePair&gt;<span class="literal">()</span>;</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Param</span>.</span></span>add(<span class="keyword">new</span> <span class="constructor">BasicNameValuePair(“<span class="params">city</span>”,”<span class="params">huizhou</span>”)</span>);</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Param</span>.</span></span>add(<span class="keyword">new</span> <span class="constructor">BasicNameValuePair(“<span class="params">password</span>”, “DJOYnieT8234jlsK”)</span>);</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Param</span>.</span></span>add(<span class="keyword">new</span> <span class="constructor">BasicNameValuePair(“<span class="params">day</span>”, “0”)</span>);</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Httppost</span>.</span></span>set<span class="constructor">Entity(<span class="params">new</span> UrlEncodedFormEntity(<span class="params">param</span>,”<span class="params">utf</span>-8”)</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>创建HttpClient对象</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">HttpClient httpclient <span class="operator">=</span>  new DefaultHttpClient()<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>调用HttpClient的execute方法发送请求返回一个HttpResponse对象</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">HttpResponse  httpresponse<span class="operator">=</span> httpclient.execute(httppost)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>判断连接状态</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="constructor">If(<span class="params">httpresponse</span>.<span class="params">getStatusLine</span>()</span>.get<span class="constructor">StatusCode()</span>==HttpStatus.SC_OK)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>调用HttpResponse的getEntity方法通过该方法获得HttpEntity对象，通过该对象获取服务器的响应信息。</li>
</ul>
<h4 id="Http请求乱码问题解决方案"><a href="#Http请求乱码问题解决方案" class="headerlink" title="Http请求乱码问题解决方案"></a>Http请求乱码问题解决方案</h4><p>使用EntityUtils的toString方法，传递编码，默认编码是ISO-8859-1<br>因此需要根据网页编码方式进行转码:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">charset = get<span class="constructor">ContentCharSet(<span class="params">entity</span>)</span>;  </span><br><span class="line">result = <span class="module-access"><span class="module"><span class="identifier">EntityUtils</span>.</span></span><span class="keyword">to</span><span class="constructor">String(<span class="params">entity</span>, <span class="params">charset</span>)</span>;  </span><br><span class="line"><span class="comment">//获取页面编码方式</span></span><br><span class="line">public static String get<span class="constructor">ContentCharSet(<span class="params">final</span> HttpEntity <span class="params">entity</span>)</span> &#123;   </span><br><span class="line">    String charset = null;   </span><br><span class="line">    <span class="keyword">if</span> (entity.get<span class="constructor">ContentType()</span> != null) &#123;    </span><br><span class="line">        HeaderElement values<span class="literal">[]</span> = entity.get<span class="constructor">ContentType()</span>.get<span class="constructor">Elements()</span>;   </span><br><span class="line">        <span class="keyword">if</span> (values.length &gt; <span class="number">0</span>) &#123;   </span><br><span class="line">            NameValuePair param = values<span class="literal">[<span class="number">0</span>]</span>.get<span class="constructor">ParameterByName(<span class="string">&quot;charset&quot;</span> )</span>;   </span><br><span class="line">            <span class="keyword">if</span> (param != null) &#123;   </span><br><span class="line">                charset = param.get<span class="constructor">Value()</span>;   </span><br><span class="line">            &#125;   </span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">if</span>(<span class="module-access"><span class="module"><span class="identifier">StringUtils</span>.</span></span>is<span class="constructor">Empty(<span class="params">charset</span>)</span>)&#123;  </span><br><span class="line">        charset = <span class="string">&quot;UTF-8&quot;</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    return charset;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/03/Android-初步之网络与定位服务/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/03/Android-初步之网络与定位服务/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/24/">&lt;span&gt;&lt;&#x2F;span&gt;Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="page-number" href="/page/24/">24</a><span class="page-number current">25</span><a class="page-number" href="/page/26/">26</a><a class="page-number" href="/page/27/">27</a><span class="space">&hellip;</span><a class="page-number" href="/page/30/">30</a><a class="extend next" rel="next" href="/page/26/">Next&lt;span&gt;&lt;&#x2F;span&gt;</a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">
<div id="authorInfo">
	
		<div class="author-img"></div>		
	
	<div class="social-info" class="clearfix">
		
		
		<a href="https://github.com/tbfungeek" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		
		<a href="mailto:tbfungeek@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		

	</div>
</div>

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Android-小经验/" title="Android 小经验">Android 小经验<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android-源码分析/" title="Android 源码分析">Android 源码分析<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android其他/" title="Android其他">Android其他<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android初步/" title="Android初步">Android初步<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android进阶/" title="Android进阶">Android进阶<sup>100</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hexo-使用/" title="Hexo 使用">Hexo 使用<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/JavaScript理论/" title="JavaScript理论">JavaScript理论<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Objective-C-相关/" title="Objective C 相关">Objective C 相关<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/OpenCV/" title="OpenCV">OpenCV<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/ROS/" title="ROS">ROS<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-工具使用/" title="iOS 工具使用">iOS 工具使用<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-开源库分析/" title="iOS 开源库分析">iOS 开源库分析<sup>36</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-理论基础/" title="iOS 理论基础">iOS 理论基础<sup>14</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-进阶/" title="iOS 进阶">iOS 进阶<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/个人收藏/" title="个人收藏">个人收藏<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/代码规范/" title="代码规范">代码规范<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/其他/" title="其他">其他<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/博客分类目录/" title="博客分类目录">博客分类目录<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/叨叨系列/" title="叨叨系列">叨叨系列<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/开源代码分析/" title="开源代码分析">开源代码分析<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/开源库分析/" title="开源库分析">开源库分析<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/树莓派/" title="树莓派">树莓派<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/版本控制/" title="版本控制">版本控制<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/直播/" title="直播">直播<sup>6</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/iOS-开源库分析/" title="iOS 开源库分析">iOS 开源库分析<sup>36</sup></a></li>
			
		
			
				<li><a href="/tags/Android-设计模式/" title="Android 设计模式">Android 设计模式<sup>29</sup></a></li>
			
		
			
				<li><a href="/tags/Objective-C-相关/" title="Objective C 相关">Objective C 相关<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/Android基础/" title="Android基础">Android基础<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/AOSP-源码/" title="AOSP 源码">AOSP 源码<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/Android-常用第三方库/" title="Android 常用第三方库">Android 常用第三方库<sup>15</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-理论基础/" title="iOS 理论基础">iOS 理论基础<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo-使用/" title="Hexo 使用">Hexo 使用<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/ROS/" title="ROS">ROS<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Android-动画进阶/" title="Android 动画进阶">Android 动画进阶<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Android-JNI/" title="Android JNI">Android JNI<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-绘图进阶/" title="Android 绘图进阶">Android 绘图进阶<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android性能优化/" title="Android性能优化">Android性能优化<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-自动化测试/" title="Android 自动化测试">Android 自动化测试<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/OpenCV/" title="OpenCV">OpenCV<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/直播/" title="直播">直播<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-开源源码/" title="Android 开源源码">Android 开源源码<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Android-自定义View进阶/" title="Android 自定义View进阶">Android 自定义View进阶<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/树莓派/" title="树莓派">树莓派<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-进阶/" title="iOS 进阶">iOS 进阶<sup>4</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://hexo.io" target="_blank" title="Hexo">Hexo</a>
            
          </li>
        
          <li>
            
            	<a href="https://pages.github.com/" target="_blank" title="GitHub">GitHub</a>
            
          </li>
        
          <li>
            
            	<a href="http://pf18.github.io/" target="_blank" title="PF18">PF18</a>
            
          </li>
        
          <li>
            
            	<a href="http://toutiao.io/" target="_blank" title="开发者头条">开发者头条</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.jcodecraeer.com/" target="_blank" title="泡在网上的日子">泡在网上的日子</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="atom.xml" target="_blank" title="rss">RSS</a>
</div>

  
  <div class="tagcloudlist">
    <p class="asidetitle">Tag Cloud</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/AOSP-%E6%BA%90%E7%A0%81/" style="font-size: 17.14px;">AOSP 源码</a> <a href="/tags/Android-APK-%E7%AD%BE%E5%90%8D/" style="font-size: 10px;">Android APK 签名</a> <a href="/tags/Android-JNI/" style="font-size: 12.86px;">Android JNI</a> <a href="/tags/Android-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E8%BF%9B%E9%98%B6/" style="font-size: 10.71px;">Android 事件处理进阶</a> <a href="/tags/Android-%E5%8A%A8%E7%94%BB%E8%BF%9B%E9%98%B6/" style="font-size: 13.57px;">Android 动画进阶</a> <a href="/tags/Android-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91/" style="font-size: 10px;">Android 多线程开发</a> <a href="/tags/Android-%E5%B0%8F%E7%BB%8F%E9%AA%8C/" style="font-size: 10px;">Android 小经验</a> <a href="/tags/Android-%E5%B8%B8%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/" style="font-size: 16.43px;">Android 常用第三方库</a> <a href="/tags/Android-%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" style="font-size: 10px;">Android 开发流程</a> <a href="/tags/Android-%E5%BC%80%E6%BA%90%E6%BA%90%E7%A0%81/" style="font-size: 12.14px;">Android 开源源码</a> <a href="/tags/Android-%E7%BB%98%E5%9B%BE%E8%BF%9B%E9%98%B6/" style="font-size: 12.86px;">Android 绘图进阶</a> <a href="/tags/Android-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" style="font-size: 12.86px;">Android 自动化测试</a> <a href="/tags/Android-%E8%87%AA%E5%AE%9A%E4%B9%89View%E8%BF%9B%E9%98%B6/" style="font-size: 12.14px;">Android 自定义View进阶</a> <a href="/tags/Android-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 19.29px;">Android 设计模式</a> <a href="/tags/Android%E5%85%B6%E4%BB%96/" style="font-size: 10px;">Android其他</a> <a href="/tags/Android%E5%9F%BA%E7%A1%80/" style="font-size: 17.86px;">Android基础</a> <a href="/tags/Android%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" style="font-size: 10px;">Android开发流程</a> <a href="/tags/Android%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size: 12.86px;">Android性能优化</a> <a href="/tags/Android%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF/" style="font-size: 10px;">Android混淆技术</a> <a href="/tags/Android%E8%B4%A8%E9%87%8F%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/" style="font-size: 11.43px;">Android质量管理工具</a> <a href="/tags/Android%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" style="font-size: 10px;">Android逆向工程</a> <a href="/tags/Git-github/" style="font-size: 10px;">Git && github</a> <a href="/tags/Hexo-%E4%BD%BF%E7%94%A8/" style="font-size: 15px;">Hexo 使用</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Linux-%E4%BD%BF%E7%94%A8/" style="font-size: 10px;">Linux 使用</a> <a href="/tags/Objective-C-%E7%9B%B8%E5%85%B3/" style="font-size: 18.57px;">Objective C 相关</a> <a href="/tags/OpenCV/" style="font-size: 12.86px;">OpenCV</a> <a href="/tags/ROS/" style="font-size: 14.29px;">ROS</a> <a href="/tags/iOS-%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" style="font-size: 10.71px;">iOS 工具使用</a> <a href="/tags/iOS-%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%86%E6%9E%90/" style="font-size: 20px;">iOS 开源库分析</a> <a href="/tags/iOS-%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/" style="font-size: 15.71px;">iOS 理论基础</a> <a href="/tags/iOS-%E8%BF%9B%E9%98%B6/" style="font-size: 12.14px;">iOS 进阶</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 10px;">代码规范</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%88%86%E7%B1%BB%E7%9B%AE%E5%BD%95/" style="font-size: 10.71px;">博客分类目录</a> <a href="/tags/%E5%8F%A8%E5%8F%A8%E7%B3%BB%E5%88%97/" style="font-size: 10px;">叨叨系列</a> <a href="/tags/%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" style="font-size: 11.43px;">工具的使用</a> <a href="/tags/%E5%BC%80%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 10.71px;">开源代码分析</a> <a href="/tags/%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%86%E6%9E%90/" style="font-size: 10px;">开源库分析</a> <a href="/tags/%E6%9D%82%E7%B1%BB/" style="font-size: 10px;">杂类</a> <a href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" style="font-size: 12.14px;">树莓派</a> <a href="/tags/%E7%9B%B4%E6%92%AD/" style="font-size: 12.86px;">直播</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/" style="font-size: 10.71px;">编程技巧</a> <a href="/tags/%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F/" style="font-size: 10px;">网站收藏</a> <a href="/tags/%E9%87%8D%E8%A6%81%E6%8E%A7%E4%BB%B6/" style="font-size: 11.43px;">重要控件</a>
    </div>
  </div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
		
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/hsihohuang/kiddochan" target="_blank" title="Kiddochan">Kiddochan</a> © 2022 
		
		<a href="/about" target="_blank" title="Edgar">Edgar</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7c9443b0374f1cf6b1dbb5ab84d939cb";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
