
 <!DOCTYPE HTML>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  
    <title>Edgar&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Edgar">
    

    
    <meta name="description" content="Android | 全栈工程师">
<meta property="og:type" content="website">
<meta property="og:title" content="Edgar&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/26/index.html">
<meta property="og:site_name" content="Edgar&#39;s Blog">
<meta property="og:description" content="Android | 全栈工程师">
<meta property="og:locale">
<meta property="article:author" content="Edgar">
<meta name="twitter:card" content="summary">

    
    <link rel="alternative" href="atom.xml" title="Edgar&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/unnamed4_n_mSY_icon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/profile.png">
    <link rel="apple-touch-icon-precomposed" href="/img/profile.png">
    
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.2.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Edgar&#39;s Blog">Edgar&#39;s Blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
 					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" name="q" maxlength="20" placeholder="Search" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/02/Android-初步之Timmer-AlarmManager-JobSchedule/" title="Android 初步之Timmer &amp;&amp; AlarmManager" itemprop="url">Android 初步之Timmer &amp;&amp; AlarmManager</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-02T13:17:14.000Z" itemprop="datePublished"> Published 2016-04-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="Alarm"><a href="#Alarm" class="headerlink" title="Alarm"></a>Alarm</h4><h5 id="Alarm-介绍"><a href="#Alarm-介绍" class="headerlink" title="Alarm 介绍"></a>Alarm 介绍</h5><ol>
<li>Alarm是一种在预先确定时间或时间间隔内激活Intent的方式，和Timmer不同，Alarm是在应用程序之外操作的，所以即使应用程序关闭，也能用来激活应用程序事件或者操作，这个和静态注册广播一样。</li>
<li>Alarm可以结合BroadCast Receiver一起使用，允许设置能够激活广播Intent，启动Service，甚至启动Activity的Alarm，而不需要打开或者运行应用程序。</li>
<li>Android中的Alarm在设备处于休眠状态到时候依旧保持活动状态，可以有选择地设置Alarm来唤醒设备，但是无论何时，重启设备，所有的Alarm都会被取消。</li>
<li>可以使用Alarm实现基于网络查找的定时更新，或者把费时的或者成本受限的操作安排在非高峰期运行，或者对失败的操作调度重试。<br><img src="/2016/04/02/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BTimmer-AlarmManager-JobSchedule/1.png"></li>
</ol>
<h5 id="Alarm-使用"><a href="#Alarm-使用" class="headerlink" title="Alarm 使用"></a>Alarm 使用</h5><ul>
<li>获得Alarm Manager:</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">AlarmManager  manager <span class="operator">=</span> getSystemService(Context.ALARM_SERVICE)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>设置一次性的Alarm:</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">manager.<span class="keyword">set</span>(<span class="keyword">type</span>, triggerAtMillis, operation);</span><br></pre></td></tr></table></figure>
<p>type类型,可以有如下几种方式:</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">RTC_WAKEUP：在指定时间唤醒设备，并激活Pending <span class="keyword">Intent</span>。</span><br><span class="line">RTC	          ：在指定时间点激活Pending <span class="keyword">Intent</span>但是不会唤醒设备。</span><br><span class="line">ELAPSED_REALTIME:根据设备启动之后经过的时间激活Pending <span class="keyword">Intent</span> ，但是不会唤醒设备。</span><br><span class="line">ELAPSED_REALTIME_WAKEUP根据设备启动之后经过的时间激活Pending <span class="keyword">Intent</span> ，并唤醒设备。</span><br></pre></td></tr></table></figure>
<p>triggerAtMillis触发时间:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">如果把触发时间设置为过去的时间，那么将会被立即触发。</span><br></pre></td></tr></table></figure>
<p>要激活的Pending Intent</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">PendingIntent alarmIntnet =<span class="module-access"><span class="module"><span class="identifier">PeddingIntent</span>.</span></span>get<span class="constructor">BroadCast(<span class="params">this</span>,0,<span class="params">intent</span>,0)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>设置重复的Alarm</li>
</ul>
<p>当需要对重复Alarm的精确时间间隔进行细粒度控制的时候，可以使用setRepeating方法，传入这个方法的时间间隔可以用于指定Alarm的确切事件间隔，最多可以精确到毫秒，如下所示:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">manager.set<span class="constructor">Repeating(<span class="params">type</span>, <span class="params">triggerAtMillis</span>, <span class="params">intervalMillis</span>, <span class="params">operation</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>当需要减少因为定时唤醒设备来执行更新所消耗的电量的时候可以使用setInexactRepeating方法，在运行时，Android会同步多个没有精确指定时间间隔的Alarm到重复Alarm，并同时触发。方法如下：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">manager.set<span class="constructor">InexactRepeating(<span class="params">type</span>, <span class="params">triggerAtMillis</span>, <span class="params">intervalMillis</span>, <span class="params">operation</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>在使用setInexactRepeating的时候不必为其设置确切的时间，它接收如下的几种Alarm Manager常量。</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">INTERVAL<span class="emphasis">_FIFTEEN_MINUTES</span></span><br><span class="line"><span class="emphasis">INTERVAL_HALF_HOUR</span></span><br><span class="line"><span class="emphasis">INTERVAL_HOUR</span></span><br><span class="line"><span class="emphasis">INTERVAL_HALF_DAY</span></span><br><span class="line"><span class="emphasis">INTERVAL_</span>DAY</span><br></pre></td></tr></table></figure>

<ul>
<li>取消Alarm</li>
</ul>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">manager.<span class="built_in">cancel</span>(alarmIntnet)</span><br></pre></td></tr></table></figure>

<h4 id="Timer与TimerTask"><a href="#Timer与TimerTask" class="headerlink" title="Timer与TimerTask"></a>Timer与TimerTask</h4><p>与Alarm不同的是Timer是在应用程序之内操作的，对于只在应用程序生命周期内发生的定时操作，将Handler类和Timmer以及Thread结合起来使用是一种比Alarm更好的方法，因为这样可以允许Android更好地控制系统资源。</p>
<ul>
<li>Timer的使用：</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Timer</span> <span class="variable">timer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Timer</span>();</span><br><span class="line"><span class="type">TimerTask</span> <span class="variable">task</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TimerTask</span>() &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="comment">//周期要执行的任务</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">timer.schedule(<span class="keyword">task</span>, <span class="keyword">delay</span>, period);</span><br></pre></td></tr></table></figure>

<ul>
<li>取消Timer :</li>
</ul>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">timer.cancel()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/02/Android-初步之Timmer-AlarmManager-JobSchedule/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/02/Android-初步之Timmer-AlarmManager-JobSchedule/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/04/01/Android-初步之ListView/" title="Android 初步之Adapter 与 ListView" itemprop="url">Android 初步之Adapter 与 ListView</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-04-01T15:06:29.000Z" itemprop="datePublished"> Published 2016-04-01</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="Adapter"><a href="#Adapter" class="headerlink" title="Adapter"></a>Adapter</h4><p>Adapter的翻译成中文是适配器和设计模式中介绍的适配器其实是一个意思，它的作用就是将数据库等形式存在的数据适配到像ListView等组件上。<br>Adapter是连接后端数据和前端显示的适配器接口，是数据和UI（View）之间一个重要的纽带。<br><img src="/2016/04/01/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BListView/1.png"></p>
<h4 id="常见的Adapter类型"><a href="#常见的Adapter类型" class="headerlink" title="常见的Adapter类型"></a>常见的Adapter类型</h4><p>ArrayAdapter ：只能展示一行文字。<br>BaseAdapter:是一个抽象类，继承它需要实现较多的方法，所以也就具有较高的灵活性；<br>SimpleAdapter:有最好的扩充性，可以自定义出各种效果。<br>SimpleCursorAdapter:可以适用于简单的纯文字型ListView，它需要Cursor的字段和UI的id对应起来。如需要实现更复杂的UI也可以重写其他方法。可以认为是SimpleAdapter对数据库的简单结合，可以方便地把数据库的内容以列表的形式展示出来。</p>
<h5 id="ArrayAdapter"><a href="#ArrayAdapter" class="headerlink" title="ArrayAdapter"></a>ArrayAdapter</h5><p>列表的显示需要三个元素：<br>a．ListVeiw 用来展示列表的View。<br>b．适配器 用来把数据映射到ListView上的中介。<br>c．数据    具体的将被映射的字符串，图片，或者基本组件。</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">ArrayAdapterActivity</span> <span class="keyword">extends</span> <span class="title">ListActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    public void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</span><br><span class="line">            <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">            <span class="type">String</span>[] strs = &#123;<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;4&quot;</span>,<span class="string">&quot;5&quot;</span>&#125;;</span><br><span class="line">            <span class="type">ArrayAdapter</span>&lt;<span class="type">String</span>&gt; adapter = <span class="keyword">new</span>    </span><br><span class="line">            <span class="type">ArrayAdapter</span>&lt;<span class="type">String</span>&gt;(<span class="keyword">this</span>,</span><br><span class="line">            android.<span class="type">R</span>.layout.simple_expandable_list_item_1,strs);</span><br><span class="line">            setListAdapter(adapter);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="SimpleAdapter"><a href="#SimpleAdapter" class="headerlink" title="SimpleAdapter"></a>SimpleAdapter</h5><p>simpleAdapter的扩展性最好，可以定义各种各样的布局出来，可以放上ImageView（图片），还可以放上Button（按钮），CheckBox（复选框）等等。</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">SimpleAdapter adapter = <span class="keyword">new</span> <span class="constructor">SimpleAdapter(<span class="params">this</span>, <span class="params">getData</span>()</span>, <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>layout.simple, <span class="keyword">new</span> String<span class="literal">[]</span> &#123; <span class="string">&quot;title&quot;</span>,  <span class="string">&quot;img&quot;</span> &#125;, <span class="keyword">new</span> <span class="built_in">int</span><span class="literal">[]</span> &#123; <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.title, <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.img &#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">SimpleAdapter adapter = <span class="keyword">new</span> SimpleAdapter(</span><br><span class="line">					上下文,</span><br><span class="line">					 <span class="built_in">List</span>&lt;<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Object</span>&gt;&gt;类型数据,</span><br><span class="line">					 每个Item布局文件,</span><br><span class="line">					 <span class="keyword">new</span> <span class="built_in">String</span>[] &#123; “title”&#125;<span class="comment">/*在Map的键值*/</span>, </span><br><span class="line">					<span class="keyword">new</span> <span class="built_in">int</span>[] &#123; R.id.title,&#125;<span class="comment">/*在布局中的ID*/</span></span><br><span class="line">					);</span><br></pre></td></tr></table></figure>
<h5 id="SimpleCursorAdapter"><a href="#SimpleCursorAdapter" class="headerlink" title="SimpleCursorAdapter"></a>SimpleCursorAdapter</h5><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">ListAdapter adapter = <span class="keyword">new</span> <span class="type">SimpleCursorAdapter</span>(</span><br><span class="line">					<span class="built_in">this</span>,<span class="comment">//上下文</span></span><br><span class="line"> 					android.R.layout.simple_list_item_1,</span><br><span class="line">					<span class="comment">//每一项的布局</span></span><br><span class="line"> 					cur, <span class="comment">//Cursor指针</span></span><br><span class="line">					<span class="keyword">new</span> <span class="type">String</span>[] &#123;People.NAME&#125;, <span class="comment">//值</span></span><br><span class="line">					<span class="keyword">new</span> <span class="type">int</span>[] &#123;android.R.id.text1&#125;<span class="comment">//ID</span></span><br><span class="line">					);</span><br></pre></td></tr></table></figure>
<h5 id="BaseAdapter"><a href="#BaseAdapter" class="headerlink" title="BaseAdapter"></a>BaseAdapter</h5><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public View get<span class="constructor">View(<span class="params">int</span> <span class="params">position</span>, View <span class="params">convertView</span>, ViewGroup <span class="params">parent</span>)</span> &#123;</span><br><span class="line">    ViewHolder holder = null;</span><br><span class="line">    <span class="keyword">if</span> (convertView<span class="operator"> == </span>null) &#123;                     </span><br><span class="line">    holder=<span class="keyword">new</span> <span class="constructor">ViewHolder()</span>;                     </span><br><span class="line">    convertView = mInflater.inflate(<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>layout.vlist2, null);</span><br><span class="line">    holder.img = (ImageView)convertView.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">img</span>)</span>;</span><br><span class="line">    holder.title = (TextView)convertView.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">title</span>)</span>;</span><br><span class="line">    holder.info = (TextView)convertView.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">info</span>)</span>;</span><br><span class="line">    holder.viewBtn = 				</span><br><span class="line">        (Button)convertView.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">view_btn</span>)</span>;			                 </span><br><span class="line">        convertView.set<span class="constructor">Tag(<span class="params">holder</span>)</span>;     </span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;                     </span><br><span class="line">        holder = (ViewHolder)convertView.get<span class="constructor">Tag()</span>;</span><br><span class="line">    &#125;                                 			</span><br><span class="line">    holder.img.set<span class="constructor">BackgroundResource((Integer)</span>mData.get(position).get(<span class="string">&quot;img&quot;</span>));</span><br><span class="line">    holder.title.set<span class="constructor">Text((String)</span>mData.get(position).get(<span class="string">&quot;title&quot;</span>));</span><br><span class="line">    holder.info.set<span class="constructor">Text((String)</span>mData.get(position).get(<span class="string">&quot;info&quot;</span>));                 </span><br><span class="line">    return convertView;           </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>系统首先调用getCount()函数，根据他的返回值得到listView的长度.然后根据这个长度，调用getView()逐一绘制每一行。如果你的getCount()返回值是0的话，列表将不显示同样return 1，就只显示一行。</p>
<p>getView()有三个参数，position表示将显示的是第几行，covertView是从布局文件中inflate来的布局。我们用LayoutInflater的方法将定义好的vlist2.xml文件提取成View实例用来显示。然后将xml文件中的各个组件实例化（简单的findViewById()方法）。这样便可以将数据对应到各个组件上了。但是按钮为了响<br>应点击事件，需要为它添加点击监听器，这样就能捕获点击事件。至此一个自定义的listView就完成了，现在让我们回过头从新审视这个过程。系统要绘制ListView了，他首先获得要绘制的这个列表的长度，然后开始绘制第一行，怎么绘制呢？调用getView()函数。在这个函数里面首先获得一个View（实际上是一个<br>ViewGroup），然后再实例并设置各个组件，显示之。好了，绘制完这一行了。那再绘制下一行，直到绘完为止。在实际的运行过程中会发现listView的每一行没有焦点了，这是因为Button抢夺了listView的焦点，只要布局文件中将Button设置为没有焦点就OK了。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;Button android:<span class="attribute">id</span>=<span class="string">&quot;@+id/view_btn&quot;</span> android:<span class="attribute">focusable</span>=<span class="string">&quot;false&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h4><h5 id="ListView常见的XML属性"><a href="#ListView常见的XML属性" class="headerlink" title="ListView常见的XML属性"></a>ListView常见的XML属性</h5><p><img src="/2016/04/01/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BListView/3.png"></p>
<h5 id="ListView常用的内置列表项布局"><a href="#ListView常用的内置列表项布局" class="headerlink" title="ListView常用的内置列表项布局"></a>ListView常用的内置列表项布局</h5><p><img src="/2016/04/01/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BListView/4.png"></p>
<p>如果一个窗口仅需要显示一个列表，则可以直接让Activity继承ListActivity来实现</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> MainActivity extends ListActivity &#123;</span><br><span class="line">	protected void on<span class="constructor">Create(Bundle <span class="params">savedInstanceState</span>)</span> &#123;</span><br><span class="line">	super.on<span class="constructor">Create(<span class="params">savedInstanceState</span>)</span>;</span><br><span class="line">	String ctype<span class="literal">[]</span> = &#123;“项目<span class="number">1</span>”,“项目<span class="number">2</span>”,“项目<span class="number">3</span>”,“项目<span class="number">4</span>”&#125;;</span><br><span class="line">	ArrayAdapter&lt;CharSequence&gt; adapter = <span class="keyword">new</span>   </span><br><span class="line">                ArrayAdapter&lt;CharSequence&gt;(this,   </span><br><span class="line">	android.<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>layout.simple_list_item_1, ctype);</span><br><span class="line"> 	this.set<span class="constructor">ListAdapter(<span class="params">adapter</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line">protected void on<span class="constructor">ListItemClick(ListView <span class="params">l</span>, View <span class="params">v</span>, <span class="params">int</span> <span class="params">position</span>, <span class="params">long</span> <span class="params">id</span>)</span> &#123;</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(MainActivity.<span class="params">this</span>,<span class="params">l</span>.<span class="params">getItemAtPosition</span>(<span class="params">position</span>)</span>.<span class="keyword">to</span><span class="constructor">String()</span>,<span class="number">0</span>).show<span class="literal">()</span>;</span><br><span class="line">	super.on<span class="constructor">ListItemClick(<span class="params">l</span>, <span class="params">v</span>, <span class="params">position</span>, <span class="params">id</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ListView中item与控件抢夺焦点的解决方法"><a href="#ListView中item与控件抢夺焦点的解决方法" class="headerlink" title="ListView中item与控件抢夺焦点的解决方法"></a>ListView中item与控件抢夺焦点的解决方法</h5><ul>
<li>将ListView中的Item布局中的子控件focusable属性设置为false</li>
<li>在getView方法中设置button.setFocusable(false)</li>
<li>设置item的根布局的属性<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">android:</span>descendantFocusability=<span class="string">&quot;blocksDescendant&quot;</span></span><br></pre></td></tr></table></figure>
我们可以发现，其实这三种方法都是为了让Button等控件不能获取焦点，从而使得item可以响应点击事件。</li>
</ul>
<p>第三种方法使用起来相对方便，因为它是将item布局中的其他所有控件都设置为不能获取焦点。</p>
<p>android:descendantFocusability属性共有三个取值，分别为</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">beforeDescendants：viewgroup会优先其子类控件而获取到焦点</span></span><br><span class="line"><span class="keyword"></span>afterDescendants：viewgroup 只有当其子类控件不需要获取焦点时才获取焦点</span><br><span class="line"><span class="keyword">blocksDescendants：viewgroup </span>会覆盖子类控件而直接获得焦点</span><br></pre></td></tr></table></figure>

<h5 id="ListView滚动事件"><a href="#ListView滚动事件" class="headerlink" title="ListView滚动事件"></a>ListView滚动事件</h5><p>ListView的滚动有三种状态<br>第一是静止状态，SCROLL_STATE_IDLE<br>第二是手指滚动状态，SCROLL_STATE_TOUCH_SCROLL<br>第三是手指不动了，但是屏幕还在滚动状态。SCROLL_STATE_FLING</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">getListView().setOnScrollListener(<span class="keyword">new</span> OnScrollListener() &#123;  </span><br><span class="line">			listViewScrollState;           </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrollStateChanged</span>(<span class="params">AbsListView view, <span class="built_in">int</span> scrollState</span>)</span> &#123;  </span><br><span class="line">	   listViewScrollState = scrollState;  </span><br><span class="line">        <span class="keyword">switch</span>(scrollState)&#123;  </span><br><span class="line">        <span class="keyword">case</span> OnScrollListener.SCROLL_STATE_IDLE:<span class="comment">//空闲状态               </span></span><br><span class="line">		<span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> OnScrollListener.SCROLL_STATE_FLING:<span class="comment">//滚动状态      </span></span><br><span class="line">        <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> OnScrollListener.SCROLL_STATE_TOUCH_SCROLL:<span class="comment">//触摸后滚动  </span></span><br><span class="line">        <span class="keyword">break</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line"> </span><br></pre></td></tr></table></figure>


<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">* 正在滚动 </span></span><br><span class="line"><span class="comment">* firstVisibleItem第一个Item的位置 </span></span><br><span class="line"><span class="comment">* visibleItemCount 可见的Item的数量 </span></span><br><span class="line"><span class="comment">* totalItemCount item的总数 </span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line">firstVisibleItem the index <span class="keyword">of</span> the first visible cell (ignore <span class="keyword">if</span> visibleItemCount<span class="operator"> == </span><span class="number">0</span>) </span><br><span class="line">visibleItemCount the number <span class="keyword">of</span> visible cells </span><br><span class="line">totalItemCount the number <span class="keyword">of</span> items <span class="keyword">in</span> the <span class="built_in">list</span> adaptor </span><br><span class="line"></span><br><span class="line">public void on<span class="constructor">Scroll(AbsListView <span class="params">view</span>, <span class="params">int</span> <span class="params">firstVisibleItem</span>,<span class="params">int</span> <span class="params">visibleItemCount</span>, <span class="params">int</span> <span class="params">totalItemCount</span>)</span> &#123;  </span><br><span class="line"><span class="comment">//控制显示和隐藏的代码...  </span></span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<h5 id="判断滚动到底部和顶部的方法"><a href="#判断滚动到底部和顶部的方法" class="headerlink" title="判断滚动到底部和顶部的方法"></a>判断滚动到底部和顶部的方法</h5><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">lv.set<span class="constructor">OnScrollListener(<span class="params">new</span> OnScrollListener()</span> &#123; </span><br><span class="line">    </span><br><span class="line">    public void on<span class="constructor">ScrollStateChanged(AbsListView <span class="params">view</span>, <span class="params">int</span> <span class="params">scrollState</span>)</span> &#123;</span><br><span class="line">        switch (scrollState) &#123;</span><br><span class="line">            <span class="comment">// 当不滚动时</span></span><br><span class="line">            case OnScrollListener.SCROLL_STATE_IDLE:</span><br><span class="line">            <span class="comment">// 判断滚动到底部</span></span><br><span class="line">            <span class="keyword">if</span> (lv.get<span class="constructor">LastVisiblePosition()</span><span class="operator"> == </span>(lv.get<span class="constructor">Count()</span> - <span class="number">1</span>)) &#123;</span><br><span class="line">            </span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 判断滚动到顶部</span></span><br><span class="line">            <span class="keyword">if</span>(lv.get<span class="constructor">FirstVisiblePosition()</span><span class="operator"> == </span><span class="number">0</span>)&#123;</span><br><span class="line">            </span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    public void on<span class="constructor">Scroll(AbsListView <span class="params">view</span>, <span class="params">int</span> <span class="params">firstVisibleItem</span>,<span class="params">int</span> <span class="params">visibleItemCount</span>, <span class="params">int</span> <span class="params">totalItemCount</span>)</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">get<span class="constructor">ListView()</span>.set<span class="constructor">OnScrollListener(<span class="params">new</span> OnScrollListener()</span> &#123;  </span><br><span class="line">    public void on<span class="constructor">ScrollStateChanged(AbsListView <span class="params">view</span>, <span class="params">int</span> <span class="params">scrollState</span>)</span>&#123;  </span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">    public void on<span class="constructor">Scroll(AbsListView <span class="params">view</span>, <span class="params">int</span> <span class="params">firstVisibleItem</span>, <span class="params">int</span> <span class="params">visibleItemCount</span>, <span class="params">int</span> <span class="params">totalItemCount</span>)</span> &#123;  </span><br><span class="line">            <span class="keyword">if</span>(firstVisibleItem==<span class="number">0</span>)&#123;  </span><br><span class="line">                <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>e(<span class="string">&quot;log&quot;</span>, <span class="string">&quot;滑到顶部&quot;</span>);  </span><br><span class="line">                &#125; </span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(visibleItemCount + firstVisibleItem<span class="operator"> == </span>totalItemCount)&#123;  </span><br><span class="line">                <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>e(<span class="string">&quot;log&quot;</span>, <span class="string">&quot;滑到底部&quot;</span>);  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/04/01/Android-初步之ListView/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/04/01/Android-初步之ListView/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/31/Android-初步之数据存储/" title="Android 初步之数据存储" itemprop="url">Android 初步之数据存储</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-31T13:15:28.000Z" itemprop="datePublished"> Published 2016-03-31</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Android 中提供了较多的数据存储和交换方式，如SharedPreference+Preference Activity，File，SQLite+Content Provider，以及XML JSON 格式数据解析等。它们各有各的优点，而它们的优点也决定了它们的使用范围。</p>
<h4 id="SharedPreferences"><a href="#SharedPreferences" class="headerlink" title="SharedPreferences"></a>SharedPreferences</h4><p>SharedPreferences 类提供给开发人员保存和获取基本数据类型的键值对的方式。该类主要用于类似基本类型，等简单变量，在应用程序结束后，数据仍旧会保存。这些数据会以XML文件的形式存储在apk的包里面。</p>
<h5 id="SharedPreferences的获取："><a href="#SharedPreferences的获取：" class="headerlink" title="SharedPreferences的获取："></a>SharedPreferences的获取：</h5><p>SharedPreferences的获取方式有两种:</p>
<ol>
<li>getSharedPreferences()：如果需要多个使用名称来区分的共享文件，则可以使用该方法，其第一参数就是共享文件的名称，对于使用同一个名称获得的多个SharedPreferences引用，其指向同一个对象。</li>
<li>getPreferences()：如果Activity仅需要一个共享文件，则可以使用该方法。因为只有一个文件，它并不需要提供名称。</li>
</ol>
<h5 id="向SharedPreferences类中增加值："><a href="#向SharedPreferences类中增加值：" class="headerlink" title="向SharedPreferences类中增加值："></a>向SharedPreferences类中增加值：</h5><p>完成向SharedPreferences类中增加值的步骤如下：</p>
<ol>
<li>调用SharedPreferences类的edit方法获得SharedPreferences.Editor对象</li>
<li>调用诸如putBoolean()，putString()等方法增加数据</li>
<li>使用commit方法或者apply方法提交新值。</li>
</ol>
<h5 id="写入sharedPreferences"><a href="#写入sharedPreferences" class="headerlink" title="写入sharedPreferences"></a>写入sharedPreferences</h5><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">SharedPreferences  sharedpreference = get<span class="constructor">SharedPreferences(<span class="string">&quot;messageBylinxiaohai&quot;</span>,MODE_PRIVATE)</span>;</span><br><span class="line">Editor editor = sharedpreference.edit<span class="literal">()</span>;</span><br><span class="line">editor.put<span class="constructor">String(<span class="string">&quot;name&quot;</span>,<span class="params">names</span>)</span>;</span><br><span class="line">editor.put<span class="constructor">String(<span class="string">&quot;password&quot;</span>,<span class="params">passwords</span>)</span>;</span><br><span class="line">editor.commit<span class="literal">()</span>;</span><br></pre></td></tr></table></figure>

<h5 id="读出sharedPreferences"><a href="#读出sharedPreferences" class="headerlink" title="读出sharedPreferences"></a>读出sharedPreferences</h5><figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">SharedPreferences sharedPrefereces = getSharedPreferences(<span class="string">&quot;messageBylinxiaohai&quot;</span>,MODE_PRIVATE);</span><br><span class="line">String name = sharedPrefereces.<span class="keyword">get</span><span class="built_in">String</span>(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">String password = sharedPrefereces.<span class="keyword">get</span><span class="built_in">String</span>(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>对于SharedPreferences而言，它使用XML文件来保存数据，文件名与指定的名称相同，存储在data&#x2F;data文件夹下</p>
<h5 id="数据存储模式"><a href="#数据存储模式" class="headerlink" title="数据存储模式"></a>数据存储模式</h5><p>数据存储有三种常见模式:<br>MODE_PRIVATE:私有方式<br>MODE_WORLD_READALE:全局可读<br>MODE_WORD_WRITEABLE:全局可写</p>
<h4 id="Preference-Activity"><a href="#Preference-Activity" class="headerlink" title="Preference Activity"></a>Preference Activity</h4><p>Android 提供了一个用于为应用程序创建系统样式的Preference Screen。它能够确保应用程序中的Preference Activity与本地和其他第三方应用程序中所使用的一致。</p>
<h6 id="Preference-Activity-组成"><a href="#Preference-Activity-组成" class="headerlink" title="Preference Activity 组成"></a>Preference Activity 组成</h6><p>Preference Activity 由4个部分组成:</p>
<ul>
<li>Preferences Screen布局: 一个XML文件，定义了在Preference Screen中显示的层次结构，它指定了要显示的文本以及相关控件等信息。</li>
<li>Preference Activity 和Preference Fragment 分别是 PreferenceActivity 和Preference Fragment 的扩展，用于包含Preference Screen，在Android 3.0之后，Preference Screen包含在Preference Fragment中，而Preference Fragment包含在Preference Activity中。</li>
<li>Preference Header定义:一个XML文件，定义了应用程序的Preference  Fragment 以及用于显示Preference Fragment的层次结构。</li>
<li>SharedPreference 变化监听器:onSharedPreferenceChangeListener类的实现，用于监听SharedPreference 的变化。</li>
</ul>
<h6 id="实现一个Preference-Activity"><a href="#实现一个Preference-Activity" class="headerlink" title="实现一个Preference Activity"></a>实现一个Preference Activity</h6><p>步骤1:定义Preference Screen</p>
<ol>
<li><p>Preference screen定义文件存储在res&#x2F;xml文件夹中.</p>
</li>
<li><p>Preference Screen 定义格式如下:</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">&lt;？<span class="type">xml</span> version=“<span class="number">1.0</span>” encoding=“utf<span class="number">-8</span>”？&gt;</span><br><span class="line">&lt;PreferenceScreen xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt;</span><br><span class="line">&lt;/PreferenceScreen&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>PreferenceScreen 内部还可以嵌套另一个PreferenceScreen ，每个PreferenceScreen 将表示为一个可选的元素，单击它会出现一个新的屏幕。</p>
</li>
<li><p>在每个PreferenceScreen 内部可以包含PreferenceCategory 和 xxxPreference控件<br>PreferenceCategory定义:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">PreferenceCategory</span> <span class="attr">android:title</span>=<span class="string">&quot;SMS助手&quot;</span> &gt;</span></span><br></pre></td></tr></table></figure>
<p>Preference常用控件:</p>
</li>
</ol>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">CheckBoxPreference:复选控件</span></span><br><span class="line"><span class="section">EditTextPreference:允许用户输入一个字符串值作为首选项，在运行时首选项文本将会显示一个文本输入对话框</span></span><br><span class="line">ListPreference 该首选项会显示一个对话框，其中包含了可供选择的值的列表，可以指定不同的数组以包含显示文本和选项值。</span><br><span class="line">MultiSelectListPreference：类似于复选框列表</span><br><span class="line"><span class="section">RingtonePreference:一个专用的列表首选项，显示可供用户选择的可用铃声列表</span></span><br><span class="line"><span class="section">每个Preference控件应当至少包含下列4种属性:</span></span><br><span class="line"><span class="section">android:key:SharePreference 键，所选择的值将会根据相应的键进行记录。</span></span><br><span class="line"><span class="section">android:title:用于表示首选项的显示文本</span></span><br><span class="line"><span class="section">android:summary:在标题文本下方以更小字体显示的更长的文本描述</span></span><br><span class="line"><span class="section">android:defaultValue:当没有为该首选项分配选项值的时候将会显示默认值</span></span><br></pre></td></tr></table></figure>
<p>还可以使用Intent在Preference Screen中导入系统首选项:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">PreferenceScreen</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:summary</span>=<span class="string">&quot;System Preference imported using an intent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:title</span>=<span class="string">&quot;Intent Preference&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent</span> <span class="attr">android:action</span>=<span class="string">&quot;android.settings.DISPLAY_SETTINGS&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>下方为定义一个Preference Screen的一个例子。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">PreferenceScreen</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:defaultValue</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:key</span>=<span class="string">&quot;autoBack&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summaryOff</span>=<span class="string">&quot;关闭&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summaryOn</span>=<span class="string">&quot;开启&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;自动回复&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PreferenceCategory</span> <span class="attr">android:title</span>=<span class="string">&quot;SMS助手&quot;</span> &gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:defaultValue</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:key</span>=<span class="string">&quot;smsSilence&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:summaryOff</span>=<span class="string">&quot;关闭&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:summaryOn</span>=<span class="string">&quot;开启&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">&quot;静音&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">PreferenceScreen</span> <span class="attr">android:title</span>=<span class="string">&quot;更多选项&quot;</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:defaultValue</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;cb21&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOff</span>=<span class="string">&quot;关闭&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOn</span>=<span class="string">&quot;开启&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;功能1&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:defaultValue</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;cb22&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOff</span>=<span class="string">&quot;停用&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOn</span>=<span class="string">&quot;使用&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;功能2&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ListPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:dialogTitle</span>=<span class="string">&quot;请选择论坛&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:entries</span>=<span class="string">&quot;@array/listentry&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:entryValues</span>=<span class="string">&quot;@array/listvalue&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;list1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summary</span>=<span class="string">&quot;开发者论坛&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;android form&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditTextPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:defaultValue</span>=<span class="string">&quot;Hello EditTextPreference&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:dialogTitle</span>=<span class="string">&quot;设置输入&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;et1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summary</span>=<span class="string">&quot;点击输入&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;EditTextPreference Simple&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">PreferenceCategory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PreferenceCategory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RingtonePreference</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:key</span>=<span class="string">&quot;rt1&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:summary</span>=<span class="string">&quot;选择铃声&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">&quot;RingtonePreference Sample&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">PreferenceCategory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">PreferenceScreen</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summary</span>=<span class="string">&quot;System Preference imported using an intent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;Intent Preference&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">intent</span> <span class="attr">android:action</span>=<span class="string">&quot;android.settings.DISPLAY_SETTINGS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>步骤2  实现Preference Fragment</p>
<ol>
<li>继承PreferenceFragment</li>
<li>在onCreate方法中调用addPreferencesFromResource。如下所示:</li>
</ol>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">PreferenceFragment</span></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</span><br><span class="line">	<span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">	addPreferencesFromResource(<span class="type">R</span>.xml.setting);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>步骤3  创建Preferece Header</p>
<p>Preference Header 描述了Preference Fragment在Preference Activity中如何分组和显示，每个头都表示并允许显示一个特定的Preference Fragment。<br>Preference Header是XML资源，存储在res&#x2F;xml文件中，每个头的资源ID就是它的文件名。每个Preference Header都必须与一个特定的Preference Fragment关联，当选中该头的时候，Fragment就会显示出来，必须指定Preference Header的标题，还可以包含一个摘要和图片资源。还可以使用一个Intent调用.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">preference-headers</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fragment</span>=<span class="string">&quot;com.example.testpreferencefragment.UserSettings&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summary</span>=<span class="string">&quot;系统设置&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;Setting&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">intent</span>  <span class="attr">android:action</span>=<span class="string">“android:settings.DISPLAY_SETTINGS”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">preference-headers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>步骤4  实现Preference Activity</p>
<p>Preference Activity类用于包含由Preference Header资源定义的PreferenceFragment 层次结构。</p>
<ul>
<li>继承PreferenceActivity<br>public class MainActivity extends PreferenceActivity</li>
<li>去掉onCreate的实现</li>
<li>重写onBuildHeaders方法，在其中调用loadHeadersFromResource并指定一个Preference Header资源文件。</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public void on<span class="constructor">BuildHeaders(List&lt;Header&gt; <span class="params">target</span>)</span> &#123;</span><br><span class="line">    load<span class="constructor">HeadersFromResource(R.<span class="params">xml</span>.<span class="params">preferenceheader</span>, <span class="params">target</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在Manifest清单文件中注册PreferenceActivity</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.testpreferencefragment.UserSettingActivity&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>为了显示在该Activity中包含的应用程序设置，需要调用startActivity或者startActivityForResult打开它。</li>
</ul>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">UserSettingActivity</span> <span class="keyword">extends</span> <span class="title">PreferenceActivity</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    public void onBuildHeaders(<span class="type">List</span>&lt;<span class="type">Header</span>&gt; target) &#123;</span><br><span class="line">        loadHeadersFromResource(<span class="type">R</span>.xml.preferenceheader, target);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> boolean isValidFragment(<span class="type">String</span> fragmentName) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>使用Preference Screen设置的Shared Preference：</li>
</ol>
<p>包括Activity ，Service 和BroadCast Receiver都能访问存储在应用程序沙袋中的Shered Preference值。可以使用如下方法:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">SharedPreferences prefs = <span class="module-access"><span class="module"><span class="identifier">PreferenceManager</span>.</span></span>get<span class="constructor">DefaultSharedPreferences(<span class="params">getApplicationContext</span>()</span>);</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>设置监听器</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">mSharedPreference = <span class="module-access"><span class="module"><span class="identifier">PreferenceManager</span>.</span></span>get<span class="constructor">DefaultSharedPreferences(<span class="params">this</span>)</span>;</span><br><span class="line">mSharedPreference.register<span class="constructor">OnSharedPreferenceChangeListener(<span class="params">new</span> OnSharedPreferenceChangeListener()</span> &#123;</span><br><span class="line">    public void on<span class="constructor">SharedPreferenceChanged(SharedPreferences <span class="params">shareferences</span>, String <span class="params">key</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(key.equals(<span class="string">&quot;autoBack&quot;</span>))&#123;</span><br><span class="line">            boolean autoBackStatus = 				</span><br><span class="line">            shareferences.get<span class="constructor">Boolean(<span class="string">&quot;autoBack&quot;</span>, <span class="params">false</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span>(autoBackStatus)&#123;<span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(<span class="string">&quot;PreferenceActivity&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;<span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(<span class="string">&quot;PreferenceActivity&quot;</span>,<span class="string">&quot;false&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/1.png"></p>
<h4 id="FILE-文件"><a href="#FILE-文件" class="headerlink" title="FILE 文件"></a>FILE 文件</h4><p>文件一般存储在外部存储中：这些外部存储可以被所有应用程序访问，通过USB连接到设备后，可以被挂载到计算机文件系统，外部存储一般位于SD卡上，但是有些设备是在内部存储中将其作为一个独立的分区来实现。当在外部存储介质上存储文件时，对于存储这些文件是没有强制的安全保障的，任何程序都可以访问，重写或者删除这些存储在外部存储中的文件。同时外部存储可能不总是可用的，如果SD卡弹出或者这个设备通过被计算机挂载来访问，应用程序就不能在外部存储上读取文件了。</p>
<h5 id="使用raw文件作为资源"><a href="#使用raw文件作为资源" class="headerlink" title="使用raw文件作为资源"></a>使用raw文件作为资源</h5><p>可以将外部文件资源放置在项目层次结构的res&#x2F;raw文件夹中作为程序所需的外部文件资源，这些资源将在分发包中包含它们。<br>下面是读取raw文件夹下的一个歌词文件的例子，结果如下图，代码如下：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">inputStream = get<span class="constructor">Resources()</span>.<span class="keyword">open</span><span class="constructor">RawResource(R.<span class="params">raw</span>.<span class="params">rawfile</span>)</span>;</span><br><span class="line">Reader reader = <span class="keyword">new</span> <span class="constructor">InputStreamReader(<span class="params">inputStream</span>)</span>; </span><br><span class="line">BufferedReader br = <span class="keyword">new</span> <span class="constructor">BufferedReader(<span class="params">reader</span>)</span>;</span><br><span class="line">String lines = null;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>((lines = br.read<span class="constructor">Line()</span>)!=null)&#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(<span class="string">&quot;MainActivity&quot;</span>, lines);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(inputStream!=null) &#123;</span><br><span class="line">        inputStream.close<span class="literal">()</span>;</span><br><span class="line">        inputStream = null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(br!=null) &#123;</span><br><span class="line">        br.close<span class="literal">()</span>;</span><br><span class="line">        br = null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; catch (IOException e) &#123;</span><br><span class="line">    e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/2.png"></p>
<p>在Android中使用File对象存储数据主要有两种方式：</p>
<p>1.使用Java提供的IO流体系<br>使用FileOutputStream类提供的openFileOutput()方法来打开相应的输出流。使用FileInputStream类提供的openFileInput()方法打开相应的输入流，默认情况下使用IO流保存的文件仅对当前应用程序可见，也就是仅仅能够从应用程序沙箱中读写文件，指定路径分隔符将会导致抛出一个异常，如果用户卸载了该应用程序，则保护数据文件也会一起被删除。<br>在创建FileOutputstream的时候，如果指定的文件名不存在，Android将会创建一个新的文件，如果文件已经存在那么默认的行为就是覆盖它，如果想要在已经存在的文件末尾添加内容，可以指定其模式为MODE_APPEND.<br>如果要将这些文件分享给其他应用可用可以使用Content Provider或者在创建的时候使用：MODE_WORLD_WRITEABLE和MODE_READABLE.<br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/4.png"><br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/5.png"></p>
<p>如果应用程序需要缓存临时文件，Android提供了可以管理的内部缓存和一个不能管理的外部缓存，分别调用getCacheDir和getExtenalCacheDir方法可以从当前的上下文中访问它们。<br>存储在任何一个该缓存位置中的文件在应用程序被卸载后都会被删除掉，当系统运行在低可用存储空间的时候，存储在内部缓存的文件可能被系统所删除，存储在外部缓存中的文件则不会被删除掉，因为系统不会跟踪外部媒介的可用存储空间。</p>
<p>使用Environment类提供的getExternalStorageDirectory方法对Android的SD卡进行数据读写。每个Android设备都支持共享的外部存储用来保存文件，这可以是SD卡等可以移除的存储介质，也可以是手机内存等不可移除的存储介质，保存的外部存储文件都是全局可读的，并且在用户使用USB连接电脑后可以修改这些文件。</p>
<p>使用Environment.getExtralStoragePublicDirectory可以用来找到存储应用程序文件的路径，返回的位置为用户通常存放和管理各类文件的位置。</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">DIRECTORY_ALARMS:</span>用户可选的警示音的可用的声音文件</span><br><span class="line"><span class="symbol">DIRECTORY_RINGTONES:</span>用户可选的铃声的可用的声音文件</span><br><span class="line"><span class="symbol">DIRECTORY_NOTIFICATIONS:</span>用户可选的通知音的可用的声音文件</span><br><span class="line"><span class="symbol">DIRECTORY_DCIM:</span>拍摄到的图片和视频</span><br><span class="line"><span class="symbol">DIRECTORY_PICTURES:</span>图片</span><br><span class="line"><span class="symbol">DIRECTORY_DOWNLOADS:</span>用户下载的文件</span><br><span class="line"><span class="symbol">DIRECTORY_MOVIES:</span>电影</span><br></pre></td></tr></table></figure>

<p>如果返回的目录不存在，必须在向该目录写入文件前先创建它。<br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/7.png"><br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/8.png"></p>
<h4 id="SQLite-Content-Provider"><a href="#SQLite-Content-Provider" class="headerlink" title="SQLite + Content Provider"></a>SQLite + Content Provider</h4><h5 id="SQLite数据库"><a href="#SQLite数据库" class="headerlink" title="SQLite数据库"></a>SQLite数据库</h5><p>Android 通过结合使用SQLite数据库和Content Provider，提供了结构化数据的持久化功能。<br>Android应用程序的数据库存储在&#x2F;data&#x2F;data&#x2F;包名&#x2F;database，所有的数据库都是私有的，只能被创建它们的应用程序访问。<br>SQLite 数据库已经被实现为简洁的C语言库，并且是Android软件栈的一部分。通过作为一个库实现，而不是作为一个独立的进程不断执行，每个SQLite数据库成为创建它的应用程序的完整部分，这样做能够减少应用程序的外部依赖性，最小延迟，并简化事务锁定和同步。<br>SQLite在列定义中使用了一种松散类型的方式，即并不要求一列中的所有值都是同一种类型。</p>
<h5 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h5><p>在使用数据库的时候，最好将底层数据库封装起来，只公开与数据库进行交互时必须使用的公有方法和常量，这一般会用到辅助类，这个类用于公开数据库常量，特别是列名等公共元素。</p>
<p>SQLiteOpenHelper是一个抽象类，可以用来实现创建，打开，升级数据库等操作。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBOpenHelper</span> <span class="keyword">extends</span> <span class="title class_">SQLiteOpenHelper</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DBOpenHelper</span><span class="params">(Context context, String name, <span class="type">int</span> version)</span> &#123;</span><br><span class="line">	    <span class="built_in">super</span>(context, name, <span class="literal">null</span>, version);</span><br><span class="line">	    <span class="built_in">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(SQLiteDatabase db)</span> &#123;</span><br><span class="line">	    db.execSQL(AppConstant.CREATE_TABLE);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="type">int</span> oldVersion, <span class="type">int</span> newVersion)</span> &#123;</span><br><span class="line">	    db.execSQL(<span class="string">&quot;drop table if exists&quot;</span> + AppConstant.TABLE_NAME);</span><br><span class="line">	    onCreate(db);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="创建数据库所需的辅助常量"><a href="#创建数据库所需的辅助常量" class="headerlink" title="创建数据库所需的辅助常量"></a>创建数据库所需的辅助常量</h5><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConstant</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> DATABASE_NAME = <span class="string">&quot;userdatabase.db&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">int</span> DATABASE_VERSION = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> TABLE_NAME = <span class="string">&quot;usertable&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> USER_NAME = <span class="string">&quot;username&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> USER_PWD = <span class="string">&quot;userpwd&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> ID = <span class="string">&quot;_id&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> CREATE_TABLE = <span class="string">&quot;create table &quot;</span>+TABLE_NAME+<span class="string">&quot;(&quot;</span>+ID+<span class="string">&quot; integer primary key autoincrement, &quot;</span>+USER_NAME+<span class="string">&quot;  text not null, &quot;</span>+USER_PWD+<span class="string">&quot; text not null );&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="创建数据库操作类"><a href="#创建数据库操作类" class="headerlink" title="创建数据库操作类"></a>创建数据库操作类</h5><p>一般使用一个专门的类来执行对数据库条目的增删查改操作:<br>下面为数据库操作类的实现源码:</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> DBOperator &#123;</span><br><span class="line">    private SQLiteDatabase <span class="keyword">database</span> = <span class="keyword">null</span>;</span><br><span class="line">    private DBOpenHelper helper = <span class="keyword">null</span>;</span><br><span class="line">    private Context context = <span class="keyword">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">public</span> DBOperator(Context context) &#123;</span><br><span class="line">        helper = <span class="built_in">new</span> DBOpenHelper(context, AppConstant.DATABASE_NAME, AppConstant.DATABASE_VERSION);</span><br><span class="line">        <span class="keyword">database</span> = helper.getWritableDatabase();</span><br><span class="line">        this.context = context; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> String DataBasequry(String <span class="type">name</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Cursor</span> c = <span class="keyword">database</span>.query(AppConstant.<span class="built_in">TABLE_NAME</span>,<span class="keyword">null</span> ,AppConstant.USER_NAME+&quot;= ?&quot;,<span class="built_in">new</span> String[]&#123;<span class="type">name</span>&#125;, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        <span class="type">int</span> count = c.getCount();</span><br><span class="line">        <span class="keyword">if</span>(count&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            c.moveToFirst();</span><br><span class="line">            String pwd = c.getString(c.getColumnIndex(AppConstant.USER_PWD));</span><br><span class="line">            c.<span class="keyword">close</span>();</span><br><span class="line">            <span class="keyword">return</span> pwd;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            c.<span class="keyword">close</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> String ShowDataBase()&#123;</span><br><span class="line">        <span class="keyword">Cursor</span> c = <span class="keyword">database</span>.query(AppConstant.<span class="built_in">TABLE_NAME</span>,<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        StringBuilder sb = <span class="built_in">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">if</span>(c.getCount()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span>(c.moveToNext()) &#123;</span><br><span class="line">            sb.append(c.getString(c.getColumnIndex(AppConstant.USER_NAME))+&quot;\n&quot;+c.getString(c.getColumnIndex(AppConstant.USER_PWD))+&quot;\n&quot;);</span><br><span class="line">            sb.append(&quot;\n&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        c.<span class="keyword">close</span>();</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> DataBasedelete(String <span class="type">name</span>)&#123;</span><br><span class="line">        <span class="keyword">database</span>.<span class="keyword">delete</span>(AppConstant.<span class="built_in">TABLE_NAME</span>,AppConstant.USER_NAME+&quot;=?&quot;,<span class="built_in">new</span> String[]&#123;<span class="type">name</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> DataBaseinsert(String <span class="type">name</span>,String pwd)&#123;</span><br><span class="line">        ContentValues <span class="keyword">values</span> = <span class="built_in">new</span> ContentValues();</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_NAME, <span class="type">name</span>);</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_PWD, pwd);</span><br><span class="line">        <span class="keyword">database</span>.<span class="keyword">insert</span>(AppConstant.<span class="built_in">TABLE_NAME</span>, <span class="keyword">null</span>, <span class="keyword">values</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> DataBaseupdate(String <span class="type">name</span>,String pwd)&#123;</span><br><span class="line">        ContentValues <span class="keyword">values</span> = <span class="built_in">new</span> ContentValues();</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_NAME, <span class="type">name</span>);</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_PWD, pwd);</span><br><span class="line">        <span class="keyword">database</span>.<span class="keyword">update</span>(AppConstant.<span class="built_in">TABLE_NAME</span>, <span class="keyword">values</span> , AppConstant.USER_NAME+&quot;=?&quot;,<span class="built_in">new</span> String[]&#123;<span class="type">name</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Cursor"><a href="#Cursor" class="headerlink" title="Cursor"></a>Cursor</h5><p>数据库查询结果作为Cursor对象返回，Cursor是底层数据库中的结果集指针。Cursor类包含了多个导航函数：</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">moveToFirst </span> 把游标移动到查询结果中的第一行</span><br><span class="line"><span class="keyword">moveToNext </span>把游标向下移动到下一行</span><br><span class="line"><span class="keyword">moveToPrevious </span>把游标向上移动到上一行</span><br><span class="line"><span class="keyword">moveToPosition </span> 把游标移动到指定行</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">getPostion</span> 返回当前游标位置</span><br><span class="line"><span class="attribute">getColumnName</span> 返回指定列索引的名称</span><br><span class="line"><span class="attribute">getColumnNames</span> 返回当前Cursor中所有列名的字符串数组。</span><br><span class="line"><span class="attribute">getCount</span> 返回结果集中的行数</span><br><span class="line"><span class="attribute">getColumnIndexOrThrow</span> 返回具有指定名称的列的索引（如果不存在拥有该名称的列，就会抛出异常），索引从<span class="number">0</span>开始计数。</span><br><span class="line"><span class="attribute">getColumnIndex</span>与上述的方法功能相类似。</span><br></pre></td></tr></table></figure>

<p>当列有可能在一些情况中不存在时，使用getColumnIndex并检查结果是否为-1比较合适，当可以保证所有情况中都存在的时候使用getColumnIndexOrThrow 较为合适。</p>
<h5 id="Content-Provider-内容提供者"><a href="#Content-Provider-内容提供者" class="headerlink" title="Content Provider 内容提供者"></a>Content Provider 内容提供者</h5><p>Content Provider 提供了一个接口用来发布数据，通过Content Resolver来使用该数据，从而将使用数据的应用程序组件和底层的数据源分开。并提供了一种通用机制来允许一个应用程序共享它们的数据或者使用其他应用程序提供的数据。<br>Content Provider  内部如何保存数据由其设计者决定，但是所有的Content Provider 都实现一组通用的方法用来提供数据的增，删，查，改功能。<br>客户端通常不会直接调用这些方法，大多数是通过Content Resolver 对象实现对Content Provider 的操作，开发人员可以通过调用Activity或者其他应用程序组件的实现类中的getContentResolver来获取ContentResolver对象。</p>
<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/9.png"></p>
<h5 id="自定义Content-Provider"><a href="#自定义Content-Provider" class="headerlink" title="自定义Content Provider"></a>自定义Content Provider</h5><ul>
<li>创建一个Content Provider抽象类的子类:</li>
</ul>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyContentProvider</span> <span class="keyword">extends</span> <span class="title">ContentProvider</span> </span></span><br></pre></td></tr></table></figure>
<p>这时候会有如下方法需要重写:</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">boolean</span> <span class="title function_">onCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title class_">Cursor</span> <span class="title function_">query</span>(<span class="params">Uri uri, <span class="built_in">String</span>[] projection, <span class="built_in">String</span> selection,<span class="built_in">String</span>[] selectionArgs, <span class="built_in">String</span> sortOrder</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getType</span>(<span class="params">Uri uri</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title class_">Uri</span> <span class="title function_">insert</span>(<span class="params">Uri uri, ContentValues values</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> int <span class="title function_">delete</span>(<span class="params">Uri uri, <span class="built_in">String</span> selection, <span class="built_in">String</span>[] selectionArgs</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> int <span class="title function_">update</span>(<span class="params">Uri uri, ContentValues values, <span class="built_in">String</span> selection,<span class="built_in">String</span>[] selectionArgs</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>注册Content Provider:<br>为了让Content Resolver能够找到Content Provider必须在Android Manifest文件中对其进行注册，Content Provider注册是通过<provider>标签来实现的，必须指定name属性和authorities这两个属性。<br>authorities属性用来标记Content Provider的基本URI。Content Resolver使用它来找到想要交互的数据库。每个authorities必须唯一，因此可以使用应用的包名。</provider></li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.example.contentprovider.CustomProvider&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">&quot;com.example.provider.TestContentProvider&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>定义CONTENT_URI</li>
</ul>
<p>每个Content Provider 都需要使用一个公有的静态CONTENT_URI属性来公开它的授权。 CONTENT_URI可以按照如下形式定义:</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">Uri</span> CONTENT_URI = <span class="built_in">Uri</span>.parse(<span class="string">&quot;content://com.example.provider.TestContentProvider/data&quot;</span>); </span><br></pre></td></tr></table></figure>

<p>直接使用这种形式的查询表示请求所有行，而在结尾附加&#x2F;rownumber的查询如： </p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">content:<span class="regexp">//</span>com.example.provider.TestContentProvider<span class="regexp">/data/</span><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>所示表示请求一条记录。</p>
<ul>
<li>使用UriMatcher来解析URI请求:</li>
</ul>
<p>通过解析可以确定这个URI是请求所有数据还是单行数据。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SINGLE_ROW</span> <span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MULTI_ROWS</span> <span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">UriMatcher</span> <span class="variable">matcher</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">static</span>&#123;</span><br><span class="line">    matcher = <span class="keyword">new</span> <span class="title class_">UriMatcher</span>(UriMatcher.NO_MATCH);</span><br><span class="line">    matcher.addURI(<span class="string">&quot;com.example.provider.TestContentProvider&quot;</span>,<span class="string">&quot;data&quot;</span>, MULTI_ROWS);</span><br><span class="line">    matcher.addURI(<span class="string">&quot;com.example.provider.TestContentProvider&quot;</span>, <span class="string">&quot;data/#&quot;</span>, SINGLE_ROW);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现SQLiteOpenHelper 子类<br>该部分实现见SQL总结部分。代码如下：<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBConstant</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> DATABASE_NAME = <span class="string">&quot;mydatabase.db&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">int</span> DATABASE_VERSION = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> TABLE_NAME = <span class="string">&quot;testtable&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> ID=<span class="string">&quot;_id&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> USERNAME=<span class="string">&quot;name&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> PASSWORD=<span class="string">&quot;pwd&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> CREATE_TABLE=</span><br><span class="line">	<span class="string">&quot;create table &quot;</span>+TABLE_NAME+<span class="string">&quot;(&quot;</span></span><br><span class="line">			+ID +<span class="string">&quot; integer primary key autoincrement,&quot;</span></span><br><span class="line">			+USERNAME+<span class="string">&quot; text not null,&quot;</span></span><br><span class="line">			+PASSWORD+<span class="string">&quot; text not null&quot;</span></span><br><span class="line">	+<span class="string">&quot;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBOpenHelper</span> extends SQLiteOpenHelper &#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">DBOpenHelper</span><span class="params">(Context context, <span class="type">String</span> name,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="type">int</span> version)</span> </span>&#123;</span><br><span class="line">		<span class="built_in">super</span>(context, name, null, version);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">onCreate</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</span><br><span class="line">		db.<span class="built_in">execSQL</span>(DBConstant.CREATE_TABLE);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="type">int</span> oldVersion, <span class="type">int</span> newVersion)</span> </span>&#123;</span><br><span class="line">		db.<span class="built_in">execSQL</span>(<span class="string">&quot;drop table if exists &quot;</span>+DBConstant.TABLE_NAME);</span><br><span class="line">		<span class="built_in">onCreate</span>(db);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>实现Content Provider抽象类中的方法:</li>
</ul>
<p>构造底层数据库</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">DBOpenHelper</span> <span class="variable">mOpenHelper</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="type">SQLiteDatabase</span> <span class="variable">database</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreate</span><span class="params">()</span> &#123;</span><br><span class="line">	mOpenHelper = <span class="keyword">new</span> <span class="title class_">DBOpenHelper</span>(getContext(),DBConstant.DATABASE_NAME,DBConstant.DATABASE_VERSION);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里并不打开数据库，直到需到执行一个查询或者事务的时候再打开。</p>
<ul>
<li>实现查询方法</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Cursor <span class="title">query</span><span class="params">(Uri uri, <span class="type">String</span>[] projection, <span class="type">String</span> selection,</span></span></span><br><span class="line"><span class="params"><span class="function">		    <span class="type">String</span>[] selectionArgs, <span class="type">String</span> sortOrder)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	database = mOpenHelper.<span class="built_in">getWritableDatabase</span>();</span><br><span class="line"></span><br><span class="line">	SQLiteQueryBuilder querybuilder = <span class="keyword">new</span> <span class="built_in">SQLiteQueryBuilder</span>();</span><br><span class="line">	querybuilder.<span class="built_in">setTables</span>(DBConstant.DATABASE_NAME);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> (matcher.<span class="built_in">match</span>(uri)) &#123;</span><br><span class="line">        <span class="keyword">case</span> SINGLE_ROW:</span><br><span class="line">            <span class="type">String</span> rowID = uri.<span class="built_in">getPathSegments</span>().<span class="built_in">get</span>(<span class="number">1</span>);</span><br><span class="line">            querybuilder.<span class="built_in">appendWhere</span>(DBConstant.ID+<span class="string">&quot; = &quot;</span>+rowID);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Cursor cursor = querybuilder.<span class="built_in">query</span>(database, projection, selection, 	selectionArgs,null,null, sortOrder);</span><br><span class="line">	<span class="keyword">return</span> cursor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现getType方法<br>如果要处理的数据类型是一种比较新的数据类型，实现查询后，还必须指定一个MIME类型来标识返回的数据，通过重写getType方法来返回唯一地描述该数据类型的字符串，返回的数据类型包括两种形式<br>单一项:</li>
</ul>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">vnd.android.<span class="built_in">cursor</span>.item/vnd.<span class="symbol">&lt;companyname&gt;</span>.<span class="symbol">&lt;contenttype&gt;</span></span><br></pre></td></tr></table></figure>

<p>所有项:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">vnd.android.<span class="built_in">cursor</span>.dir/vnd.<span class="symbol">&lt;companyname&gt;</span>.<span class="symbol">&lt;contenttype&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="type">String</span> <span class="title">getType</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">switch</span> (matcher.<span class="built_in">match</span>(uri)) &#123;</span><br><span class="line">	<span class="keyword">case</span> SINGLE_ROW: <span class="keyword">return</span> <span class="string">&quot;vnd.android.cursor.item/vnd.example.data&quot;</span>;</span><br><span class="line">	<span class="keyword">case</span> MULTI_ROWS: <span class="keyword">return</span> <span class="string">&quot;vnd.android.cursor.dir/vnd.example.data&quot;</span>;</span><br><span class="line">	<span class="keyword">default</span>: <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">IllegalArgumentException</span>(<span class="string">&quot;不支持当前Uri:&quot;</span>+uri);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>实现插入操作:</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> Uri <span class="keyword">insert</span>(Uri uri, ContentValues <span class="keyword">values</span>) &#123;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">database</span> = mOpenHelper.getWritableDatabase();</span><br><span class="line">	long id = <span class="keyword">database</span>.<span class="keyword">insert</span>(DBConstant.<span class="built_in">TABLE_NAME</span>, <span class="keyword">null</span>, <span class="keyword">values</span>);</span><br><span class="line">	<span class="keyword">if</span>(id &gt; <span class="number">-1</span>)&#123;</span><br><span class="line">		Uri insertUri = ContentUris.withAppendedId(uri, id);</span><br><span class="line">		getContext().getContentResolver().notifyChange(insertUri, </span><br><span class="line">		<span class="keyword">null</span>);</span><br><span class="line">		<span class="keyword">return</span> insertUri;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现更新操作</li>
</ul>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">public <span class="built_in">int</span> update(<span class="built_in">Uri</span> uri, ContentValues values, <span class="built_in">String</span> selection,</span><br><span class="line">			<span class="built_in">String</span>[] selectionArgs) &#123;</span><br><span class="line">		</span><br><span class="line">	database = mOpenHelper.getWritableDatabase();</span><br><span class="line">	<span class="keyword">switch</span> (matcher.match(uri)) &#123;</span><br><span class="line">	<span class="keyword">case</span> SINGLE_ROW:</span><br><span class="line">	<span class="built_in">String</span> rowId = uri.getPathSegments().<span class="keyword">get</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">String</span> whereID = DBConstant.ID +<span class="string">&quot; = &quot;</span>+rowId;</span><br><span class="line">	selection = ((selection == <span class="keyword">null</span>) ? selection:(whereID + <span class="string">&quot; AND &quot;</span>+<span class="string">&quot;(&quot;</span>+selection+<span class="string">&quot;)&quot;</span>));</span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="built_in">int</span> updateCount = database.update(DBConstant.TABLE_NAME,values, </span><br><span class="line">					selection,selectionArgs);</span><br><span class="line">	getContext().getContentResolver().notifyChange(uri, <span class="keyword">null</span>);</span><br><span class="line">	<span class="keyword">return</span> updateCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现删除操作:</li>
</ul>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">public <span class="built_in">int</span> delete(<span class="built_in">Uri</span> uri, <span class="built_in">String</span> selection, <span class="built_in">String</span>[] selectionArgs) &#123;</span><br><span class="line">	database = mOpenHelper.getWritableDatabase();</span><br><span class="line">	<span class="keyword">switch</span> (matcher.match(uri)) &#123;</span><br><span class="line">	<span class="keyword">case</span> SINGLE_ROW:</span><br><span class="line">	<span class="built_in">String</span> rowId = uri.getPathSegments().<span class="keyword">get</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">String</span> whereId = DBConstant.ID+<span class="string">&quot; = &quot;</span>+rowId;</span><br><span class="line">	selection = (TextUtils.isEmpty(selection) ?  </span><br><span class="line">		selection:<span class="string">&quot;( &quot;</span>+selection+<span class="string">&quot; )&quot;</span>+ <span class="string">&quot; AND &quot;</span>+whereId);    <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="keyword">if</span> (selection==<span class="keyword">null</span>) &#123;selection=<span class="string">&quot;1&quot;</span>;&#125;</span><br><span class="line">	<span class="built_in">int</span> deleteCount = database.delete(DBConstant.TABLE_NAME, selection,selectionArgs);</span><br><span class="line">	getContext().getContentResolver().notifyChange(uri, <span class="keyword">null</span>);</span><br><span class="line">	<span class="keyword">return</span> deleteCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>要想返回删除项的数量，必须指定一条where子句，要删除所有行并返回一个值，则传入”1”</p>
<ul>
<li>将当前Content Provider公开，并设置读写权限 ：<br>首选定义readPermission:</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span>  <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.READPROVIDER“</span></span></span><br><span class="line"><span class="string"><span class="tag">android:protectionLevel=&quot;</span><span class="attr">normal</span>&quot; &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">permission</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>定义writePermission:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.WRITEPROVIDER&quot;</span>        </span></span><br><span class="line"><span class="tag"><span class="attr">android:protectionLevel</span>=<span class="string">&quot;normal&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">permission</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>将权限添加到Content provider</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;provider………. </span><br><span class="line">    name和 authorities定义</span><br><span class="line">    android:readPermission=<span class="string">&quot;com.example.provider.TestContentProvider.permission.READPROVIDER&quot;</span>          </span><br><span class="line">    android:writePermission=<span class="string">&quot;com.example.provider.TestContentProvider.permission.WRITEPROVIDER&quot;</span></span><br><span class="line">    android:exported=<span class="string">&quot;true&quot;</span> &gt;</span><br><span class="line">&lt;/provider&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Content-Resolver"><a href="#Content-Resolver" class="headerlink" title="Content Resolver"></a>Content Resolver</h4><p>当使用Content Provider公开数据到时候,Content Resoler是用来在这些Content Provider上进行查询和执行事务对应的类。Content Resolver 可以找到指定的ContentProvider并获取到Content Provider的数据。Content Resolver在开始的时候，Android系统将确定查询所需的ContentProvider ，并确认它是否启动并运行它。android系统负责初始化所有的内容提供者，不需要用户自己去创建。实际上Content Provider用户都不能直接访问到Content Provider实例，只能通过ContentResolver在中间代理。<br> 每个应用程序都有一个ContentResolver实例，可使用getContentResolver方法来获取。</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">ContentResolver  resolver <span class="operator">=</span> getContentResolver()<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<h5 id="使用Content-Resolver访问自定义的Provider"><a href="#使用Content-Resolver访问自定义的Provider" class="headerlink" title="使用Content Resolver访问自定义的Provider"></a>使用Content Resolver访问自定义的Provider</h5><ul>
<li>添加权限：</li>
</ul>
<p>由于上述自定义的Content Provider设置了权限，因此要访问它的Resolver必须添加对应的权限才能访问，权限添加如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.READPROVIDER&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.WRITEPROVIDER&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>实现与Provider的接口</li>
</ul>
<p>为了验证能够通过一个应用访问另一个应用开放的内容提供者，编写了一个TestContentResolver程序来访问之前实现的TestContentProvider，两者关系如下图， TestContentResolver使用CONTENT_URI从找到对应的内容提供者，当TestContentResolver执行query方法的时候TestContentProvider 便会对应得调用自己的Content Provider.query方法。</p>
<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/11.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> <span class="keyword">implements</span> <span class="title class_">OnClickListener</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ID</span> <span class="operator">=</span> <span class="string">&quot;_id&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;name&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;pwd&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Uri</span> <span class="variable">CONTENT_URI</span> <span class="operator">=</span> Uri</span><br><span class="line">			.parse(<span class="string">&quot;content://com.example.provider.TestContentProvider/data&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mInsertBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mDeleteBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mQueryBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mUpdateBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mDeleteAllBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">TextView</span> <span class="variable">mShowResultTv</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">EditText</span> <span class="variable">mNameET</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">EditText</span> <span class="variable">mPasswordET</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">ContentResolver</span> <span class="variable">resolver</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">		setContentView(R.layout.activity_main);</span><br><span class="line">		mInsertBtn = (Button) findViewById(R.id.insertBtn);</span><br><span class="line">		mDeleteBtn = (Button) findViewById(R.id.deleteBtn);</span><br><span class="line">		mDeleteAllBtn = (Button) findViewById(R.id.deleteAllBtn);</span><br><span class="line">		mQueryBtn = (Button) findViewById(R.id.queryBtn);</span><br><span class="line">		mUpdateBtn = (Button) findViewById(R.id.updateBtn);</span><br><span class="line">		mShowResultTv = (TextView) findViewById(R.id.showResultTv);</span><br><span class="line">		mNameET = (EditText) findViewById(R.id.nameEd);</span><br><span class="line">		mPasswordET = (EditText) findViewById(R.id.pwdEd);</span><br><span class="line"></span><br><span class="line">		mInsertBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mDeleteBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mDeleteAllBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mQueryBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mUpdateBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">		resolver = getContentResolver();</span><br><span class="line">		mShowResultTv.setText(showResult());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> mNameET.getText().toString().trim();</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> mPasswordET.getText().toString().trim();</span><br><span class="line">		<span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">		<span class="keyword">case</span> R.id.queryBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name)) &#123;</span><br><span class="line">				<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> queryProviderbyName(name);</span><br><span class="line">				<span class="keyword">while</span> (cursor.moveToNext()) &#123;</span><br><span class="line">					Toast.makeText(</span><br><span class="line">							MainActivity.<span class="built_in">this</span>,</span><br><span class="line">							name</span><br><span class="line">									+ <span class="string">&quot;的密码为:&quot;</span></span><br><span class="line">									+ cursor.getString(cursor</span><br><span class="line">											.getColumnIndex(PASSWORD)),</span><br><span class="line">							Toast.LENGTH_LONG).show();</span><br><span class="line">				&#125;</span><br><span class="line">				cursor.close();</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;请输入要查询用户的用户名&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.deleteBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name)) &#123;</span><br><span class="line">				deleteProvider(name);</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.deleteAllBtn:</span><br><span class="line">			deleteAllProvider();</span><br><span class="line">			<span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> showResult();</span><br><span class="line">			<span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				mShowResultTv.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.insertBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name) &amp;&amp; !TextUtils.isEmpty(password)) &#123;</span><br><span class="line">				insertProvider(name, password);</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;用户名和密码不能为空&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.updateBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name) &amp;&amp; !TextUtils.isEmpty(password)) &#123;</span><br><span class="line">				<span class="type">ContentValues</span> <span class="variable">values</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ContentValues</span>();</span><br><span class="line">				values.put(USERNAME, <span class="string">&quot;new_&quot;</span> + name);</span><br><span class="line">				values.put(PASSWORD, <span class="string">&quot;new_&quot;</span> + password);</span><br><span class="line">				updateProvider(name, values);</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Cursor <span class="title function_">queryProviderbyName</span><span class="params">(String aname)</span> &#123;</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, USERNAME + <span class="string">&quot;=?&quot;</span>,</span><br><span class="line">				<span class="keyword">new</span> <span class="title class_">String</span>[] &#123; aname &#125;, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">return</span> cursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Cursor <span class="title function_">queryProviderbyId</span><span class="params">(<span class="type">int</span> aid)</span> &#123;</span><br><span class="line">		<span class="type">Uri</span> <span class="variable">rowaddr</span> <span class="operator">=</span> ContentUris.withAppendedId(CONTENT_URI, aid);</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> resolver.query(rowaddr, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">return</span> cursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Cursor <span class="title function_">queryProviderAll</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">return</span> cursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">insertProvider</span><span class="params">(String aname, String apassword)</span> &#123;</span><br><span class="line">		<span class="type">ContentValues</span> <span class="variable">values</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ContentValues</span>();</span><br><span class="line">		values.put(USERNAME, aname);</span><br><span class="line">		values.put(PASSWORD, apassword);</span><br><span class="line">		resolver.insert(CONTENT_URI, values);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">deleteProvider</span><span class="params">(String aname)</span> &#123;</span><br><span class="line">		resolver.delete(CONTENT_URI, USERNAME + <span class="string">&quot; = ?&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; aname &#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">deleteAllProvider</span><span class="params">()</span> &#123;</span><br><span class="line">		resolver.delete(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">updateProvider</span><span class="params">(String aname, ContentValues avalue)</span> &#123;</span><br><span class="line">		resolver.update(CONTENT_URI, avalue, USERNAME + <span class="string">&quot; = ?&quot;</span>,</span><br><span class="line">				<span class="keyword">new</span> <span class="title class_">String</span>[] &#123; aname &#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String <span class="title function_">showResult</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">		<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">c</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">while</span> (c.moveToNext()) &#123;</span><br><span class="line">			name = c.getString(c.getColumnIndex(USERNAME));</span><br><span class="line">			pwd = c.getString(c.getColumnIndex(PASSWORD));</span><br><span class="line">			sb.append(name + <span class="string">&quot;    &quot;</span> + pwd + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		c.close();</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用CursorLoader实现异步查询"><a href="#使用CursorLoader实现异步查询" class="headerlink" title="使用CursorLoader实现异步查询"></a>使用CursorLoader实现异步查询</h4><p>数据库查询是耗时的操作，对于数据库Content Provider查询来说，最好不要在应用程序的主线程中执行，Android 3.0引入了Loader类来异步加载数据和监控底层数据源的变化。<br>Loader类可以实现从任何数据源加载任何数据类型的数据，其中最常用的为CursorLoader类，它允许针对Content Provider执行异步查询并返回一个结果Cursor<br>CursorLoader能够在Activity或者Fragment中使用Cursor所需的所有管理任务，包括管理Cursor的生命周期以确保在Activity终止的时候关闭Cursor。<br>CursorLoader同样会监控底层查询的改变，所以不需要实现Content Observer。</p>
<ul>
<li>实现Cursor Loader Callback<br>由于LoaderCallback是使用泛型实现的，所以在实现的时候应显示指定加载的类型，如下所示:</li>
</ul>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="title">implements</span> <span class="title">OnClickListener</span> ,<span class="title">LoaderCallbacks&lt;Cursor&gt;</span>  </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要使用Cursor Loader必须实现如下三个方法:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public Loader&lt;Cursor&gt; on<span class="constructor">CreateLoader(<span class="params">int</span> <span class="params">id</span>, Bundle <span class="params">args</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//当Loader被初始化后，调用该方法返回一个Cursor Loader对象。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoadFinished(Loader&lt;<span class="keyword">Cursor</span>&gt; loader, <span class="keyword">Cursor</span> c) &#123;</span><br><span class="line">    //当Loader Manager 已经完成异步查询的时候该方法将会被调用，并把结果<span class="keyword">Cursor</span>作为参数传入，可以这个函数中使用<span class="keyword">Cursor</span>更新UI元素和数据适配器</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoaderReset(Loader&lt;<span class="keyword">Cursor</span>&gt; arg0) &#123;</span><br><span class="line">    //当Loader Manager 重置<span class="keyword">Cursor</span> Loader的时候，会调用该方法会被调用，在该方法中可以释放查询返回数据的引用，并重置相应的UI，但是不需要关闭<span class="keyword">Cursor</span>，Loader Manger会自动完成这个工作</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>使用CursorLoader来替换之前TestContentResolver代码中的showResult() 方法</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> Loader&lt;<span class="keyword">Cursor</span>&gt; onCreateLoader(<span class="type">int</span> id, Bundle args) &#123;</span><br><span class="line">	CursorLoader loader = <span class="built_in">new</span> CursorLoader(this, </span><br><span class="line">	CONTENT_URI, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">	<span class="keyword">return</span> loader;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoadFinished(Loader&lt;<span class="keyword">Cursor</span>&gt; loader, <span class="keyword">Cursor</span> c) &#123;</span><br><span class="line">	………….</span><br><span class="line">	<span class="keyword">while</span> (c.moveToNext()) &#123;</span><br><span class="line">        <span class="type">name</span> = c.getString(c.getColumnIndex(USERNAME));</span><br><span class="line">        pwd = c.getString(c.getColumnIndex(<span class="keyword">PASSWORD</span>));</span><br><span class="line">        sb.append(<span class="type">name</span> + &quot;    &quot; + pwd + &quot;\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">	mShowResultTv.setText(sb.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoaderReset(Loader&lt;<span class="keyword">Cursor</span>&gt; arg0) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> String <span class="title function_">showResult</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Cursor</span> <span class="variable">c</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">while</span> (c.moveToNext()) &#123;</span><br><span class="line">        name = c.getString(c.getColumnIndex(USERNAME));</span><br><span class="line">        pwd = c.getString(c.getColumnIndex(PASSWORD));</span><br><span class="line">        sb.append(name + <span class="string">&quot;    &quot;</span> + pwd + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    c.close();</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="数据交换形式-XML-JSON"><a href="#数据交换形式-XML-JSON" class="headerlink" title="数据交换形式 XML JSON"></a>数据交换形式 XML JSON</h4><h5 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h5><h6 id="使用XmlSerializer创建一个XML文件"><a href="#使用XmlSerializer创建一个XML文件" class="headerlink" title="使用XmlSerializer创建一个XML文件"></a>使用XmlSerializer创建一个XML文件</h6><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">XmlSerializer xml = <span class="module-access"><span class="module"><span class="identifier">Xml</span>.</span></span><span class="keyword">new</span><span class="constructor">Serializer()</span>;</span><br><span class="line">File file = <span class="keyword">new</span> <span class="constructor">File(Environment.<span class="params">getExternalStorageDirectory</span>()</span>,<span class="string">&quot;xmlfile.xml&quot;</span>);</span><br><span class="line">FileOutputStream fos= <span class="keyword">new</span> <span class="constructor">FileOutputStream(<span class="params">file</span>)</span>;</span><br><span class="line">xml.set<span class="constructor">Output(<span class="params">fos</span>,<span class="string">&quot;utf-8&quot;</span>)</span>;</span><br><span class="line">xml.start<span class="constructor">Document(<span class="string">&quot;utf-8&quot;</span>,<span class="params">true</span>)</span>;</span><br><span class="line">xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;register&quot;</span>)</span>;</span><br><span class="line"><span class="keyword">for</span>(UserBean user:<span class="built_in">list</span>)&#123;</span><br><span class="line">	xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;user&quot;</span>)</span>;</span><br><span class="line">	xml.attribute(null,<span class="string">&quot;id&quot;</span>,user.get<span class="constructor">Id()</span>+<span class="string">&quot;&quot;</span>);</span><br><span class="line">	xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;name&quot;</span>)</span>;</span><br><span class="line">	xml.text(user.get<span class="constructor">Name()</span>);</span><br><span class="line">	xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;name&quot;</span>)</span>;</span><br><span class="line">				</span><br><span class="line">	xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;password&quot;</span>)</span>;</span><br><span class="line">	xml.text(user.get<span class="constructor">Password()</span>);</span><br><span class="line">	xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;password&quot;</span>)</span>;</span><br><span class="line">	xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;user&quot;</span>)</span>;</span><br><span class="line">&#125;xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>,<span class="string">&quot;register&quot;</span>)</span>;</span><br><span class="line">xml.<span class="keyword">end</span><span class="constructor">Document()</span>;</span><br><span class="line">fos.close<span class="literal">()</span>;</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(<span class="params">getApplicationContext</span>()</span>,<span class="string">&quot;创建成功&quot;</span>, <span class="number">0</span>).show<span class="literal">()</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="使用XmlPushParser来解析一个SD卡中的Xml文件"><a href="#使用XmlPushParser来解析一个SD卡中的Xml文件" class="headerlink" title="使用XmlPushParser来解析一个SD卡中的Xml文件"></a>使用XmlPushParser来解析一个SD卡中的Xml文件</h6><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">XmlPullParser xml = <span class="module-access"><span class="module"><span class="identifier">Xml</span>.</span></span><span class="keyword">new</span><span class="constructor">PullParser()</span>;</span><br><span class="line">File file = <span class="keyword">new</span> <span class="constructor">File(Environment.<span class="params">getExternalStorageDirectory</span>()</span>,<span class="string">&quot;xmlfile.xml&quot;</span>);</span><br><span class="line">FileInputStream fis;</span><br><span class="line">fis = <span class="keyword">new</span> <span class="constructor">FileInputStream(<span class="params">file</span>)</span>;</span><br><span class="line">xml.set<span class="constructor">Input(<span class="params">fis</span>, <span class="string">&quot;utf-8&quot;</span>)</span>;</span><br><span class="line"><span class="built_in">int</span> <span class="keyword">type</span> = xml.get<span class="constructor">EventType()</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">type</span> != XmlPullParser.END_DOCUMENT) &#123;</span><br><span class="line">	switch (<span class="keyword">type</span>) &#123;</span><br><span class="line">		case XmlPullParser.START_TAG: &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="string">&quot;register&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;<span class="comment">// 如果遇到整个文档的开头那么创建一个链表</span></span><br><span class="line">			<span class="built_in">list</span> = <span class="keyword">new</span> ArrayList&lt;UserBean&gt;<span class="literal">()</span>;						&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;user&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;</span><br><span class="line">			user = <span class="keyword">new</span> <span class="constructor">UserBean()</span>;<span class="comment">// 如果遇到一个大项则创建一个UserBean</span></span><br><span class="line">			user.set<span class="constructor">Id(Integer.<span class="params">parseInt</span>(<span class="params">xml</span>.<span class="params">getAttributeValue</span>(0)</span>));</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;name&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;</span><br><span class="line">			user.set<span class="constructor">Name(<span class="params">xml</span>.<span class="params">nextText</span>()</span>);						</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;password&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;							</span><br><span class="line">            user.set<span class="constructor">Password(<span class="params">xml</span>.<span class="params">nextText</span>()</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		&#125;break;</span><br><span class="line">		case XmlPullParser.END_TAG: &#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="string">&quot;user&quot;</span>.equals(xml.get<span class="constructor">Name()</span>))&#123;<span class="built_in">list</span>.add(user);user = null;&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		default:break;</span><br><span class="line">		&#125;</span><br><span class="line">	 <span class="keyword">type</span> = xml.next<span class="literal">()</span>;</span><br><span class="line">&#125;</span><br><span class="line">fis.close<span class="literal">()</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="使用XmlResourceParser解析xml文件夹下的Xml文件"><a href="#使用XmlResourceParser解析xml文件夹下的Xml文件" class="headerlink" title="使用XmlResourceParser解析xml文件夹下的Xml文件"></a>使用XmlResourceParser解析xml文件夹下的Xml文件</h6><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">XmlResourceParser <span class="type">xml</span> = getResources().getXml(R.xml.xmlfile);</span><br><span class="line"><span class="type">int</span> <span class="keyword">type</span>;</span><br><span class="line"><span class="keyword">type</span> = <span class="type">xml</span>.getEventType();</span><br><span class="line"><span class="keyword">while</span>(<span class="keyword">type</span>!=XmlResourceParser.END_DOCUMENT)&#123;</span><br><span class="line">	switch (<span class="keyword">type</span>) &#123;</span><br><span class="line">		<span class="keyword">case</span> XmlResourceParser.START_TAG:&#123;</span><br><span class="line">			<span class="keyword">if</span>(&quot;register&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				list = <span class="built_in">new</span> ArrayList&lt;UserBean&gt;();</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(&quot;user&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				<span class="keyword">user</span> = <span class="built_in">new</span> UserBean();</span><br><span class="line">				<span class="keyword">user</span>.setId(<span class="type">Integer</span>.parseInt(<span class="type">xml</span>.getAttributeValue(<span class="number">0</span>)));</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(&quot;name&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				<span class="keyword">user</span>.setName(<span class="type">xml</span>.nextText());</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(&quot;password&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				<span class="keyword">user</span>.setPassword(<span class="type">xml</span>.nextText());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;break;</span><br><span class="line">						</span><br><span class="line">		<span class="keyword">case</span> XmlResourceParser.END_TAG:&#123;</span><br><span class="line">			<span class="keyword">if</span>(&quot;user&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				list.<span class="keyword">add</span>(<span class="keyword">user</span>);</span><br><span class="line">				<span class="keyword">user</span> = <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">default</span>:break;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">type</span> = <span class="type">xml</span>.next();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h5><p>JSON: (JavaScript Object Notation )  JavaScript对象表示法,它是存储和交换文本信息的语法，类似XML,但是JSON比XML 更小、更快，更易解析，它具有如下特点:<br>1.它是轻量级的文本数据交换格式<br>2.它独立于语言和平台</p>
<p>JSON的具体语法以及使用可以查看JSON中国网站：<br><a target="_blank" rel="noopener" href="http://www.json.org.cn/">http://www.json.org.cn/</a></p>
<p>下面是来自JSON中国网站上的JSON格式文本的一个例子:<br>该部分学习通过创建和解析这个JSON格式文本来学习在Android中JSON的使用。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JSON中国&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.json.org.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;page&quot;</span><span class="punctuation">:</span> <span class="number">88</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;isNonProfit&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;street&quot;</span><span class="punctuation">:</span> <span class="string">&quot;浙大路38号.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="string">&quot;浙江杭州&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;country&quot;</span><span class="punctuation">:</span> <span class="string">&quot;中国&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Google&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.google.com&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Baidu&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.baidu.com&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SoSo&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.SoSo.com&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="Android-JSON解析常用的类"><a href="#Android-JSON解析常用的类" class="headerlink" title="Android JSON解析常用的类"></a>Android JSON解析常用的类</h6><p>Android的json解析部分都在包org.json下，主要有以下几个类： </p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">JSON</span><span class="built_in">Object</span>：<span class="title class_">JSON</span>对象,其包含一对(<span class="title class_">Key</span>/<span class="title class_">Value</span>)数值。最外被大括号包裹，其中的<span class="title class_">Key</span>和<span class="title class_">Value</span>被冒号<span class="string">&quot;:&quot;</span>分隔。在<span class="title class_">Key</span>和<span class="title class_">Value</span>之间是以逗号<span class="string">&quot;,&quot;</span>分隔。例如：&#123;<span class="string">&quot;JSON&quot;</span>: <span class="string">&quot;Hello, World&quot;</span>&#125;， <span class="title class_">Value</span>的类型包括：<span class="title class_">Boolean</span>、<span class="title class_">JSON</span><span class="built_in">Array</span>、<span class="title class_">JSON</span><span class="built_in">Object</span>、<span class="title class_">Number</span>、<span class="title class_">String</span>或者默认值<span class="title class_">JSON</span><span class="built_in">Object</span>.<span class="property">NULL</span>。</span><br><span class="line"><span class="title class_">JSON</span>Stringer：<span class="title class_">JSON</span>文本构建类 ，这个类可以帮助快速和便捷的创建<span class="title class_">JSON</span> text。其最大的优点在于可以减少由于格式的错误导致程序异常，引用这个类可以自动严格按照<span class="title class_">JSON</span>语法规则创建<span class="title class_">JSON</span> text。每个<span class="title class_">JSON</span>Stringer实体只能对应创建一个<span class="title class_">JSON</span> text。.</span><br><span class="line"><span class="title class_">JSON</span><span class="built_in">Array</span>：它代表一组有序的数值。数值以逗号”,”分隔（例如 [value1,value2,value3]。它的内部具有查询行为，<span class="title function_">get</span>()和<span class="title function_">opt</span>()两种方法都可以通过index索引返回指定的数值，<span class="title function_">put</span>()方法用来添加或者替换数值。同样这个类的value类型可以包括：<span class="title class_">Boolean</span>、<span class="title class_">JSON</span><span class="built_in">Array</span>、<span class="title class_">JSON</span><span class="built_in">Object</span>、<span class="title class_">Number</span>、<span class="title class_">String</span>或者默认值<span class="title class_">JSON</span><span class="built_in">Object</span>.<span class="property">NULL</span> <span class="built_in">object</span>。</span><br><span class="line"><span class="title class_">JSON</span>Tokener：<span class="title class_">Json</span>解析类 </span><br><span class="line"><span class="title class_">JSON</span>Exception：<span class="title class_">Json</span>用到的异常类 </span><br></pre></td></tr></table></figure>
<h6 id="创建JSON文件"><a href="#创建JSON文件" class="headerlink" title="创建JSON文件"></a>创建JSON文件</h6><p>下面为在SD卡根目录下使用JSONObject, JSONArray来创建上面提到的JSON文件的主要源码：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">File jsonFile = <span class="keyword">new</span> <span class="constructor">File(Environment.<span class="params">getExternalStorageDirectory</span>()</span>,<span class="string">&quot;json.txt&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!jsonFile.exists<span class="literal">()</span>) &#123;</span><br><span class="line">    jsonFile.create<span class="constructor">NewFile()</span>;</span><br><span class="line">    JSONObject jsonRoot = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line"></span><br><span class="line">    jsonRoot.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;JSON中国&quot;</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;url&quot;</span>,<span class="string">&quot;http://www.json.org.cn&quot;</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;page&quot;</span>, <span class="number">88</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;isNonProfit&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    JSONObject address = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    address.put(<span class="string">&quot;street&quot;</span>, <span class="string">&quot;浙大路38号&quot;</span>);</span><br><span class="line">    address.put(<span class="string">&quot;city&quot;</span>, <span class="string">&quot;浙江杭州&quot;</span>);</span><br><span class="line">    address.put(<span class="string">&quot;country&quot;</span>, <span class="string">&quot;中国&quot;</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;address&quot;</span>, address);</span><br><span class="line"></span><br><span class="line">    JSONArray <span class="built_in">array</span> = <span class="keyword">new</span> <span class="constructor">JSONArray()</span>;</span><br><span class="line">    JSONObject gooleWebsite = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    gooleWebsite.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Google&quot;</span>);</span><br><span class="line">    gooleWebsite.put(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;http://www.google.com&quot;</span>);</span><br><span class="line">    <span class="built_in">array</span>.put(gooleWebsite);</span><br><span class="line"></span><br><span class="line">    JSONObject baiduWebsite = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    baiduWebsite.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Baidu&quot;</span>);</span><br><span class="line">    baiduWebsite.put(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;http://www.baidu.com&quot;</span>);</span><br><span class="line">    <span class="built_in">array</span>.put(baiduWebsite);</span><br><span class="line"></span><br><span class="line">    JSONObject sosoWebsite = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    sosoWebsite.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;SoSo&quot;</span>);</span><br><span class="line">    sosoWebsite.put(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;http://www.SoSo.com&quot;</span>);</span><br><span class="line">    <span class="built_in">array</span>.put(sosoWebsite);</span><br><span class="line"></span><br><span class="line">    jsonRoot.put(<span class="string">&quot;links&quot;</span>, <span class="built_in">array</span>);</span><br><span class="line"></span><br><span class="line">    FileOutputStream out = <span class="keyword">new</span> <span class="constructor">FileOutputStream(<span class="params">jsonFile</span>)</span>;</span><br><span class="line">    OutputStreamWriter writer = <span class="keyword">new</span> <span class="constructor">OutputStreamWriter(<span class="params">out</span>)</span>;</span><br><span class="line">    BufferedWriter bw = <span class="keyword">new</span> <span class="constructor">BufferedWriter(<span class="params">writer</span>)</span>;</span><br><span class="line">    bw.write(jsonRoot.<span class="keyword">to</span><span class="constructor">String()</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="解析JSON格式的文件"><a href="#解析JSON格式的文件" class="headerlink" title="解析JSON格式的文件"></a>解析JSON格式的文件</h6><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">InputStreamReader reader = <span class="keyword">new</span> <span class="constructor">InputStreamReader(<span class="params">new</span> FileInputStream(<span class="params">jsonFiles</span>)</span>);</span><br><span class="line">BufferedReader br = <span class="keyword">new</span> <span class="constructor">BufferedReader(<span class="params">reader</span>)</span>;</span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> <span class="constructor">StringBuilder()</span>;</span><br><span class="line">String line = null;</span><br><span class="line"><span class="keyword">while</span>((line = br.read<span class="constructor">Line()</span>)!=null)&#123;</span><br><span class="line">    sb.append(line+<span class="character">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">JSONObject jsonsroot = <span class="keyword">new</span> <span class="constructor">JSONObject(<span class="params">sb</span>.<span class="params">toString</span>()</span>);</span><br><span class="line">String name = jsonsroot.get<span class="constructor">String(<span class="string">&quot;name&quot;</span>)</span>;</span><br><span class="line">String url = jsonsroot.get<span class="constructor">String(<span class="string">&quot;url&quot;</span>)</span>;</span><br><span class="line"><span class="built_in">int</span> page = jsonsroot.get<span class="constructor">Int(<span class="string">&quot;page&quot;</span>)</span>;</span><br><span class="line">Boolean isNonProfit = jsonsroot.get<span class="constructor">Boolean(<span class="string">&quot;isNonProfit&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">JSONObject address = jsonsroot.get<span class="constructor">JSONObject(<span class="string">&quot;address&quot;</span>)</span>;</span><br><span class="line">String street = address.get<span class="constructor">String(<span class="string">&quot;street&quot;</span>)</span>; </span><br><span class="line">String city = address.get<span class="constructor">String(<span class="string">&quot;city&quot;</span>)</span>; </span><br><span class="line">String country = address.get<span class="constructor">String(<span class="string">&quot;country&quot;</span>)</span>; </span><br><span class="line"></span><br><span class="line">JSONArray links = jsonsroot.get<span class="constructor">JSONArray(<span class="string">&quot;links&quot;</span>)</span>;</span><br><span class="line">Links linkArray<span class="literal">[]</span> = <span class="keyword">new</span> Links<span class="literal">[<span class="identifier">links</span>.<span class="identifier">length</span>()]</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> looper=<span class="number">0</span>;looper&lt;links.length<span class="literal">()</span>;looper++)&#123;</span><br><span class="line">    JSONObject Obj = links.get<span class="constructor">JSONObject(<span class="params">looper</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    linkArray<span class="literal">[<span class="identifier">looper</span>]</span> = <span class="keyword">new</span> <span class="constructor">Links()</span>;</span><br><span class="line">    linkArray<span class="literal">[<span class="identifier">looper</span>]</span>.set<span class="constructor">Name(Obj.<span class="params">getString</span>(<span class="string">&quot;name&quot;</span>)</span>);</span><br><span class="line">    linkArray<span class="literal">[<span class="identifier">looper</span>]</span>.set<span class="constructor">Url(Obj.<span class="params">getString</span>(<span class="string">&quot;url&quot;</span>)</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String result = <span class="string">&quot;name:&quot;</span>+name+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;url:&quot;</span>+url+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;page:&quot;</span>+page+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;isNonProfit:&quot;</span>+isNonProfit+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;street:&quot;</span>+street+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;city:&quot;</span>+city+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;country:&quot;</span>+country+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;linkArray[0].name:&quot;</span>+linkArray<span class="literal">[<span class="number">0</span>]</span>.get<span class="constructor">Name()</span>+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;linkArray[0].url:&quot;</span>+linkArray<span class="literal">[<span class="number">0</span>]</span>.get<span class="constructor">Url()</span>+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;linkArray[1].name:&quot;</span>+linkArray<span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">Name()</span>+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;linkArray[1].url:&quot;</span>+linkArray<span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">Url()</span>+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;linkArray[2].name:&quot;</span>+linkArray<span class="literal">[<span class="number">2</span>]</span>.get<span class="constructor">Name()</span>+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;linkArray[2].url:&quot;</span>+linkArray<span class="literal">[<span class="number">2</span>]</span>.get<span class="constructor">Url()</span>+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        ;</span><br><span class="line">mShowJsonTv.set<span class="constructor">Text(<span class="params">result</span>)</span>;</span><br></pre></td></tr></table></figure>

























        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/31/Android-初步之数据存储/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/31/Android-初步之数据存储/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/30/Android-初步之资源的使用/" title="Android 初步之资源的使用" itemprop="url">Android 初步之资源的使用</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-30T13:16:04.000Z" itemprop="datePublished"> Published 2016-03-30</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="为什么要将资源独立出来"><a href="#为什么要将资源独立出来" class="headerlink" title="为什么要将资源独立出来"></a>为什么要将资源独立出来</h4><p>编写良好的代码往往在程序中调用它的资源，而不是直接将其写入代码中，这样做的好处是：</p>
<ol>
<li>将应用程序资源存储于某个特定的位置更有利于管理他们，而且使得代码更容易阅读与管理。</li>
<li>类似字符串这样的外部资源能使得应用程序更容易根据不同的地区和语言来进行本地化处理。</li>
<li>不同的资源对于不同的设备而言是很必要的。</li>
</ol>
<h4 id="资源在Android工程资源目录中的存储方式"><a href="#资源在Android工程资源目录中的存储方式" class="headerlink" title="资源在Android工程资源目录中的存储方式"></a>资源在Android工程资源目录中的存储方式</h4><p><img src="/2016/03/30/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E8%B5%84%E6%BA%90%E7%9A%84%E4%BD%BF%E7%94%A8/1.png"><br><img src="/2016/03/30/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E8%B5%84%E6%BA%90%E7%9A%84%E4%BD%BF%E7%94%A8/2.png"></p>
<h4 id="字符串资源"><a href="#字符串资源" class="headerlink" title="字符串资源"></a>字符串资源</h4><ul>
<li>基本字符串</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">&lt;<span class="built_in">string</span> <span class="built_in">name</span>=<span class="string">&quot;header&quot;</span>&gt;Android简介&lt;/<span class="built_in">string</span>&gt;</span><br><span class="line">&lt;<span class="built_in">string</span> <span class="built_in">name</span>=<span class="string">&quot;content&quot;</span>&gt;Android是由安迪.鲁宾开发出来的一款移动操作系统，而后由Google公司收购&lt;/<span class="built_in">string</span>&gt;</span><br><span class="line">&lt;<span class="built_in">string</span> <span class="built_in">name</span>=<span class="string">&quot;footer&quot;</span>&gt;由xiaohai.lin编辑&lt;/<span class="built_in">string</span>&gt;</span><br></pre></td></tr></table></figure>
<p>当字符串包含撇号或单引号的时候需要进行转义或者使用双引号括起来，如果包含双引号那么则需使用转义符号来转义。<br>对于字符串资源，可以为其添加3种具有HTML风格的属性，分别是加粗，斜体和下划线，可以使用</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>,<span class="tag">&lt;<span class="name">i</span>&gt;</span><span class="tag">&lt;<span class="name">u</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>标记来指定这些风格。</p>
<ul>
<li>格式化字符串资源</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">&lt;<span class="built_in">string</span> name=<span class="string">&quot;demo_string3&quot;</span>&gt;The <span class="keyword">match</span> is %<span class="number">1</span>$d : %<span class="number">2</span>$d Jimmy &amp;lt;b&amp;gt;%<span class="number">3</span>$s&amp;lt;/b&amp;gt; the game &lt;/<span class="built_in">string</span>&gt;</span><br><span class="line">tv = (TextView) find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">stringWithFormat</span>)</span>;</span><br><span class="line">String matchInfo = get<span class="constructor">Resources()</span>.get<span class="constructor">String(R.<span class="params">string</span>.<span class="params">demo_string3</span>)</span>;</span><br><span class="line">String escapeStr = <span class="module-access"><span class="module"><span class="identifier">TextUtils</span>.</span></span>html<span class="constructor">Encode(<span class="string">&quot;Won&quot;</span>)</span>;</span><br><span class="line">String finalStr = <span class="module-access"><span class="module"><span class="identifier">String</span>.</span></span>format(matchInfo, <span class="number">5</span>,<span class="number">2</span>,escapeStr);</span><br><span class="line">CharSequence result = <span class="module-access"><span class="module"><span class="identifier">Html</span>.</span></span>from<span class="constructor">Html(<span class="params">finalStr</span>)</span>;</span><br><span class="line">tv.set<span class="constructor">Text(<span class="params">result</span>)</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>复数字符串资源</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">&lt;plurals<span class="built_in"> name</span> = <span class="string">&quot;unicorn&quot;</span>&gt;</span><br><span class="line">    &lt;<span class="type">item</span> quantity = <span class="string">&quot;one&quot;</span>&gt;One <span class="type">item</span> &lt;/<span class="type">item</span>&gt;</span><br><span class="line">    &lt;<span class="type">item</span> quantity = <span class="string">&quot;other&quot;</span>&gt;<span class="meta">%d</span> items &lt;/<span class="type">item</span>&gt;</span><br><span class="line">&lt;/plurals&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">String unicon = get<span class="constructor">Resources()</span>.get<span class="constructor">QuantityString(R.<span class="params">plurals</span>.<span class="params">unicorn</span>,<span class="params">unicorn</span>,<span class="params">unicorn</span>)</span>;</span><br></pre></td></tr></table></figure>


<p>在XML中使用</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">string</span>/content</span><br></pre></td></tr></table></figure>
<p>在java代码中</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">String strings = get<span class="constructor">Resources()</span>.get<span class="constructor">String(R.<span class="params">string</span>.<span class="params">content</span>)</span>返回的是字符串内容本身，所有的HTML格式均被删除</span><br><span class="line">CharSequence texts = get<span class="constructor">Resources()</span>.get<span class="constructor">Text(R.<span class="params">string</span>.<span class="params">content</span>)</span>;返回的是带格式的内容</span><br></pre></td></tr></table></figure>

<h4 id="颜色资源"><a href="#颜色资源" class="headerlink" title="颜色资源"></a>颜色资源</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;red&quot;</span>&gt;</span>#ff0000<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;green&quot;</span>&gt;</span>#00ff00<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>#0000ff<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    注意#aarrggbb中的aa表示透明度0表示完全透明，F表示完全不透明</span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在XML中使用</p>
<figure class="highlight processing"><table><tr><td class="code"><pre><span class="line"><span class="type">color</span>/<span class="built_in">red</span></span><br></pre></td></tr></table></figure>
<p>在java代码中</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">getResources</span><span class="params">()</span></span><span class="selector-class">.getColor</span>(R<span class="selector-class">.color</span>.color1)</span><br></pre></td></tr></table></figure>

<h4 id="尺寸资源"><a href="#尺寸资源" class="headerlink" title="尺寸资源"></a>尺寸资源</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dimen</span> <span class="attr">name</span>=<span class="string">&quot;header&quot;</span>&gt;</span>20px<span class="tag">&lt;/<span class="name">dimen</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dimen</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span>&gt;</span>18px<span class="tag">&lt;/<span class="name">dimen</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dimen</span> <span class="attr">name</span>=<span class="string">&quot;footer&quot;</span>&gt;</span>10px<span class="tag">&lt;/<span class="name">dimen</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在XML中使用</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;@dimen/header“</span></span><br></pre></td></tr></table></figure>
<p>在java代码中</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">getResources</span><span class="params">()</span></span><span class="selector-class">.getDimension</span>(R<span class="selector-class">.dimen</span>.<span class="attribute">content</span>)</span><br></pre></td></tr></table></figure>

<p>px:  对应屏幕上的每一个点<br>In：每英寸等于2.54cm<br>Pt: 磅  1&#x2F;72厘米<br>Dp：一种基于屏幕密度的抽象单位，每英寸160点的显示器，1dp&#x3D;1px<br>Sp：主要处理字体大小，可以根据用户字体大小首选项进行缩放<br>mm: 毫米</p>
<h4 id="数组资源"><a href="#数组资源" class="headerlink" title="数组资源"></a>数组资源</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string-array</span> <span class="attr">name</span>=<span class="string">&quot;contract&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span>&gt;</span>项目1<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span>&gt;</span>项目2<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">string-array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在XML中使用</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">android:entries=<span class="string">&quot;@array/contract“</span></span><br></pre></td></tr></table></figure>
<p>在java代码中</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">getResources</span><span class="params">()</span></span><span class="selector-class">.getStringArray</span>(R<span class="selector-class">.array</span>.contract)</span><br></pre></td></tr></table></figure>
<p>共有三类</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&lt;<span class="built_in">array</span>&gt;普通的数组</span><br><span class="line">&lt;<span class="built_in">string</span>-<span class="built_in">array</span>&gt;字符数组</span><br><span class="line">&lt;<span class="built_in">int</span>eger-<span class="built_in">array</span>&gt;整形数组</span><br></pre></td></tr></table></figure>
<h4 id="图片资源"><a href="#图片资源" class="headerlink" title="图片资源"></a>图片资源</h4><p>在Java代码中使用:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">ImageView</span>.</span></span>set<span class="constructor">ImageResources(R.<span class="params">drawable</span>.<span class="params">head</span>)</span>;</span><br></pre></td></tr></table></figure>

<p>XML代码中使用</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="meta">@drawable</span>/head</span><br></pre></td></tr></table></figure>

<h4 id="样式资源"><a href="#样式资源" class="headerlink" title="样式资源"></a>样式资源</h4><p>在res目录下的value下的style.xml下建立如下资源</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;basic&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:textSize&quot;</span>&gt;</span>58px<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:textColor&quot;</span>&gt;</span>#f60<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;textStyle&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;basic&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:gravity&quot;</span>&gt;</span>center<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用如下：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">    android:<span class="attribute">layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span><br><span class="line">    android:<span class="attribute">layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span><br><span class="line">    android:<span class="attribute">text</span>=<span class="string">&quot;@string/hello_world&quot;</span> </span><br><span class="line">    <span class="attribute">style</span>=<span class="string">&quot;@style/textStyle&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>



<h4 id="布局资源"><a href="#布局资源" class="headerlink" title="布局资源"></a>布局资源</h4><p>Java代码中:</p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line">R.<span class="keyword">layout</span>.文件名</span><br></pre></td></tr></table></figure>

<p>XML代码中：</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="meta">@layout</span>/文件名</span><br></pre></td></tr></table></figure>

<h4 id="主题资源"><a href="#主题资源" class="headerlink" title="主题资源"></a>主题资源</h4><p>主题资源与样式资源类似，定义主题资源的资源文件也是保存在res&#x2F;values目录下，其根元素同样是<resources>在该标记中也是使用<style>标记定义主题，所不同的是，主题资源不能作用域单个的View组件，而是对所有或者单个Activity起作用，<br>主题资源定义完成后就可以使用了：<br>在AndroidManifest.xml文件中使用主题资源<br>只需要使用android:theme属性指定要使用的资源即可<br>android:theme&#x3D;“@style&#x2F;bg”<br>如果要在整个应用中使用该主题可以在application 标记中使用theme属性<br>如果要在单个Activity中使用该主题可以在activitiy中使用</p>
<p>Java文件中使用主题样式<br>在Activity的onCreate方法中，设置使用的主题资源时候，一定要在为该Activity设置布局内容前设置也就是在setContentView方法之前使用.</p>
<h4 id="使用原始文件"><a href="#使用原始文件" class="headerlink" title="使用原始文件"></a>使用原始文件</h4><p>应用程序还可以使用原始文件作为资源进行使用，一般在开发中我们会将一些音频，视频，和一些不被aapt支持的格式文件作为原始文件资源放在&#x2F;res&#x2F;raw目录下</p>
<h4 id="使用系统资源"><a href="#使用系统资源" class="headerlink" title="使用系统资源"></a>使用系统资源</h4><p>除了使用上述提到的我们自己定义的资源，还可以使用Android系统提供的系统资源，要使用这些系统资源可以按照如下方式使用：</p>
<p>Java 模式</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">android<span class="selector-class">.R</span>.XXXXX</span><br></pre></td></tr></table></figure>

<p>XML 模式</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="variable">@android:</span>color/XXXXX</span><br></pre></td></tr></table></figure>

<h4 id="使用当前主题中的样式"><a href="#使用当前主题中的样式" class="headerlink" title="使用当前主题中的样式"></a>使用当前主题中的样式</h4><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">?a</span><span class="symbol">ndroid:</span>textColor</span><br></pre></td></tr></table></figure></style></resources></p>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/30/Android-初步之资源的使用/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/30/Android-初步之资源的使用/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/29/Android-初步之布局管理/" title="Android 初步之布局管理" itemprop="url">Android 初步之布局管理</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-29T13:14:59.000Z" itemprop="datePublished"> Published 2016-03-29</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="View-与-ViewGroup"><a href="#View-与-ViewGroup" class="headerlink" title="View 与 ViewGroup"></a>View 与 ViewGroup</h4><p><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/1.png"><br>Android中的所有可视化组件都是从View派生出来的，这些可视化组件通常被称为控件或者小组件，ViewGroup类是对View类的扩展，它用来包含多个视图，ViewGroup主要用于管理子视图布局和创建可重用的复合组件。</p>
<h4 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h4><p><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/2.png"></p>
<h4 id="LinearLayout"><a href="#LinearLayout" class="headerlink" title="LinearLayout"></a>LinearLayout</h4><p>按照垂直方向或者水平方向对齐每个视图<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/3.png"></p>
<h4 id="RelativeLayout"><a href="#RelativeLayout" class="headerlink" title="RelativeLayout"></a>RelativeLayout</h4><p>相对于指定控件位置的设定项<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/4.png"></p>
<h4 id="FrameLayout"><a href="#FrameLayout" class="headerlink" title="FrameLayout"></a>FrameLayout</h4><p>所有添加到这个布局中的视图都以类似堆栈的方式显示。第一个添加的控件被放在最底层，最后一个添加到框架布局中的视图显示在最顶层，上一层的控件会覆盖下一层的控件。布局中所有的控件都会默认出现在视图的左上角<br>如下所示:</p>
<p><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/5.png"></p>
<h4 id="AbsoluteLayout"><a href="#AbsoluteLayout" class="headerlink" title="AbsoluteLayout"></a>AbsoluteLayout</h4><p>只有两个属性，不大常用 </p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">android:</span>layout_x</span><br><span class="line"><span class="symbol">android:</span>layout_y</span><br></pre></td></tr></table></figure>
<h4 id="TableLayout"><a href="#TableLayout" class="headerlink" title="TableLayout"></a>TableLayout</h4><p>TableLayout布局由许多的TableRow组成，列是由行中的控件数目决定的。<br>TableLayout布局不会显示行、列 、单元格的边框线。下面是TableLayout的几个重要属性:<br>android:stretchColumns&#x3D;“0,2“   &#x2F;&#x2F;结果如下所示，第一列和第三列的控件将会尽量扩充<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/7.png"><br>未指定android:shrinkColumns属性的时候(将按键3挤出了界面)<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/8.png"><br>指定android:shrinkColumns&#x3D;“1”属性的时候(相当于自动换行)<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/9.png"><br>指定android:collapseColumns属性的时候会隐藏指定列<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/10.png"><br>android:layout_column&#x3D;“2“              &#x2F;&#x2F;子组件从第2列开始<br>android:layout_span&#x3D;“2“	             &#x2F;&#x2F;子组件横跨2列<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/11.png"></p>
<h4 id="TabLayout"><a href="#TabLayout" class="headerlink" title="TabLayout"></a>TabLayout</h4><p>为了使用Tab，必须使用TabHost和TabWidget，TabHost必须是布局文件中的根节点，它包含了tabWidget显示tabs，以及FrameLayout来显示tab的内容。<br><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/12.png"><br>主布局</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TabHost</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span> =<span class="string">&quot;@android:id/tabhost&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TabWidget</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span> =<span class="string">&quot;@android:id/tabs&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">TabWidget</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span> =<span class="string">&quot;@android:id/tabcontent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">TabHost</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Activity1布局</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/android1&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Activity2布局</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/android2&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Activity3布局</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drawable/android3&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> MainActivity extends TabActivity &#123;</span><br><span class="line">    protected void on<span class="constructor">Create(Bundle <span class="params">savedInstanceState</span>)</span> &#123;</span><br><span class="line">        super.on<span class="constructor">Create(<span class="params">savedInstanceState</span>)</span>;</span><br><span class="line">        set<span class="constructor">ContentView(R.<span class="params">layout</span>.<span class="params">activity_main</span>)</span>;</span><br><span class="line">        TabHost tabhost = this.get<span class="constructor">TabHost()</span>;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> <span class="constructor">Intent()</span>;</span><br><span class="line">        intent.set<span class="constructor">Class(<span class="params">this</span>,<span class="params">activity1</span>.<span class="params">class</span>)</span>;</span><br><span class="line">        tabhost.add<span class="constructor">Tab(<span class="params">tabhost</span>.<span class="params">newTabSpec</span>(<span class="string">&quot;Tab1&quot;</span>)</span>.set<span class="constructor">Indicator(<span class="string">&quot;tab1&quot;</span>,<span class="params">getResources</span>()</span>.get<span class="constructor">Drawable(R.<span class="params">drawable</span>.<span class="params">android1</span>)</span>).set<span class="constructor">Content(<span class="params">intent</span>)</span>);</span><br><span class="line">        intent = <span class="keyword">new</span> <span class="constructor">Intent()</span>;</span><br><span class="line">        intent.set<span class="constructor">Class(<span class="params">this</span>,<span class="params">activity2</span>.<span class="params">class</span>)</span>;</span><br><span class="line">        tabhost.add<span class="constructor">Tab(<span class="params">tabhost</span>.<span class="params">newTabSpec</span>(<span class="string">&quot;Tab2&quot;</span>)</span>.set<span class="constructor">Indicator(<span class="string">&quot;tab2&quot;</span>,<span class="params">getResources</span>()</span>.get<span class="constructor">Drawable(R.<span class="params">drawable</span>.<span class="params">android2</span>)</span>).set<span class="constructor">Content(<span class="params">intent</span>)</span>);</span><br><span class="line">        intent = <span class="keyword">new</span> <span class="constructor">Intent()</span>;</span><br><span class="line">        intent.set<span class="constructor">Class(<span class="params">this</span>,<span class="params">activity3</span>.<span class="params">class</span>)</span>;</span><br><span class="line">        tabhost.add<span class="constructor">Tab(<span class="params">tabhost</span>.<span class="params">newTabSpec</span>(<span class="string">&quot;Tab3&quot;</span>)</span>.set<span class="constructor">Indicator(<span class="string">&quot;tab3&quot;</span>,<span class="params">getResources</span>()</span>.get<span class="constructor">Drawable(R.<span class="params">drawable</span>.<span class="params">android3</span>)</span>).set<span class="constructor">Content(<span class="params">intent</span>)</span>);</span><br><span class="line">        tabhost.set<span class="constructor">CurrentTab(1)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="GridLayout"><a href="#GridLayout" class="headerlink" title="GridLayout"></a>GridLayout</h4><p>GridLayout是Android 4.0 SDK中新引进的布局:<br>GridLayout布局使用虚细线将布局划分为行、列和单元格。</p>
<ol>
<li>它与LinearLayout布局一样，也分为水平和垂直两种方式，默认是水平布局，一个控件挨着一个控件从左到右依次排列，通过指定android:columnCount设置列数的属性后，控件会自动换行进行排列。</li>
<li>若要指定某控件显示在固定的行或列，只需设置该子控件的android:layout_row和android:layout_column属性即可.</li>
<li>如果需要设置某控件跨越多行或多列，只需将该子控件的android:layout_rowSpan或者layout_columnSpan属性设置为数值，再设置其layout_gravity属性为fill即可，前一个设置表明该控件跨越的行数或列数，后一个设置表明该控件填满所跨越的整行或整列。</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">GridLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:columnCount</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;90dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_columnSpan</span>=<span class="string">&quot;4&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_gravity</span>=<span class="string">&quot;fill&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:hint</span>=<span class="string">&quot;请用键盘输入运算&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;C&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;/&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;DEL&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;7&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;9&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;-&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;5&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;6&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;+&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;2&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_rowSpan</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;fill_vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;=&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;.&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;+/-&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">GridLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/13.png"></p>
<h4 id="布局的优化"><a href="#布局的优化" class="headerlink" title="布局的优化"></a>布局的优化</h4><ol>
<li><p>使用merge标签:<br>当包含有merge标签的布局被添加到另一个布局的时候，该布局的merge节点会被删除，而该布局的子View将会被直接添加到新的父布局。</p>
</li>
<li><p>使用include标签:<br>Include 标签是用来把一个布局的内容插入到另一个布局中。通过<include>标签可以将一个非常庞大的布局文件分解成若干个较小的布局文件，而且这些小的布局文件也可以被多次引用，从而达到一个重用的目的。</include></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;include android:<span class="built_in">id</span>=“@+<span class="built_in">id</span>/my_actionbar”</span><br><span class="line">	layout=“@layout/actionbar”/&gt;</span><br></pre></td></tr></table></figure>
<p>结合使用merge和include标签能够创建灵活的，可复用的布局定义，而不会创建深度嵌套的布局结构.</p>
</li>
<li><p>View Stub<br>使用<include>提高了复用性，但是带来了另一个问题，就是布局文件中的控件并不一定在程序启动时全都用到，有一些控件只在特定的情况下才会被使用到。填充每个额外的View都需要耗费时间和资源，View的数量越多消耗的时间和资源就越可观，要想在复杂的布局内填充的View的数量最少，可以使用View Stub。<br>ViewStub是一个不可见的，轻量级的View。它没有尺寸，也不会绘制以及以某种形式参与到布局中来。只有显式地调用inflate方法或者setVisibility(View.VISIBLE)的时候，这个View Stub才会填充。下面是View Stub的一个例子，按下”点击显示Stab View”按键后”按键1”，“按键2”会显示出来，局部代码见备注:</include></p>
</li>
</ol>
<p>ViewStub的布局参数会随着加载的视图一同被添加到ViewStub父容器。我们也可以通过使用inflatedId属性来定义或重命名要加载的视图对象的Id值。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> <span class="keyword">implements</span> <span class="title class_">OnClickListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Button</span> <span class="variable">btn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">ViewStub</span> <span class="variable">viewStub</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        btn = (Button) findViewById(R.id.btn);</span><br><span class="line">        btn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">        viewStub = (ViewStub) findViewById(R.id.viewStub);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (viewStub != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">View</span> <span class="variable">anotherlayoutView</span> <span class="operator">=</span> viewStub.inflate();<span class="comment">// inflate()被调用时,</span></span><br><span class="line">            <span class="comment">// 被加载的视图替代viewstub并且返回自己的视图对象</span></span><br><span class="line">            <span class="comment">//anotherlayoutView相当于是包含进来的那个布局文件</span></span><br><span class="line">            anotherlayoutView.findViewById(R.id.btn1).setOnClickListener(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">OnClickListener</span>() &#123;</span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                Log.i(<span class="string">&quot;MainActivity&quot;</span>, <span class="string">&quot;按键1按下:&quot;</span> + v.getId());</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            anotherlayoutView.findViewById(R.id.btn2).setOnClickListener(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">OnClickListener</span>() &#123;</span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                    Log.i(<span class="string">&quot;MainActivity&quot;</span>, <span class="string">&quot;按键2按下:&quot;</span> + v.getId());</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            viewStub = (ViewStub) findViewById(R.id.viewStub);</span><br><span class="line">            <span class="type">View</span> <span class="variable">view</span> <span class="operator">=</span> findViewById(R.id.inflateViewStub);</span><br><span class="line">            Log.i(<span class="string">&quot;MainActivity&quot;</span>, <span class="string">&quot;&quot;</span> + view.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;com.example.testviewstub.MainActivity&quot;</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/btn&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;点击显示Stab View&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ViewStub</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/viewStub&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:inflatedId</span>=<span class="string">&quot;@+id/inflateViewStub&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout</span>=<span class="string">&quot;@layout/anotherlayout&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- inflatedId就是新加载进来的view的id,如果需要获取这个view,就要用这个inflatedId,原来的id已经被取代了--&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上面的例子中通过”viewStub” 可以找到被定义的ViewStub对象。加载布局资源文件”anotherlayout”后， ViewStub对象从其父容器中移除。可以通过id”inflateViewStub”找到由布局资源”anotherlayout”创建的View。这个视图对象最后被指定为宽120dip，高40dip：</p>
<p><img src="/2016/03/29/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86/14.png"></p>
<h4 id="LayoutInflater"><a href="#LayoutInflater" class="headerlink" title="LayoutInflater"></a>LayoutInflater</h4><h5 id="LayoutInflater的作用"><a href="#LayoutInflater的作用" class="headerlink" title="LayoutInflater的作用:"></a>LayoutInflater的作用:</h5><p>LayoutInflater作用是将layout的xml布局文件实例化为View类对象。<br>在一个Activity里如果直接用findViewById()的话,对应的是setConentView()的那个layout里的组件.如果当前Activity里如果用到别的layout,比如对话框上的layout,你还要设置对话框上的layout里的组件(像图片ImageView,文字TextView)上的内容,就必须用inflate()先将对话框上的layout找出来,然后再用这个layout对象去找到它上面的组件,如:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Viewview = <span class="module-access"><span class="module"><span class="identifier">View</span>.</span></span>inflate(this,<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>layout.dialog_layout,null);　　</span><br><span class="line">TextViewdialogTV = (TextView)view.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">dialog_tv</span>)</span>;　　</span><br><span class="line">dialogTV.set<span class="constructor">Text(“你好<span class="string">&quot;);</span></span></span><br></pre></td></tr></table></figure>
<h6 id="获取LayoutInflater的三种方法"><a href="#获取LayoutInflater的三种方法" class="headerlink" title="获取LayoutInflater的三种方法:"></a>获取LayoutInflater的三种方法:</h6><figure class="highlight vhdl"><table><tr><td class="code"><pre><span class="line">LayoutInflater inflater =(LayoutInflater)<span class="keyword">context</span>.getSystemService(<span class="keyword">Context</span>.LAYOUT_INFLATER_SERVICE);</span><br><span class="line"><span class="keyword">View</span>   layout = inflater.inflate(R.layout.main, <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">LayoutInflater</span> <span class="variable">inflater</span> <span class="operator">=</span> LayoutInflater.from(context); </span><br><span class="line"><span class="type">View</span> <span class="variable">layout</span> <span class="operator">=</span> inflater.inflate(R.layout.main, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">LayoutInflater</span> <span class="variable">inflater</span> <span class="operator">=</span> getLayoutInflater();</span><br><span class="line"><span class="type">View</span> <span class="variable">layout</span> <span class="operator">=</span> inflater.inflate(R.layout.main, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
<h5 id="Inflate-方法介绍"><a href="#Inflate-方法介绍" class="headerlink" title="Inflate 方法介绍"></a>Inflate 方法介绍</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> View <span class="title function_">inflate</span><span class="params">(<span class="type">int</span> Resourece,ViewGroup root)</span></span><br></pre></td></tr></table></figure>
<p>作用：从指定的XML资源文件中填充一个新的视图层次结构<br>Resourece：View的layout的ID<br>root： 生成的层次结构的根视图return 填充的层次结构的根视图。如果参数root提供了，那么root就是根视图；否则填充的XML文件的根就是根视图。<br>inflate只会把Layout形成一个以view类实现成的对象，有需要时再用setContentView(view)显示出来</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/29/Android-初步之布局管理/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/29/Android-初步之布局管理/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/28/Android-初步之Android组件-Fragment/" title="Android 初步之Android组件  Fragment" itemprop="url">Android 初步之Android组件  Fragment</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-28T14:27:21.000Z" itemprop="datePublished"> Published 2016-03-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Fragment是Android 3.0 新增加的部分，它的作用是将Activity拆分成多个完全独立封装的可重用的组件，每个组件都有它们的生命周期和UI布局。这样就可以为不同屏幕大小的设备创建动态灵活的UI。<br>一个Fragment必须被嵌入到一个Activity中，它的生命周期被其所属的宿主Acitivity的生命周期所影响。当Acitivity被暂停的时候，其中的所有Fragment被暂停，当Acitivity被销毁的时候，所有隶属于它的Fragment也将被销毁，当Acitivity处于Resumed状态的时候，可以单独得对每个Fragment进行添加或者删除操作。<br>和Activity不同的是Fragment不需要在Android Manifest文件中注册。</p>
<h4 id="创建并添加Fragment"><a href="#创建并添加Fragment" class="headerlink" title="创建并添加Fragment"></a>创建并添加Fragment</h4><p>在layout文件夹下新建一个名为fragment1.xml的布局文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is fragment 1&quot;</span>  /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<p>新建一个fragment2.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is fragment 2&quot;</span>   /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>新建一个类Fragment1，这个类继承自Fragment</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Fragment1</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;  </span><br><span class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container, <span class="type">Bundle</span>   savedInstanceState) &#123;  </span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(<span class="type">R</span>.layout.fragment1, container, <span class="literal">false</span>); </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>新建一个类Fragment2 ：</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Fragment2</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;  </span><br><span class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container, <span class="type">Bundle</span> savedInstanceState) &#123;  </span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(<span class="type">R</span>.layout.fragment2, container, <span class="literal">false</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h4 id="静态创建Fragment"><a href="#静态创建Fragment" class="headerlink" title="静态创建Fragment"></a>静态创建Fragment</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">然后打开或新建activity_main.xml作为主Activity的布局文件，在里面加入两个Fragment的引用，使用android:name前缀来引用具体的Fragment：</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:baselineAligned</span>=<span class="string">&quot;false&quot;</span> &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment1&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.fragmentdemo.Fragment1&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dip&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span> /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment2&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.fragmentdemo.Fragment2&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dip&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span> /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span>  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/1.png"></p>
<h4 id="动态创建Fragment-Fragment-Manager"><a href="#动态创建Fragment-Fragment-Manager" class="headerlink" title="动态创建Fragment Fragment Manager"></a>动态创建Fragment Fragment Manager</h4><p>每个Activity都包含一个Fragment Manager来管理寄生于它的Fragment们，可以通过使用getFragmentManager方法来访问FragmentManger:</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">FragmentManager fragmentManager <span class="operator">=</span> getFragmentManager()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>获得FragmentManager后可以做如下操作:</p>
<ol>
<li>通过findFragmentById()或findFragmentByTag()，获取activity中的Fragment引用。</li>
<li>通过popBackStack()方法，从activity的后退栈中弹出fragment</li>
<li>通过addOnBackStackChangedListerner()注册一个侦听器监视后退栈的变化。</li>
<li>通过beginTransaction()获取FragmentTransaction。</li>
</ol>
<p> <img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/2.png"></p>
<p>Fragment Transaction 用来在Activity内添加，删除替换Fragment，使用Fragment Transaction 可以让布局成为动态。提交一组Fragment的变化叫做一个事务。事务通过FragmentTransaction来执行。还可以把每个事务保存在activity的后退栈中，这样就可以让用户在Fragment变化之间导航.</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">FragmentTransaction fragtransaction <span class="operator">=</span> fragmentManager.beginTransaction()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>添加Fragment</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">fragmentsaction.add(用于存放flagment的容器ID,Fragment对象);</span><br><span class="line"><span class="regexp">//</span>将Fragment对象添加到Fragment容器标签所指定的地方。</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除Fragment</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">Fragment <span class="keyword">fragment</span> = <span class="keyword">fragment</span>Manerger.findFragmentById(Fragment容器ID)；</span><br><span class="line">fragmentsaction.remove(<span class="keyword">fragment</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>替换Fragment</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line">fragmentsaction.<span class="built_in">replace</span>(用于存放flagment的容器ID,Fragment对象);</span><br></pre></td></tr></table></figure></li>
<li><p>当用户想要Back按键会返回到前一个布局，或者想要回滚到前一个已经执行的Transaction可以在调用commit方法前，调用addToBackStack将Fragment添加到back堆栈</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">fragtransaction.add<span class="constructor">ToBackStack(<span class="params">null</span>)</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>设置切换动画</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">transaction.setTransition(FragmentTransaction.TRANSIT_ENTER_MASK);</span><br><span class="line">transaction.setCustomAnimations(enter, <span class="keyword">exit</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>提交事务</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">fragtransaction.commit()<span class="comment">;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>主界面布局</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/main_layout&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  &gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span>  </span><br></pre></td></tr></table></figure>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> MainActivity extends Activity &#123;  </span><br><span class="line">    protected void on<span class="constructor">Create(Bundle <span class="params">savedInstanceState</span>)</span> &#123;  </span><br><span class="line">        super.on<span class="constructor">Create(<span class="params">savedInstanceState</span>)</span>;  </span><br><span class="line">        set<span class="constructor">ContentView(R.<span class="params">layout</span>.<span class="params">activity_main</span>)</span>;  </span><br><span class="line">        Display display = get<span class="constructor">WindowManager()</span>.get<span class="constructor">DefaultDisplay()</span>;  </span><br><span class="line">        <span class="keyword">if</span> (display.get<span class="constructor">Width()</span> &gt; display.get<span class="constructor">Height()</span>) &#123;  </span><br><span class="line">            Fragment1 fragment1 = <span class="keyword">new</span> <span class="constructor">Fragment1()</span>;  </span><br><span class="line">            get<span class="constructor">FragmentManager()</span>.<span class="keyword">begin</span><span class="constructor">Transaction()</span>.replace(<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.main_layout, fragment1).commit<span class="literal">()</span>;  </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            Fragment2 fragment2 = <span class="keyword">new</span> <span class="constructor">Fragment2()</span>;  </span><br><span class="line">           get<span class="constructor">FragmentManager()</span>.<span class="keyword">begin</span><span class="constructor">Transaction()</span>.replace(<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.main_layout, fragment2).commit<span class="literal">()</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<h4 id="Fragment生命周期与Activity生命周期"><a href="#Fragment生命周期与Activity生命周期" class="headerlink" title="Fragment生命周期与Activity生命周期"></a>Fragment生命周期与Activity生命周期</h4><p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/3.png"></p>
<ul>
<li><p>onAttach：当fragment和它的父activity有关联的时候被调用，在此处可以获取Activity的引用。为进一步初始化做准备。</p>
</li>
<li><p>onCreate:调用该方法来进行Fragment的初始化。与Activity不同Fragment UI不在onCreate方法中初始化。</p>
</li>
<li><p>onCreateView:一旦Fragment被创建，要创建它自己的用户界面的时候调用该方法，在里面主要完成创建或者填充Fragment UI的工作，获取它所包含的View的引用以及绑定到该View的数据，创建所需的Server和Timer。</p>
</li>
<li><p>onActivityCreated:一旦父Activity和Fragment的UI创建后，通知fragment  activity已经创建完成，在这个方法中主要完成父Activity被初始化完成或者Fragment的View被完全填充后才能做的事情。要和父Activity的UI交互也要等到这个阶段。</p>
</li>
<li><p>onStart:使fragment对用户可见(基于包含它的activity已经启动了)</p>
</li>
<li><p>onResume:使fragment与用户可进行交互(基于包含它的activity已经处于resume状态)在这个方法中主要工作是恢复所有暂停的Fragment需要的UI更新，线程或进程。这些在非活动状态是处于暂停的。</p>
</li>
<li><p>onPause:fragment不再与用户进行交互，要么由于activity处于暂停态，要么由于在activity中一个fragment的操作正在被修改，需要暂停UI的更新，挂起线程或者暂停那些不需要更新的CPU的集中处理，由于调用这个方法后，进程可能被终止，所以要保存所有的编辑和状态改变信息。</p>
</li>
<li><p>onStop:fragment不再与用户可见，要么因为它的activity被停止，要么因为在activity中一个fragment的操作正在被修改，在这里暂停其余的UI更新，挂起线程或者暂停不需要的处理</p>
</li>
<li><p>onDestroyView: 当Fragment的View被分离的时候调用该方法，这里主要用于清除资源相关的View。</p>
</li>
<li><p>onDestroy: 在整个生命周期结束的时候调用该方法去做fragment状态的最终清理，包括清除所有的资源，包括线程和关闭数据库连接。</p>
</li>
<li><p>onDetach:当fragment与其父activity分离的时候调用该方法。</p>
</li>
</ul>
<p>onPause:fragment不再与用户进行交互，要么由于activity处于暂停态，要么由于在activity中一个fragment的操作正在被修改，需要暂停UI的更新，挂起线程或者暂停那些不需要更新的CPU的集中处理，由于调用这个方法后，进程可能被终止，所以要保存所有的编辑和状态改变信息。<br>onStop:fragment不再与用户可见，要么因为它的activity被停止，要么因为在activity中一个fragment的操作正在被修改，在这里暂停其余的UI更新，挂起线程或者暂停不需要的处理<br>onDestroyView: 当Fragment的View被分离的时候调用该方法，这里主要用于清除资源相关的View。<br>onDestroy: 在整个生命周期结束的时候调用该方法去做fragment状态的最终清理，包括清除所有的资源，包括线程和关闭数据库连接。<br>onDetach:当fragment与其父activity分离的时候调用该方法。</p>
<p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/33.png"></p>
<h4 id="内置的Fragment"><a href="#内置的Fragment" class="headerlink" title="内置的Fragment"></a>内置的Fragment</h4><ul>
<li>DialogFragment<br>对话框式的Fragments。可以把fragmentdialog并入到到activity的返回栈中，使用户能再返回到这个对话框。</li>
<li>ListFragment<br>显示一个列表控件，就像ListActivity类，它提供了很多管理列表的方法，onListItemClick和setListAdapter等。</li>
<li>PreferenceFragment<br>显示一个Preference对象组成的列表，类似PreferenceActivity，主要用来创建设置界面。</li>
</ul>
<h4 id="Fragment之间进行通信"><a href="#Fragment之间进行通信" class="headerlink" title="Fragment之间进行通信"></a>Fragment之间进行通信</h4><p>通常情况下，Activity都会包含多个Fragment，这时会遇到多个Fragment之间如何进行通信的问题。</p>
<p>fragment1.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>    &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fragment1_text&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is fragment 1&quot;</span>  /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span>  </span><br></pre></td></tr></table></figure>
<p>fragment2.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is fragment 2&quot;</span>  /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span>   </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Get fragment1 text&quot;</span>  </span></span><br><span class="line"><span class="tag">        /&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> Fragment2 extends Fragment &#123;  </span><br><span class="line">    public View on<span class="constructor">CreateView(LayoutInflater <span class="params">inflater</span>, ViewGroup <span class="params">container</span>, Bundle <span class="params">savedInstanceState</span>)</span> &#123;  </span><br><span class="line">        return inflater.inflate(<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>layout.fragment2, container, <span class="literal">false</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    public void on<span class="constructor">ActivityCreated(Bundle <span class="params">savedInstanceState</span>)</span> &#123;  </span><br><span class="line">        super.on<span class="constructor">ActivityCreated(<span class="params">savedInstanceState</span>)</span>;  </span><br><span class="line">        Button button = (Button) get<span class="constructor">Activity()</span>.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">button</span>)</span>;  </span><br><span class="line">        button.set<span class="constructor">OnClickListener(<span class="params">new</span> OnClickListener()</span> &#123;  </span><br><span class="line">            public void on<span class="constructor">Click(View <span class="params">v</span>)</span> &#123;  </span><br><span class="line">                TextView textView = (TextView)  		 			</span><br><span class="line">	            get<span class="constructor">Activity()</span>.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">fragment1_text</span>)</span>;  </span><br><span class="line">                <span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(<span class="params">getActivity</span>()</span>, textView.get<span class="constructor">Text()</span>, Toast.LENGTH_LONG).show<span class="literal">()</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="兼容多种屏幕方案"><a href="#兼容多种屏幕方案" class="headerlink" title="兼容多种屏幕方案"></a>兼容多种屏幕方案</h4><h5 id="创建窄屏主布局文件"><a href="#创建窄屏主布局文件" class="headerlink" title="创建窄屏主布局文件"></a>创建窄屏主布局文件</h5><p>打开或新建res&#x2F;layout&#x2F;activity_main.xml作为程序的主布局文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span> &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/menu_fragment&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.fragmentdemo.MenuFragment&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span>  </span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/4.png"></p>
<h5 id="创建宽屏主布局文件"><a href="#创建宽屏主布局文件" class="headerlink" title="创建宽屏主布局文件"></a>创建宽屏主布局文件</h5><p>在res目录下新建layout-large目录，然后这个目录下创建新的activity_main.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:baselineAligned</span>=<span class="string">&quot;false&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>  </span></span><br><span class="line"><span class="tag">    &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/left_fragment&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;com.example.fragmentdemo.MenuFragment&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dip&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>  </span></span><br><span class="line"><span class="tag">        /&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span>   </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/details_layout&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dip&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span>  </span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/5.png"></p>
<p>menu_fragment.xml文件<br>左边菜单面板的布局，这个是窄屏的第一个页面，用于触发两个子活动，宽屏的时候作为左面板</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span> &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">ListView</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/menu_list&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;fill_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">        &gt;</span><span class="tag">&lt;/<span class="name">ListView</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span>  </span><br></pre></td></tr></table></figure>

<p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/8.png"><br><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/9.png"></p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">class</span> MenuFragment extends Fragment implements OnItemClickListener &#123;  </span><br><span class="line">    <span class="keyword">private</span> ListView menuList;  </span><br><span class="line">    <span class="keyword">private</span> ArrayAdapter&lt;String&gt; adapter;  </span><br><span class="line">    <span class="keyword">private</span> String<span class="literal">[]</span> menuItems = &#123; <span class="string">&quot;Sound&quot;</span>, <span class="string">&quot;Display&quot;</span> &#125;;  </span><br><span class="line">    <span class="keyword">private</span> boolean isTwoPane;  </span><br><span class="line">    public void on<span class="constructor">Attach(Activity <span class="params">activity</span>)</span> &#123;  </span><br><span class="line">        super.on<span class="constructor">Attach(<span class="params">activity</span>)</span>;  </span><br><span class="line">        adapter = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(activity, android.<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>layout.simple_list_item_1, menuItems);  </span><br><span class="line">    &#125;  </span><br><span class="line">    public View on<span class="constructor">CreateView(LayoutInflater <span class="params">inflater</span>, ViewGroup <span class="params">container</span>, Bundle <span class="params">savedInstanceState</span>)</span> &#123;  </span><br><span class="line">        View view = inflater.inflate(<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>layout.menu_fragment, container, <span class="literal">false</span>);  </span><br><span class="line">        menuList = (ListView) view.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">menu_list</span>)</span>;  </span><br><span class="line">        menuList.set<span class="constructor">Adapter(<span class="params">adapter</span>)</span>;  </span><br><span class="line">        menuList.set<span class="constructor">OnItemClickListener(<span class="params">this</span>)</span>;  </span><br><span class="line">        return view;  </span><br><span class="line">    &#125;  </span><br><span class="line">    public void on<span class="constructor">ActivityCreated(Bundle <span class="params">savedInstanceState</span>)</span> &#123;  </span><br><span class="line">        super.on<span class="constructor">ActivityCreated(<span class="params">savedInstanceState</span>)</span>;  </span><br><span class="line">        <span class="keyword">if</span> (get<span class="constructor">Activity()</span>.find<span class="constructor">ViewById(R.<span class="params">id</span>.<span class="params">details_layout</span>)</span> != null) &#123;  </span><br><span class="line">            isTwoPane = <span class="literal">true</span>;  </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            isTwoPane = <span class="literal">false</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    public void on<span class="constructor">ItemClick(AdapterView&lt;?&gt; <span class="params">arg0</span>, View <span class="params">view</span>, <span class="params">int</span> <span class="params">index</span>, <span class="params">long</span> <span class="params">arg3</span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span> (isTwoPane) &#123;  </span><br><span class="line">            Fragment fragment = null;  </span><br><span class="line">            <span class="keyword">if</span> (index<span class="operator"> == </span><span class="number">0</span>) &#123;  </span><br><span class="line">                fragment = <span class="keyword">new</span> <span class="constructor">SoundFragment()</span>;  </span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index<span class="operator"> == </span><span class="number">1</span>) &#123;  </span><br><span class="line">                fragment = <span class="keyword">new</span> <span class="constructor">DisplayFragment()</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">            get<span class="constructor">FragmentManager()</span>.<span class="keyword">begin</span><span class="constructor">Transaction()</span>.replace(<span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.details_layout, fragment).commit<span class="literal">()</span>;  </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">            Intent intent = null;  </span><br><span class="line">            <span class="keyword">if</span> (index<span class="operator"> == </span><span class="number">0</span>) &#123;  </span><br><span class="line">                intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="params">getActivity</span>()</span>, <span class="module-access"><span class="module"><span class="identifier">SoundActivity</span>.</span></span><span class="keyword">class</span>);  </span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (index<span class="operator"> == </span><span class="number">1</span>) &#123;  </span><br><span class="line">                intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="params">getActivity</span>()</span>, <span class="module-access"><span class="module"><span class="identifier">DisplayActivity</span>.</span></span><span class="keyword">class</span>);  </span><br><span class="line">            &#125;  </span><br><span class="line">            start<span class="constructor">Activity(<span class="params">intent</span>)</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">&#125;  </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>sound_fragment.xml布局文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#00ff00&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span>   </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;28sp&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#000000&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is sound view&quot;</span>  </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>SoundFragment类</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">SoundFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;  </span><br><span class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container, <span class="type">Bundle</span> savedInstanceState) &#123;  </span><br><span class="line">        <span class="type">View</span> view = inflater.inflate(<span class="type">R</span>.layout.sound_fragment, container, <span class="literal">false</span>);  </span><br><span class="line">        <span class="keyword">return</span> view;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>display_fragment.xml布局文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;#0000ff&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> &gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span>   </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;28sp&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#000000&quot;</span>  </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is display view&quot;</span>  </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p>DisplayFragment类</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">DisplayFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;  </span><br><span class="line">    public <span class="type">View</span> onCreateView(<span class="type">LayoutInflater</span> inflater, <span class="type">ViewGroup</span> container, <span class="type">Bundle</span> savedInstanceState) &#123;  </span><br><span class="line">        <span class="type">View</span> view = inflater.inflate(<span class="type">R</span>.layout.display_fragment, container, <span class="literal">false</span>);  </span><br><span class="line">        <span class="keyword">return</span> view;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>sound_activity.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">fragment</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/sound_fragment&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.example.fragmentdemo.SoundFragment&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">fragment</span>&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>SoundActivity</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">SoundActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;  </span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);  </span><br><span class="line">        setContentView(<span class="type">R</span>.layout.sound_activity);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/10.png"></p>
<p>display_activity.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">fragment</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/display_fragment&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.example.fragmentdemo.DisplayFragment&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span>  </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">fragment</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>DisplayActivity类</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">DisplayActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;  </span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);  </span><br><span class="line">        setContentView(<span class="type">R</span>.layout.display_activity);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/28/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Fragment/11.png"></p>
<h4 id="Fragment与Activity共享事件处理方法"><a href="#Fragment与Activity共享事件处理方法" class="headerlink" title="Fragment与Activity共享事件处理方法"></a>Fragment与Activity共享事件处理方法</h4><p>在Fragment需要和主Activity共享和事件的地方，可以在Fragment中创建一个callback接口，主Acitivity来实现它：如下所示:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">Public <span class="keyword">interface</span> <span class="title">sharedFunction</span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sharefun</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在Acitivity中实现后，在Fragment中可以如下访问:</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sharedFunction </span><span class="keyword">shared </span>= (<span class="keyword">sharedFunction </span>)activity;</span><br><span class="line"><span class="keyword">Shared. </span><span class="keyword">sharefun();</span></span><br></pre></td></tr></table></figure>




        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/28/Android-初步之Android组件-Fragment/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/28/Android-初步之Android组件-Fragment/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/27/我的Vim-配置/" title="我的Vim 配置" itemprop="url">我的Vim 配置</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-27T08:37:51.000Z" itemprop="datePublished"> Published 2016-03-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/27/我的Vim-配置/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/27/我的Vim-配置/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/27/Android-初步之Android组件-Content-Provider/" title="Android 初步之Android组件  Content Provider" itemprop="url">Android 初步之Android组件  Content Provider</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-27T08:32:15.000Z" itemprop="datePublished"> Published 2016-03-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="啥是Content-provider"><a href="#啥是Content-provider" class="headerlink" title="啥是Content provider"></a>啥是Content provider</h4><p>Content Provider 用于保存和获取数据并使其对所有应用程序可见。这是不同应用程序间共享数据的唯一方式。在Android中没有提供所有应用共同访问的公共存储区域。<br>Content Provider  内部如何保存数据由其设计者决定，但是所有的Content Provider 都实现一组通用的方法用来提供数据的增，删，查，改功能。<br>客户端通常不会直接调用这些方法，大多数是通过Content Resolver 对象实现对Content Provider 的操作，开发人员可以通过调用Activity或者其他应用程序组件的实现类中的getContentResolver来获取ContentResolver对象。<br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Content-Provider/1.png"></p>
<h4 id="数据模型"><a href="#数据模型" class="headerlink" title="数据模型"></a>数据模型</h4><p>Content Provider 使用基于数据库模型的简单表格来提供其中的数据，这里每一行代表一条记录，每列代表特定类型和含义的数据。每条记录包含一个数值型的_ID字段，它用于在表格中唯一标识该记录。<br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Content-Provider/2.png"></p>
<h4 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h4><p>每个Content Provider 提供公共的URI来唯一标识其数据集，管理多个数据集(多个表格)的Content Provider 为每个数据集提供了单独的URI，所有为provider提供的URI都以content:&#x2F;&#x2F;作为前缀,用于识别应该使用哪个provider及其中的哪个表格。<br>如果自定义一个Content Provider 则应该为其URI也定义一个常量。Android为当前平台提供的Content Provider 定义了一个CONTENT_URI常量，匹配电话号码到联系人表格的URI和匹配保存联系人照片的表格的URI分别如下：<br>android.provider.Contacts.Phones.CONTENT_URI<br>android.provider.Contacts.Photos.CONTENT_URI<br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Content-Provider/3.png"><br>A:标准的前缀，用于表示该数据由Content Provider管理。<br>B：URI的授权部分，它标识该Content Provider。对于第三方应用，该部分应该是完整的类名(使用小写形式)来唯一确定。<br>C:Content Provider 的路径部分，用于决定哪类数据被请求，如果Content Provider 仅提供一种数据类型，这部分可以省略，如果provider提供几种类型，包括子类，这部分可以由几个部分组成。<br>D:被请求的特定记录的ID值，这是被请求数据记录的_ID,如果请求不限于单条记录该部分及前面的斜线应该删除.</p>
<h4 id="系统定义的Content-Provider"><a href="#系统定义的Content-Provider" class="headerlink" title="系统定义的Content Provider"></a>系统定义的Content Provider</h4><ul>
<li>Browser：读取或者修改书签，浏览历史或者网络搜索</li>
<li>CallLog:查看或更新通话历史</li>
<li>Contacts:读取，修改或保存联系人信息</li>
<li>LiveFolders:由Content  Provider 提供内容的特定文件夹</li>
<li>MediaStore:访问声音，视频和图片</li>
<li>Setting:查看和获取蓝牙设置，铃声等偏好设置</li>
<li>SearchRecentSuggestions:能被配置以使用查找意见的provider操作</li>
<li>SyncStateContract：用于使用数据数组账号关联数据的Content Provider约束。</li>
<li>UserDictonary:在可预测文本输入时，提供用户定义单词给输入法使用，应用程序和输入法能够增加数据到该字典，单词能关联频率信息和本地化信息。</li>
</ul>
<h4 id="自定义Content-Provider"><a href="#自定义Content-Provider" class="headerlink" title="自定义Content Provider"></a>自定义Content Provider</h4><ol>
<li>建立数据存储系统。大多数Content Provider 使用Android文件存储方法或者SQLite数据库保存数据，但是开发人员可以使用任何方式存储</li>
<li>继承ContentProvider类来提供数据访问</li>
<li>在应用程序的AndroidManifest文件中声明Content Provider</li>
</ol>
<h5 id="继承ContentProvider类"><a href="#继承ContentProvider类" class="headerlink" title="继承ContentProvider类"></a>继承ContentProvider类</h5><p>开发人员定义ContentProvider类的子类，以便使用ContentResolver和Cursor类带来的便捷来共享数据。要达到这个目的原则上要实现如下的几个方法<br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Content-Provider/5.png"><br>由于这些ContentProvider方法能够被位于不同进程和线程的不同Content Resolver对象调用，它们必须以线程安全的方式实现。<br>此外开发人员可能也想调用Content Resolver.notifyChange()方法以便在数据修改时候通知监听器</p>
<h5 id="定义CONTENT-URI"><a href="#定义CONTENT-URI" class="headerlink" title="定义CONTENT_URI:"></a>定义CONTENT_URI:</h5><p>开发人员必须为该值定义一个唯一的字符串</p>
<figure class="highlight d"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Uri  CONTENT_URI= Uri.parse(<span class="string">&quot;content://com.example.employee&quot;</span>);</span><br><span class="line"><span class="string">``</span><span class="string">``</span></span><br><span class="line">如果有子表可以使用如下定义:</span><br></pre></td></tr></table></figure>
<p>public static final Uri  CONTENT_URI&#x3D; Uri.parse(“content:&#x2F;&#x2F;com.example.employee&#x2F;dba”);</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">##### 定义内容提供者将返回给客户端的列名：</span><br><span class="line">如果开发人员使用的是底层数据库，这些列明通常与SQL列明相同，确保包含名为_ID的整数列作为记录的ID值。</span><br><span class="line">如果使用SQLite数据库，_ID字段应该是INTEGER PRIMARY KEY AUTOINCREMENT.</span><br><span class="line">##### 注释每列的数据类型</span><br><span class="line">如果开发人员正在处理新数据类型，则必须定义新的MIME类型，以便在ContentProvider.getType方法中返回.</span><br><span class="line">##### 声明内容提供者</span><br></pre></td></tr></table></figure>
<p><provider android:name="com.emproy.Empory" android:authorities="com.emproy.empory"><br></provider></p>
<pre><code>
</code></pre>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/27/Android-初步之Android组件-Content-Provider/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/27/Android-初步之Android组件-Content-Provider/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/27/Android-初步之Android组件-Intent/" title="Android 初步之Android组件  Intent" itemprop="url">Android 初步之Android组件  Intent</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-27T07:28:08.000Z" itemprop="datePublished"> Published 2016-03-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="啥是Intent"><a href="#啥是Intent" class="headerlink" title="啥是Intent"></a>啥是Intent</h4><p>在一个Android程序中，主要由3种组件(Activity，BroadCast，Service)组成的，这三种组件是独立的，但是它们之间可以相互调用，协调工作。这些组件之间的通信主要是由Intent来完成的。Intent在其中起着一个媒体中介的作用，专门提供组件相互调用的相关信息，实现调用者与被调用者之间的解耦。<br>Intent负责对应用中一次操作的动作，动作涉及的数据以及附加数据进行描述，Android则根据此Intent的描述负责找到对应的组件，将Intent传递给调用的组件，并完成组件的调用。</p>
<h4 id="Intent对象的组成"><a href="#Intent对象的组成" class="headerlink" title="Intent对象的组成"></a>Intent对象的组成</h4><ul>
<li>组件名字 Component：定位合适的目标组件</li>
<li>动作 Action：用来标示要广播的事件，动作很大程度上决定了数据和附加信息，就像一个方法名决定了参数和返回值一样，因此应尽可能明确指定动作，同时必须确保动作字符串的唯一性，一般使用java包名。</li>
<li>数据 data :数据是作用Intent上的数据的URI和数据的MIME类型，不同的数据具有不同的规范，当匹配一个Intent到一个能够处理数据的组件的时候，明确其数据类型（MIME）和URI很重要。</li>
<li>种类 Catoragry ：用于作为被执行动作的附加信息</li>
<li>附加信息 Extra ：传输数据的重要方法</li>
<li>标志 Flag ：主要用来指示Android程序如何去启动一个活动，例如，活动应该属于哪个任务。和启动后如何对待它，例如它是否属于最近的活动列表。</li>
</ul>
<h5 id="组件名称"><a href="#组件名称" class="headerlink" title="组件名称"></a>组件名称</h5><p>组件名称是可选的，如果设置了，Intent对象传递到指定的类的实例，如果没有设置，Android使用Intent中的其他信息来定位合适的目标组件。组件名字的设置可用如下方法。<br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/1.png"></p>
<h5 id="动作-标准的Activity动作"><a href="#动作-标准的Activity动作" class="headerlink" title="动作 标准的Activity动作"></a>动作 标准的Activity动作</h5><p><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/2.png"><br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/3.png"></p>
<p>在上述两个表中，需要将其转换为对应的字符串信息，比如将ACTION_TIME_TICK转换为android.intent.action.TIME_TICK<br>除了预定义的动作，我们还可以自定义动作字符串，来启动应用程序中的组件，这些新发明的字符串应该包含一个应用程序包作为前缀，如com.exemple.SHOW_COLOR<br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/6.png"></p>
<h5 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h5><p><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/7.png"></p>
<h5 id="种类"><a href="#种类" class="headerlink" title="种类"></a>种类</h5><p><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/8.png"><br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/9.png"></p>
<h5 id="附加信息"><a href="#附加信息" class="headerlink" title="附加信息"></a>附加信息</h5><p><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/10.png"></p>
<h5 id="标志"><a href="#标志" class="headerlink" title="标志"></a>标志</h5><p><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/11.png"><br><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/12.png"></p>
<h4 id="Intent-作用"><a href="#Intent-作用" class="headerlink" title="Intent 作用"></a>Intent 作用</h4><p>Intent用处可归纳如下几点:</p>
<ol>
<li>负责Android设备上安装的任意应用程序组件之间的交互，不管它们是哪个应用程序的一部分都是如此，这就把设备从一个包含相互独立的组件集合的平台变成一个互联的系统。</li>
<li>通过定义隐式或者显式的Intent来启动Activity或者Service。</li>
<li>用于在系统范围内广播消息，应用程序可以通过注册一个Broadcast Receiver来监听和响应这些广播的Intent，这样就可以基于内部的，系统的或者第三方应用程序的事件创建事件驱动的应用程序。</li>
<li>Android通过广播Intent来公布系统事件，比如网络状态，电池电量的改变。本地Android应用简单得注册监听特定的广播Intent并作出相应的响应的组件，这样就可以通过监听相同的Intent 的BroadCast Receiver来替换本地提供的应用程序。</li>
</ol>
<h5 id="使用Intent-启动-Activity"><a href="#使用Intent-启动-Activity" class="headerlink" title="使用Intent 启动 Activity"></a>使用Intent 启动 Activity</h5><ul>
<li><p>显式启动Activity (条件:目标Activity必须在manifest文件中注册):</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span>  Intent（<span class="module-access"><span class="module"><span class="identifier">MainActivity</span>.</span></span>this,<span class="module-access"><span class="module"><span class="identifier">Detail</span>.</span></span><span class="keyword">class</span>）;</span><br><span class="line">start<span class="constructor">Activity(<span class="params">intent</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>上述代码执行后，新的Acitivity将会被创建，启动和运行，并移动到Activity堆栈的顶部。</p>
</li>
<li><p>隐式启动Activity<br>隐式启动可以要求系统启动一个可执行给定动作的Activity，而不必知道需要启动哪个应用程序或者Acitivity，这种情况下运行时会自动解析Intent来选择最合适的Activity,如果有多个Acitivity都能够执行指定动作，那么系统将会向用户呈现选项，让用户来选择。</p>
</li>
</ul>
<p>方法一：指定ACTION以及执行当前ACTION所需数据的URI</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Intent</span> <span class="keyword">intent</span> = new <span class="keyword">Intent</span>(<span class="keyword">Intent</span>.ACTION_DIAL,Uri.parse(“tel:<span class="number">555</span>-<span class="number">2368</span>”));</span><br></pre></td></tr></table></figure>
<p>方法二:使用自定义的Activity来响应当前的隐式Intent</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">Intent intent <span class="operator">=</span> new Intent(<span class="string">&quot;com.androidDemo.intent.action.ShowView&quot;</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>在manifest中添加意图过滤器intent-filer</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.BasicViewActivity&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;Basic View Tests&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot; com.androidDemo.intent.action.ShowView &quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">“android.intent.category.DEFAULT”/</span>&gt;</span>(一定要加)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>关闭Activty<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">finish</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
如果当前的Activity不是主活动，那么执行finish方法后，返回到调用它的那个Activity，否则将返回到主屏幕中。<br>关闭Activity还可以使用finishActivity方法实现该方法用来关闭使用startActivityForResult方法启动的Activity。</li>
</ul>
<h5 id="使用Intent在Activity之间交换数据"><a href="#使用Intent在Activity之间交换数据" class="headerlink" title="使用Intent在Activity之间交换数据"></a>使用Intent在Activity之间交换数据</h5><p>Extra作为一个Bundle对象存储在Intent中，用于向Intent附加基本类型值，可以使用putExtra可以添加附加的数据，在目标Activity中使用getExtras方法来取出数据。<br>下面是使用Intent在Acitivity之间传输数据的代码片段:<br>发送方:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> <span class="constructor">Intent(MainActivity.<span class="params">this</span>，RegisterActivity.<span class="params">class</span>)</span>;</span><br><span class="line">Bundle  bundle = <span class="keyword">new</span> <span class="constructor">Bundle()</span>;</span><br><span class="line">bundle.put<span class="constructor">CharSequence(<span class="string">&quot;user&quot;</span>,<span class="params">user</span>)</span>;</span><br><span class="line">bundle.put<span class="constructor">Serializable(<span class="string">&quot;info&quot;</span>,<span class="params">info</span>)</span>;</span><br><span class="line">intent.put<span class="constructor">Extras(<span class="params">bundle</span>)</span>;</span><br><span class="line">start<span class="constructor">Activity(<span class="params">intent</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>接收方：</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">Intent intent <span class="operator">=</span> getIntent()<span class="comment">;</span></span><br><span class="line">Bundle bundle <span class="operator">=</span> intent.getExtas()<span class="comment">;</span></span><br><span class="line">bundle.getString(<span class="string">&quot;usr&quot;</span>)<span class="comment">;</span></span><br><span class="line">bundle.getSerializable(<span class="string">&quot;info&quot;</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<h5 id="调用另一个Activity并返回结果"><a href="#调用另一个Activity并返回结果" class="headerlink" title="调用另一个Activity并返回结果"></a>调用另一个Activity并返回结果</h5><p>通过startAcitivity启动Acitivity，在关闭的时候不会返回任何数据。因此如果需要在调用Acitivity后返回数据则需要使用startActivityForResult来实现，代码块如下：</p>
<p>发送方：</p>
<figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line">startActivityForResult(intent,request_code);</span><br><span class="line"><span class="keyword">protected</span> <span class="literal">void</span> onAcitvityResult(int requestCode,int resultCode,Intent <span class="built_in">data</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(requestCode==xxxx&amp;&amp;resultCode=yyyyy)&#123;</span><br><span class="line">		<span class="built_in">data</span>.getExtas();</span><br><span class="line">		<span class="params">...</span><span class="params">...</span><span class="params">...</span><span class="params">...</span><span class="params">...</span><span class="params">...</span><span class="params">...</span><span class="params">...</span><span class="params">...</span><span class="params">...</span>.</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接收方:</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setResilt</span>(<span class="number">0</span>x717,intent);</span><br><span class="line"><span class="built_in">finish</span>();</span><br></pre></td></tr></table></figure>
<h5 id="确定Intent能否解析"><a href="#确定Intent能否解析" class="headerlink" title="确定Intent能否解析"></a>确定Intent能否解析</h5><p>在使用Intent启动一个Acitivity之前，必须先确定用户设备上安装了能够处理当前请求的应用程序。这个可以通过调用Intent的resolveActivity方法，并向该方法传入Package Manager 进行查询。具体的代码块如下:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">PackageManager pm = get<span class="constructor">PackageManager()</span>;</span><br><span class="line">ComponentName cn  = intent.resolve<span class="constructor">Acitivity(<span class="params">pm</span>)</span>;</span><br><span class="line"><span class="keyword">if</span>(cn<span class="operator"> == </span>null)&#123;</span><br><span class="line">    <span class="comment">//表示没有找到对应的应用程序</span></span><br><span class="line">    <span class="comment">//可以选择禁止相关的功能，或者到应用市场下载对应的应用程序</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//表示找到对应的应用程序</span></span><br><span class="line">    start<span class="constructor">Activity(<span class="params">intent</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="使用Intent-启动和绑定-Service"><a href="#使用Intent-启动和绑定-Service" class="headerlink" title="使用Intent 启动和绑定 Service"></a>使用Intent 启动和绑定 Service</h5><ul>
<li>启动服务<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="params">this</span>, EchoService.<span class="params">class</span>)</span>;</span><br><span class="line">start<span class="constructor">Service(<span class="params">intent</span>)</span></span><br></pre></td></tr></table></figure></li>
<li>停止服务<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="params">this</span>, EchoService.<span class="params">class</span>)</span>;</span><br><span class="line">stop<span class="constructor">Service(<span class="params">intent</span>)</span>;</span><br></pre></td></tr></table></figure></li>
<li>绑定服务<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="params">this</span>, EchoServices.<span class="params">class</span>)</span>;</span><br><span class="line">bind<span class="constructor">Service(<span class="params">intent</span>, <span class="params">conn</span>, Context.BIND_AUTO_CREATE)</span>;</span><br></pre></td></tr></table></figure></li>
<li>解除绑定服务<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">unbind<span class="constructor">Service(<span class="params">conn</span>)</span>;</span><br></pre></td></tr></table></figure>
<h5 id="使用Intent-发送BroadCast-Intent"><a href="#使用Intent-发送BroadCast-Intent" class="headerlink" title="使用Intent 发送BroadCast Intent"></a>使用Intent 发送BroadCast Intent</h5><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> <span class="constructor">Intent(Constant.ACTION_NAME)</span>;</span><br><span class="line">send<span class="constructor">Broadcast(<span class="params">intent</span>)</span>;<span class="comment">//普通广播</span></span><br><span class="line">send<span class="constructor">OrderedBroadcast(<span class="params">intent</span>, <span class="params">null</span>)</span>;<span class="comment">//有序广播</span></span><br><span class="line">send<span class="constructor">StickyBroadcast(<span class="params">intent</span>)</span>;<span class="comment">//粘性广播</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="意图过滤器-IntentFilter"><a href="#意图过滤器-IntentFilter" class="headerlink" title="意图过滤器  IntentFilter"></a>意图过滤器  IntentFilter</h4><p>当在android程序中使用显示意图的时候，意图对象中只用组件名字内容就可以决定那个组件应该获得这个意图，而使用隐式意图的时候android程序必须查找一个最适合的组件去处理意图，该过程是通过比较意图对象内容和意图过滤器来完成的。<br>如果一个组件没有任何Intent过滤器，它仅仅能接收显示的意图，而声明了意图过滤器的组件可以接收显示和隐式意图。<br>当一个意图对象的动作，数据（URI和数据类型），种类，这三者都符合一个意图过滤器的时候，才能考虑是否接收意图，而附加信息和标识在解析哪个组件接收意图时不起作用。</p>
<p><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/13.png"></p>
<h5 id="意图过滤器的动作匹配"><a href="#意图过滤器的动作匹配" class="headerlink" title="意图过滤器的动作匹配"></a>意图过滤器的动作匹配</h5><p>动作测试：</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">&lt;intent-filter&gt;</span><br><span class="line">	&lt;<span class="built_in">action</span> android:<span class="built_in">name</span>=<span class="string">&quot;com.example.project.SHOW_CURRENT&quot;</span>/&gt;</span><br><span class="line">	&lt;<span class="built_in">action</span> android:<span class="built_in">name</span>=<span class="string">&quot;com.example.project.SHOW_RECENT&quot;</span>/&gt;</span><br><span class="line">	&lt;<span class="built_in">action</span> android:<span class="built_in">name</span>=<span class="string">&quot;com.example.project.SHOW_PEDDING&quot;</span>/&gt;</span><br><span class="line">	......</span><br><span class="line">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>
<p>尽管意图对象仅定义一个动作，在意图过滤器中可以列出多个，列表不能为空，即过滤器中必须至少包含一个<action>标签，否则会阻塞所有Intent<br>规则：<br>如果Intent Filter 包含了指定的动作，那么就认为动作匹配了，如果检测到没有任何一个动作和Intent指定的动作相匹配，就认为动作匹配失败了。</action></p>
<h5 id="意图过滤器的种类匹配"><a href="#意图过滤器的种类匹配" class="headerlink" title="意图过滤器的种类匹配"></a>意图过滤器的种类匹配</h5><p>种类测试：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">category</span>  <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.DEFAULT&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">category</span>  <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.BROWSABLE&quot;</span>/&gt;</span></span><br><span class="line">		......</span><br><span class="line"><span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在接收隐式意图的Activity必须在过滤器中包含android.catagory.DEFAULT.<br>Intent Filter 必须包含待解析Intent的所有Category，但是可以包含Intent不包含的其他category。一个没有指定category的Intent  Filter只能和没有任何category的Intent相匹配。</p>
<h5 id="意图过滤器的数据匹配"><a href="#意图过滤器的数据匹配" class="headerlink" title="意图过滤器的数据匹配"></a>意图过滤器的数据匹配</h5><p>数据测试：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">data</span> <span class="attr">android:mimeType</span>=<span class="string">&quot;video/mpeg&quot;</span> <span class="attr">android:scheme</span>=<span class="string">&quot;http&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">data</span> <span class="attr">android:mimeType</span>=<span class="string">&quot;audio/mpeg&quot;</span> <span class="attr">android:scheme</span>=<span class="string">&quot;http&quot;</span>/&gt;</span></span><br><span class="line">		......</span><br><span class="line"><span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>每个<data>标签可以指定URI和数据类型，URI可以分成scheme，host，port，path这几个独立的部分，格式如下</data></p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">scheme：<span class="regexp">//</span>host:port/path</span><br></pre></td></tr></table></figure>
<p>例如：content:&#x2F;&#x2F;com.example.project:200&#x2F;folder&#x2F;subfolder&#x2F;etc<br>其中scheme是content，host是com.example.project，port是200，path是&#x2F;folder&#x2F;subfolder&#x2F;etc，host和port组成了URI授权，如果host没有指定则忽略port。这些属性都是可选的但是相互之间并非完全独立的，如果授权有效，则sheme必须指定，如果path有效，则sheme和授权必须指定。当意图对象中的URI与过滤器中的URI规范相比较的时候，它仅与过滤器中实际提到的URI部分相比较，例如过滤器仅指定了sheme那么所有具有该sheme的URI都能匹配该过滤器，如果过滤器指定了scheme和授权没有指定path那么，不管path如何，具有该sheme授权的URI都能匹配，如果过滤器中指定了sheme，授权和path则仅有具有相同sheme，授权和path的URI能够匹配。然而过滤器中的path中可以包含通配符来允许部分匹配。<br>(也就是只要Intent的数据是Intent Filter数据集合中的一项就可以通过匹配)mimeType：Intent对象和过滤器都能使用*来包含子类型，例如text&#x2F;*或者audio&#x2F;</p>
<p><img src="/2016/03/27/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-Intent/14.png"></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/27/Android-初步之Android组件-Intent/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/27/Android-初步之Android组件-Intent/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/26/Android-初步之Android组件-BroadcastReceiver/" title="Android 初步之Android组件  BroadcastReceiver" itemprop="url">Android 初步之Android组件  BroadcastReceiver</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-26T06:32:32.000Z" itemprop="datePublished"> Published 2016-03-26</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h4 id="BroadCast-Receiver是啥"><a href="#BroadCast-Receiver是啥" class="headerlink" title="BroadCast Receiver是啥"></a>BroadCast Receiver是啥</h4><p>Broadcast Receiver是用于接收广播通知的组件。广播是一种同时通知多个对象的事件通知机制。<br>Android中的广播来源于系统事件，例如按下拍照键，电池电量低，安装新应用等。还有普通应用程序。如启动特定线程，文件下载完毕等。<br>广播接收器通常初始化独立的组件或者在onReceiver方法中发送通知给用户，如果广播接收器需要完成更加耗时的任务，应该启动一个服务而不是一个线程，因为不活跃的广播接收器可能被系统停止。</p>
<h4 id="BroadCast-Receiver分类"><a href="#BroadCast-Receiver分类" class="headerlink" title="BroadCast Receiver分类"></a>BroadCast Receiver分类</h4><ul>
<li>普通广播<br>sendBroadcast()这个方法的广播能够按照注册的先后顺序发送给所有广播接收者，如果设置了广播接收者的优先级，优先级如果恰好与注册顺序相同，则不会有任何问题，如果顺序不一样，会出leaked IntentReceiver 这样的异常，并且在前面的广播接收者不能调用abortBroadcast()方法将其终止，如果调用会出BroadcastReceiver trying to return result during a non-ordered broadcast的异常，先接收到广播的receiver可以修改广播数据。</li>
<li>有序广播<br>sendOrderedBroadcast()方法priority的属性能起作用，并且在队列前面的receiver可以随时终止广播的发送。还有这个api能指定final的receiver，这个receiver是最后一个接收广播时间的receiver，并且一定会接收到广播事件，是不能被前面的receiver拦截的。这个特性可以用来统计系统中能监听某种广播的Receiver的数目。</li>
<li>粘性的广播<br>sendStickyBroadcast()字面意思是发送粘性的广播，使用这个api需要权限android.Manifest.permission.BROADCAST_STICKY,粘性广播的特点是Intent会一直保留到广播事件结束，而这种广播也没有所谓的10秒限制，10秒限制是指普通的广播如果onReceive方法执行时间太长，超过10秒的时候系统会将这个广播置为可以被销毁的候选，一旦系统资源不够的时候，就会撤销这个广播。</li>
</ul>
<p></p>
<h4 id="使用BroadCast-Receiver-监听广播"><a href="#使用BroadCast-Receiver-监听广播" class="headerlink" title="使用BroadCast Receiver 监听广播"></a>使用BroadCast Receiver 监听广播</h4><p>要让BroadCast Receiver 监听广播需要完成如下操作:</p>
<ol>
<li>在代码中进行动态注册广播，或者在Manifest 清单文件中静态注册<br>二者的对比如下:<br><img src="/2016/03/26/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-BroadcastReceiver/2.png"></li>
<li>使用意图过滤器Intent Filter 来指定它要监听的BroadCast  Intent</li>
<li>创建新的BroadCast  Receiver 重写onReceive方法，在接收到一个通过Intent Filter 过滤后的BroadCast Intent，就会执行onReceive方法，在onReceive方法中可以更新内容，启动Service，更新UI或者使用Notification Manager来通知用户。BroadCast 也运行在主线程中，因此主要的处理工作不能在BroadCast  Receiver中直接完成</li>
</ol>
<h5 id="动态注册广播"><a href="#动态注册广播" class="headerlink" title="动态注册广播"></a>动态注册广播</h5><ul>
<li>动态注册:<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">IntentFilter intentFilter = <span class="keyword">new</span> <span class="constructor">IntentFilter(Constant.ACTION_NAME)</span>;</span><br><span class="line">broadCast = <span class="keyword">new</span> <span class="constructor">EchoBroadCast()</span>;</span><br><span class="line">register<span class="constructor">Receiver(<span class="params">broadCast</span>, <span class="params">intentFilter</span>)</span>;</span><br></pre></td></tr></table></figure></li>
<li>取消注册:<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">unregister<span class="constructor">Receiver(<span class="params">broadCast</span>)</span>;</span><br></pre></td></tr></table></figure></li>
<li>发送广播:<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> <span class="constructor">Intent(Constant.ACTION_NAME)</span>;</span><br><span class="line">Bundle b = <span class="keyword">new</span> <span class="constructor">Bundle()</span>;</span><br><span class="line">b.put<span class="constructor">String(<span class="string">&quot;Message&quot;</span>, <span class="string">&quot;This is The Message From MainActivity!&quot;</span>)</span>;</span><br><span class="line">intent.put<span class="constructor">Extras(<span class="params">b</span>)</span>;</span><br><span class="line">send<span class="constructor">Broadcast(<span class="params">intent</span>)</span>;</span><br></pre></td></tr></table></figure></li>
<li>服务类的编写：<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">EchoBroadCast</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    public void onReceive(<span class="type">Context</span> context, <span class="type">Intent</span> intent) &#123;</span><br><span class="line">	    <span class="type">String</span> <span class="type">ACTION</span> = intent.getAction();</span><br><span class="line">        <span class="keyword">if</span>(<span class="type">ACTION</span>.equals(<span class="type">Constant</span>.<span class="type">ACTION_NAME</span>))&#123;</span><br><span class="line">	        <span class="type">Log</span>.i(<span class="type">Constant</span>.<span class="type">TAG_NAME</span>, intent.getExtras().getString(<span class="string">&quot;Message&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="静态注册BroadCast-Receiver"><a href="#静态注册BroadCast-Receiver" class="headerlink" title="静态注册BroadCast Receiver"></a>静态注册BroadCast Receiver</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">receiver</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.testbroadcastreceiverregiststatic.EchoBroadCast&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.testbroadcastreceiverregiststatic.ACTION&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="OrderedBroadCast"><a href="#OrderedBroadCast" class="headerlink" title="OrderedBroadCast"></a>OrderedBroadCast</h4><p>当发送有序广播的时候，Intent将会按照优先级顺序被传递给所有具有合适权限的已经注册的接收器，优先级越大越先接收到。</p>
<p>启动广播代码:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">send<span class="constructor">OrderedBroadcast(<span class="params">intent</span>, <span class="params">null</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>广播中的重要方法:</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span>ResultExtras<span class="params">(b)</span>; <span class="string">//</span> 优先接收到Broadcast的接收者可以通过<span class="keyword">set</span>ResultExtras<span class="params">(Bundle)</span>方法将处理结果存入Broadcast中，然后传给下一个接收者</span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">Bundle b = get<span class="constructor">ResultExtras(<span class="params">true</span>)</span>;</span><br><span class="line"><span class="built_in">int</span> count = b.get<span class="constructor">Int(<span class="string">&quot;Number&quot;</span>)</span>;<span class="comment">// 将数据取出</span></span><br></pre></td></tr></table></figure>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">abortBroadcast</span>();<span class="comment">// 终止广播</span></span><br></pre></td></tr></table></figure>
<p>清单文件中注册:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">receiver</span>  <span class="attr">android:name</span>=<span class="string">&quot;com.example.testbroadcastordered.FirstReceiver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">intent-filter</span> <span class="attr">android:priority</span>=<span class="string">&quot;4&quot;</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.testbroadcastordered.ACTION&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一个广播代码:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public void on<span class="constructor">Receive(Context <span class="params">context</span>, Intent <span class="params">intent</span>)</span> &#123;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(Constant.Tag_NAME, <span class="string">&quot;FirstReceiver&quot;</span>);</span><br><span class="line">    Bundle b = intent.get<span class="constructor">Extras()</span>;</span><br><span class="line">    <span class="built_in">int</span> count = b.get<span class="constructor">Int(<span class="string">&quot;Number&quot;</span>)</span>;<span class="comment">// 将数据取出</span></span><br><span class="line">    count++; <span class="comment">// 修改数据</span></span><br><span class="line">    b.put<span class="constructor">Int(<span class="string">&quot;Number&quot;</span>, <span class="params">count</span>)</span>; <span class="comment">// 将数据存入</span></span><br><span class="line">    set<span class="constructor">ResultExtras(<span class="params">b</span>)</span>; <span class="comment">// 优先接收到Broadcast的接收者可以通过setResultExtras(Bundle)方法将处理结果存入Broadcast中，然后传给下一个接收者</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其他广播代码:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public void on<span class="constructor">Receive(Context <span class="params">context</span>, Intent <span class="params">intent</span>)</span> &#123;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(Constant.Tag_NAME, <span class="string">&quot;SecondReceiver&quot;</span>);</span><br><span class="line">    Bundle b = get<span class="constructor">ResultExtras(<span class="params">true</span>)</span>;</span><br><span class="line">    <span class="built_in">int</span> count = b.get<span class="constructor">Int(<span class="string">&quot;Number&quot;</span>)</span>;<span class="comment">// 将数据取出</span></span><br><span class="line">    count++; <span class="comment">// 修改数据</span></span><br><span class="line">    b.put<span class="constructor">Int(<span class="string">&quot;Number&quot;</span>, <span class="params">count</span>)</span>; <span class="comment">// 将数据存入</span></span><br><span class="line">    set<span class="constructor">ResultExtras(<span class="params">b</span>)</span>; <span class="comment">// 优先接收到Broadcast的接收者可以通过setResultExtras(Bundle)方法将处理结果存入Broadcast中，然后传给下一个接收者</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后一个广播代码:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public void on<span class="constructor">Receive(Context <span class="params">context</span>, Intent <span class="params">intent</span>)</span> &#123;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(Constant.Tag_NAME, <span class="string">&quot;LastReceiver&quot;</span>);</span><br><span class="line">    Bundle b = get<span class="constructor">ResultExtras(<span class="params">true</span>)</span>;</span><br><span class="line">    <span class="built_in">int</span> count = b.get<span class="constructor">Int(<span class="string">&quot;Number&quot;</span>)</span>;<span class="comment">// 将数据取出</span></span><br><span class="line">    count++; <span class="comment">// 修改数据</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(Constant.Tag_NAME, <span class="string">&quot;一共经过了：&quot;</span> + count + <span class="string">&quot; 个广播&quot;</span>);</span><br><span class="line">    abort<span class="constructor">Broadcast()</span>;<span class="comment">// 终止广播</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="StickyBroadCast"><a href="#StickyBroadCast" class="headerlink" title="StickyBroadCast"></a>StickyBroadCast</h4><p>Sticky Intent 可以保存它们最后一次广播的值，并且当有一个新的接收者，被注册为接收该广播的时候，它们会把这些值作为Intent返回，当调用regesterReceiver来指定一个匹配的Sticky BroadCast Intent 的intentFilter 时，返回值将是最后一次Intent广播。<br>要广播自己的Sticky，必须拥有BROADCAST_STICKY用户权限，不是必须指定一个接收器来获取Sticky Intent的当前值。</p>
<p>注册:</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">IntentFilter <span class="attribute">filter</span> = new IntentFilter(<span class="string">&quot;com.example.testbroadcaststicky.ACTION&quot;</span>);</span><br><span class="line"><span class="function"><span class="title">registerReceiver</span><span class="params">(new EchoBroadCast()</span></span>, <span class="attribute">filter</span>);</span><br></pre></td></tr></table></figure>
<p>发送:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="string">&quot;com.example.testbroadcaststicky.ACTION&quot;</span>)</span>;</span><br><span class="line">intent.put<span class="constructor">Extra(<span class="string">&quot;Number&quot;</span>,88888888)</span>;</span><br><span class="line">send<span class="constructor">StickyBroadcast(<span class="params">intent</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>移除:</p>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="comment">removeStickyBroadcast(intent);</span></span><br></pre></td></tr></table></figure>
<p>设置权限:</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">android<span class="selector-class">.permission</span>.BROADCAST_STICKY</span><br></pre></td></tr></table></figure>

<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public void on<span class="constructor">Click(View <span class="params">v</span>)</span> &#123;</span><br><span class="line">    switch (v.get<span class="constructor">Id()</span>) &#123;</span><br><span class="line">        case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.btnSendStickyBroadCast:</span><br><span class="line">            intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="string">&quot;com.example.testbroadcaststicky.ACTION&quot;</span>)</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">                intent.put<span class="constructor">Extra(<span class="string">&quot;Number&quot;</span>,<span class="params">i</span>)</span>;</span><br><span class="line">                send<span class="constructor">StickyBroadcast(<span class="params">intent</span>)</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        break;</span><br><span class="line">        case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.btnSendAnotherStickyBroadCast:</span><br><span class="line">            intent = <span class="keyword">new</span> <span class="constructor">Intent(<span class="string">&quot;com.example.testbroadcaststicky.ACTION&quot;</span>)</span>;</span><br><span class="line">            intent.put<span class="constructor">Extra(<span class="string">&quot;Number&quot;</span>,88888888)</span>;</span><br><span class="line">            send<span class="constructor">StickyBroadcast(<span class="params">intent</span>)</span>;</span><br><span class="line">        break;</span><br><span class="line">        case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.btnRemoveStickyBroadCast:</span><br><span class="line">            <span class="keyword">if</span>(isregistered)&#123;</span><br><span class="line">                remove<span class="constructor">StickyBroadcast(<span class="params">intent</span>)</span>;</span><br><span class="line">                isregistered = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        break;</span><br><span class="line">        case <span class="module-access"><span class="module"><span class="identifier">R</span>.</span></span>id.btnRegisterStickyBroadCast:</span><br><span class="line">            IntentFilter filter = <span class="keyword">new</span> <span class="constructor">IntentFilter(<span class="string">&quot;com.example.testbroadcaststicky.ACTION&quot;</span>)</span>;</span><br><span class="line">            register<span class="constructor">Receiver(<span class="params">new</span> EchoBroadCast()</span>, filter);</span><br><span class="line">            isregistered = <span class="literal">true</span>;</span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(<span class="string">&quot;EchoBroadCast&quot;</span>, <span class="string">&quot;注册成功&quot;</span>);	</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">		break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/26/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-BroadcastReceiver/3.png"><br><img src="/2016/03/26/Android-%E5%88%9D%E6%AD%A5%E4%B9%8BAndroid%E7%BB%84%E4%BB%B6-BroadcastReceiver/4.png"><br>从上面截图可以看出在发送10次Intent后最后一个intent数值为9，下一次注册StickyBroadCast的时候接收到的是上一次的最后一个Intent，数值为9，如果再发送一次值为88888888的Intent，这时候最后一个Intent的值为88888888，如果再次注册，返回的是88888888</p>
<h4 id="广播接受者实现过程需要注意的点"><a href="#广播接受者实现过程需要注意的点" class="headerlink" title="广播接受者实现过程需要注意的点"></a>广播接受者实现过程需要注意的点</h4><ol>
<li>广播接收者的生命周期是非常短暂的，在接收到广播的时候创建，onReceive()方法结束之后销毁。</li>
<li>广播接收者中不要做一些耗时的工作，否则会弹出Application No Response错误对话框。</li>
<li>最好也不要在广播接收者中创建子线程做耗时的工作，因为广播接收者被销毁后进程就成为了空进程，很容易被系统杀掉。</li>
<li>耗时的较长的工作最好放在服务中完成。</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



<div class="comments-count">
	
	  	<span></span>
		<a href="/2016/03/26/Android-初步之Android组件-BroadcastReceiver/#comments" class="ds-thread-count comments-count-link" data-thread-key="2016/03/26/Android-初步之Android组件-BroadcastReceiver/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/25/">&lt;span&gt;&lt;&#x2F;span&gt;Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="page-number" href="/page/25/">25</a><span class="page-number current">26</span><a class="page-number" href="/page/27/">27</a><a class="page-number" href="/page/28/">28</a><span class="space">&hellip;</span><a class="page-number" href="/page/30/">30</a><a class="extend next" rel="next" href="/page/27/">Next&lt;span&gt;&lt;&#x2F;span&gt;</a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">
<div id="authorInfo">
	
		<div class="author-img"></div>		
	
	<div class="social-info" class="clearfix">
		
		
		<a href="https://github.com/tbfungeek" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		
		<a href="mailto:tbfungeek@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		

	</div>
</div>

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Android-小经验/" title="Android 小经验">Android 小经验<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android-源码分析/" title="Android 源码分析">Android 源码分析<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android其他/" title="Android其他">Android其他<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android初步/" title="Android初步">Android初步<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android进阶/" title="Android进阶">Android进阶<sup>100</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hexo-使用/" title="Hexo 使用">Hexo 使用<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/JavaScript理论/" title="JavaScript理论">JavaScript理论<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Objective-C-相关/" title="Objective C 相关">Objective C 相关<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/OpenCV/" title="OpenCV">OpenCV<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/ROS/" title="ROS">ROS<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-工具使用/" title="iOS 工具使用">iOS 工具使用<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-开源库分析/" title="iOS 开源库分析">iOS 开源库分析<sup>36</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-理论基础/" title="iOS 理论基础">iOS 理论基础<sup>14</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-进阶/" title="iOS 进阶">iOS 进阶<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/个人收藏/" title="个人收藏">个人收藏<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/代码规范/" title="代码规范">代码规范<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/其他/" title="其他">其他<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/博客分类目录/" title="博客分类目录">博客分类目录<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/叨叨系列/" title="叨叨系列">叨叨系列<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/开源代码分析/" title="开源代码分析">开源代码分析<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/开源库分析/" title="开源库分析">开源库分析<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/树莓派/" title="树莓派">树莓派<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/版本控制/" title="版本控制">版本控制<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/直播/" title="直播">直播<sup>6</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/iOS-开源库分析/" title="iOS 开源库分析">iOS 开源库分析<sup>36</sup></a></li>
			
		
			
				<li><a href="/tags/Android-设计模式/" title="Android 设计模式">Android 设计模式<sup>29</sup></a></li>
			
		
			
				<li><a href="/tags/Objective-C-相关/" title="Objective C 相关">Objective C 相关<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/Android基础/" title="Android基础">Android基础<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/AOSP-源码/" title="AOSP 源码">AOSP 源码<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/Android-常用第三方库/" title="Android 常用第三方库">Android 常用第三方库<sup>15</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-理论基础/" title="iOS 理论基础">iOS 理论基础<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo-使用/" title="Hexo 使用">Hexo 使用<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/ROS/" title="ROS">ROS<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Android-动画进阶/" title="Android 动画进阶">Android 动画进阶<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Android-JNI/" title="Android JNI">Android JNI<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-绘图进阶/" title="Android 绘图进阶">Android 绘图进阶<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android性能优化/" title="Android性能优化">Android性能优化<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-自动化测试/" title="Android 自动化测试">Android 自动化测试<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/OpenCV/" title="OpenCV">OpenCV<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/直播/" title="直播">直播<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-开源源码/" title="Android 开源源码">Android 开源源码<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Android-自定义View进阶/" title="Android 自定义View进阶">Android 自定义View进阶<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/树莓派/" title="树莓派">树莓派<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-进阶/" title="iOS 进阶">iOS 进阶<sup>4</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://hexo.io" target="_blank" title="Hexo">Hexo</a>
            
          </li>
        
          <li>
            
            	<a href="https://pages.github.com/" target="_blank" title="GitHub">GitHub</a>
            
          </li>
        
          <li>
            
            	<a href="http://pf18.github.io/" target="_blank" title="PF18">PF18</a>
            
          </li>
        
          <li>
            
            	<a href="http://toutiao.io/" target="_blank" title="开发者头条">开发者头条</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.jcodecraeer.com/" target="_blank" title="泡在网上的日子">泡在网上的日子</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="atom.xml" target="_blank" title="rss">RSS</a>
</div>

  
  <div class="tagcloudlist">
    <p class="asidetitle">Tag Cloud</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/AOSP-%E6%BA%90%E7%A0%81/" style="font-size: 17.14px;">AOSP 源码</a> <a href="/tags/Android-APK-%E7%AD%BE%E5%90%8D/" style="font-size: 10px;">Android APK 签名</a> <a href="/tags/Android-JNI/" style="font-size: 12.86px;">Android JNI</a> <a href="/tags/Android-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E8%BF%9B%E9%98%B6/" style="font-size: 10.71px;">Android 事件处理进阶</a> <a href="/tags/Android-%E5%8A%A8%E7%94%BB%E8%BF%9B%E9%98%B6/" style="font-size: 13.57px;">Android 动画进阶</a> <a href="/tags/Android-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91/" style="font-size: 10px;">Android 多线程开发</a> <a href="/tags/Android-%E5%B0%8F%E7%BB%8F%E9%AA%8C/" style="font-size: 10px;">Android 小经验</a> <a href="/tags/Android-%E5%B8%B8%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/" style="font-size: 16.43px;">Android 常用第三方库</a> <a href="/tags/Android-%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" style="font-size: 10px;">Android 开发流程</a> <a href="/tags/Android-%E5%BC%80%E6%BA%90%E6%BA%90%E7%A0%81/" style="font-size: 12.14px;">Android 开源源码</a> <a href="/tags/Android-%E7%BB%98%E5%9B%BE%E8%BF%9B%E9%98%B6/" style="font-size: 12.86px;">Android 绘图进阶</a> <a href="/tags/Android-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" style="font-size: 12.86px;">Android 自动化测试</a> <a href="/tags/Android-%E8%87%AA%E5%AE%9A%E4%B9%89View%E8%BF%9B%E9%98%B6/" style="font-size: 12.14px;">Android 自定义View进阶</a> <a href="/tags/Android-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 19.29px;">Android 设计模式</a> <a href="/tags/Android%E5%85%B6%E4%BB%96/" style="font-size: 10px;">Android其他</a> <a href="/tags/Android%E5%9F%BA%E7%A1%80/" style="font-size: 17.86px;">Android基础</a> <a href="/tags/Android%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" style="font-size: 10px;">Android开发流程</a> <a href="/tags/Android%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size: 12.86px;">Android性能优化</a> <a href="/tags/Android%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF/" style="font-size: 10px;">Android混淆技术</a> <a href="/tags/Android%E8%B4%A8%E9%87%8F%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/" style="font-size: 11.43px;">Android质量管理工具</a> <a href="/tags/Android%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" style="font-size: 10px;">Android逆向工程</a> <a href="/tags/Git-github/" style="font-size: 10px;">Git && github</a> <a href="/tags/Hexo-%E4%BD%BF%E7%94%A8/" style="font-size: 15px;">Hexo 使用</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Linux-%E4%BD%BF%E7%94%A8/" style="font-size: 10px;">Linux 使用</a> <a href="/tags/Objective-C-%E7%9B%B8%E5%85%B3/" style="font-size: 18.57px;">Objective C 相关</a> <a href="/tags/OpenCV/" style="font-size: 12.86px;">OpenCV</a> <a href="/tags/ROS/" style="font-size: 14.29px;">ROS</a> <a href="/tags/iOS-%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" style="font-size: 10.71px;">iOS 工具使用</a> <a href="/tags/iOS-%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%86%E6%9E%90/" style="font-size: 20px;">iOS 开源库分析</a> <a href="/tags/iOS-%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/" style="font-size: 15.71px;">iOS 理论基础</a> <a href="/tags/iOS-%E8%BF%9B%E9%98%B6/" style="font-size: 12.14px;">iOS 进阶</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 10px;">代码规范</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%88%86%E7%B1%BB%E7%9B%AE%E5%BD%95/" style="font-size: 10.71px;">博客分类目录</a> <a href="/tags/%E5%8F%A8%E5%8F%A8%E7%B3%BB%E5%88%97/" style="font-size: 10px;">叨叨系列</a> <a href="/tags/%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" style="font-size: 11.43px;">工具的使用</a> <a href="/tags/%E5%BC%80%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 10.71px;">开源代码分析</a> <a href="/tags/%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%86%E6%9E%90/" style="font-size: 10px;">开源库分析</a> <a href="/tags/%E6%9D%82%E7%B1%BB/" style="font-size: 10px;">杂类</a> <a href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" style="font-size: 12.14px;">树莓派</a> <a href="/tags/%E7%9B%B4%E6%92%AD/" style="font-size: 12.86px;">直播</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/" style="font-size: 10.71px;">编程技巧</a> <a href="/tags/%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F/" style="font-size: 10px;">网站收藏</a> <a href="/tags/%E9%87%8D%E8%A6%81%E6%8E%A7%E4%BB%B6/" style="font-size: 11.43px;">重要控件</a>
    </div>
  </div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
		
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/hsihohuang/kiddochan" target="_blank" title="Kiddochan">Kiddochan</a> © 2022 
		
		<a href="/about" target="_blank" title="Edgar">Edgar</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7c9443b0374f1cf6b1dbb5ab84d939cb";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
