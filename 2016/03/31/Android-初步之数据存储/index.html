
 <!DOCTYPE HTML>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  
    <title>Android 初步之数据存储 | Edgar&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Edgar">
    

    
    <meta name="description" content="Android 中提供了较多的数据存储和交换方式，如SharedPreference+Preference Activity，File，SQLite+Content Provider，以及XML JSON 格式数据解析等。它们各有各的优点，而它们的优点也决定了它们的使用范围。 SharedPreferencesSharedPreferences 类提供给开发人员保存和获取基本数据类型的键值对的方式">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 初步之数据存储">
<meta property="og:url" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/index.html">
<meta property="og:site_name" content="Edgar&#39;s Blog">
<meta property="og:description" content="Android 中提供了较多的数据存储和交换方式，如SharedPreference+Preference Activity，File，SQLite+Content Provider，以及XML JSON 格式数据解析等。它们各有各的优点，而它们的优点也决定了它们的使用范围。 SharedPreferencesSharedPreferences 类提供给开发人员保存和获取基本数据类型的键值对的方式">
<meta property="og:locale">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/1.png">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/2.png">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/4.png">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/5.png">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/7.png">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/8.png">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/9.png">
<meta property="og:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/11.png">
<meta property="article:published_time" content="2016-03-31T13:15:28.000Z">
<meta property="article:modified_time" content="2016-07-18T21:30:36.000Z">
<meta property="article:author" content="Edgar">
<meta property="article:tag" content="Android基础">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/1.png">

    
    <link rel="alternative" href="atom.xml" title="Edgar&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/unnamed4_n_mSY_icon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/profile.png">
    <link rel="apple-touch-icon-precomposed" href="/img/profile.png">
    
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.2.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Edgar&#39;s Blog">Edgar&#39;s Blog</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
 					
					<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" autocomplete="off" name="q" maxlength="20" placeholder="Search" />
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/03/31/Android-初步之数据存储/" title="Android 初步之数据存储" itemprop="url">Android 初步之数据存储</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Edgar" target="_blank" itemprop="author">Edgar</a>
		
  <p class="article-time">
    <time datetime="2016-03-31T13:15:28.000Z" itemprop="datePublished"> Published 2016-03-31</time>
    
  </p>
</header>
	<div class="article-content">
		
		<p>Android 中提供了较多的数据存储和交换方式，如SharedPreference+Preference Activity，File，SQLite+Content Provider，以及XML JSON 格式数据解析等。它们各有各的优点，而它们的优点也决定了它们的使用范围。</p>
<h4 id="SharedPreferences"><a href="#SharedPreferences" class="headerlink" title="SharedPreferences"></a>SharedPreferences</h4><p>SharedPreferences 类提供给开发人员保存和获取基本数据类型的键值对的方式。该类主要用于类似基本类型，等简单变量，在应用程序结束后，数据仍旧会保存。这些数据会以XML文件的形式存储在apk的包里面。</p>
<h5 id="SharedPreferences的获取："><a href="#SharedPreferences的获取：" class="headerlink" title="SharedPreferences的获取："></a>SharedPreferences的获取：</h5><p>SharedPreferences的获取方式有两种:</p>
<ol>
<li>getSharedPreferences()：如果需要多个使用名称来区分的共享文件，则可以使用该方法，其第一参数就是共享文件的名称，对于使用同一个名称获得的多个SharedPreferences引用，其指向同一个对象。</li>
<li>getPreferences()：如果Activity仅需要一个共享文件，则可以使用该方法。因为只有一个文件，它并不需要提供名称。</li>
</ol>
<h5 id="向SharedPreferences类中增加值："><a href="#向SharedPreferences类中增加值：" class="headerlink" title="向SharedPreferences类中增加值："></a>向SharedPreferences类中增加值：</h5><p>完成向SharedPreferences类中增加值的步骤如下：</p>
<ol>
<li>调用SharedPreferences类的edit方法获得SharedPreferences.Editor对象</li>
<li>调用诸如putBoolean()，putString()等方法增加数据</li>
<li>使用commit方法或者apply方法提交新值。</li>
</ol>
<h5 id="写入sharedPreferences"><a href="#写入sharedPreferences" class="headerlink" title="写入sharedPreferences"></a>写入sharedPreferences</h5><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">SharedPreferences  sharedpreference = get<span class="constructor">SharedPreferences(<span class="string">&quot;messageBylinxiaohai&quot;</span>,MODE_PRIVATE)</span>;</span><br><span class="line">Editor editor = sharedpreference.edit<span class="literal">()</span>;</span><br><span class="line">editor.put<span class="constructor">String(<span class="string">&quot;name&quot;</span>,<span class="params">names</span>)</span>;</span><br><span class="line">editor.put<span class="constructor">String(<span class="string">&quot;password&quot;</span>,<span class="params">passwords</span>)</span>;</span><br><span class="line">editor.commit<span class="literal">()</span>;</span><br></pre></td></tr></table></figure>

<h5 id="读出sharedPreferences"><a href="#读出sharedPreferences" class="headerlink" title="读出sharedPreferences"></a>读出sharedPreferences</h5><figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">SharedPreferences sharedPrefereces = getSharedPreferences(<span class="string">&quot;messageBylinxiaohai&quot;</span>,MODE_PRIVATE);</span><br><span class="line">String name = sharedPrefereces.<span class="keyword">get</span><span class="built_in">String</span>(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">String password = sharedPrefereces.<span class="keyword">get</span><span class="built_in">String</span>(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>对于SharedPreferences而言，它使用XML文件来保存数据，文件名与指定的名称相同，存储在data&#x2F;data文件夹下</p>
<h5 id="数据存储模式"><a href="#数据存储模式" class="headerlink" title="数据存储模式"></a>数据存储模式</h5><p>数据存储有三种常见模式:<br>MODE_PRIVATE:私有方式<br>MODE_WORLD_READALE:全局可读<br>MODE_WORD_WRITEABLE:全局可写</p>
<h4 id="Preference-Activity"><a href="#Preference-Activity" class="headerlink" title="Preference Activity"></a>Preference Activity</h4><p>Android 提供了一个用于为应用程序创建系统样式的Preference Screen。它能够确保应用程序中的Preference Activity与本地和其他第三方应用程序中所使用的一致。</p>
<h6 id="Preference-Activity-组成"><a href="#Preference-Activity-组成" class="headerlink" title="Preference Activity 组成"></a>Preference Activity 组成</h6><p>Preference Activity 由4个部分组成:</p>
<ul>
<li>Preferences Screen布局: 一个XML文件，定义了在Preference Screen中显示的层次结构，它指定了要显示的文本以及相关控件等信息。</li>
<li>Preference Activity 和Preference Fragment 分别是 PreferenceActivity 和Preference Fragment 的扩展，用于包含Preference Screen，在Android 3.0之后，Preference Screen包含在Preference Fragment中，而Preference Fragment包含在Preference Activity中。</li>
<li>Preference Header定义:一个XML文件，定义了应用程序的Preference  Fragment 以及用于显示Preference Fragment的层次结构。</li>
<li>SharedPreference 变化监听器:onSharedPreferenceChangeListener类的实现，用于监听SharedPreference 的变化。</li>
</ul>
<h6 id="实现一个Preference-Activity"><a href="#实现一个Preference-Activity" class="headerlink" title="实现一个Preference Activity"></a>实现一个Preference Activity</h6><p>步骤1:定义Preference Screen</p>
<ol>
<li><p>Preference screen定义文件存储在res&#x2F;xml文件夹中.</p>
</li>
<li><p>Preference Screen 定义格式如下:</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">&lt;？<span class="type">xml</span> version=“<span class="number">1.0</span>” encoding=“utf<span class="number">-8</span>”？&gt;</span><br><span class="line">&lt;PreferenceScreen xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt;</span><br><span class="line">&lt;/PreferenceScreen&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>PreferenceScreen 内部还可以嵌套另一个PreferenceScreen ，每个PreferenceScreen 将表示为一个可选的元素，单击它会出现一个新的屏幕。</p>
</li>
<li><p>在每个PreferenceScreen 内部可以包含PreferenceCategory 和 xxxPreference控件<br>PreferenceCategory定义:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">PreferenceCategory</span> <span class="attr">android:title</span>=<span class="string">&quot;SMS助手&quot;</span> &gt;</span></span><br></pre></td></tr></table></figure>
<p>Preference常用控件:</p>
</li>
</ol>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">CheckBoxPreference:复选控件</span></span><br><span class="line"><span class="section">EditTextPreference:允许用户输入一个字符串值作为首选项，在运行时首选项文本将会显示一个文本输入对话框</span></span><br><span class="line">ListPreference 该首选项会显示一个对话框，其中包含了可供选择的值的列表，可以指定不同的数组以包含显示文本和选项值。</span><br><span class="line">MultiSelectListPreference：类似于复选框列表</span><br><span class="line"><span class="section">RingtonePreference:一个专用的列表首选项，显示可供用户选择的可用铃声列表</span></span><br><span class="line"><span class="section">每个Preference控件应当至少包含下列4种属性:</span></span><br><span class="line"><span class="section">android:key:SharePreference 键，所选择的值将会根据相应的键进行记录。</span></span><br><span class="line"><span class="section">android:title:用于表示首选项的显示文本</span></span><br><span class="line"><span class="section">android:summary:在标题文本下方以更小字体显示的更长的文本描述</span></span><br><span class="line"><span class="section">android:defaultValue:当没有为该首选项分配选项值的时候将会显示默认值</span></span><br></pre></td></tr></table></figure>
<p>还可以使用Intent在Preference Screen中导入系统首选项:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">PreferenceScreen</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:summary</span>=<span class="string">&quot;System Preference imported using an intent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:title</span>=<span class="string">&quot;Intent Preference&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent</span> <span class="attr">android:action</span>=<span class="string">&quot;android.settings.DISPLAY_SETTINGS&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>下方为定义一个Preference Screen的一个例子。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">PreferenceScreen</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:defaultValue</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:key</span>=<span class="string">&quot;autoBack&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summaryOff</span>=<span class="string">&quot;关闭&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summaryOn</span>=<span class="string">&quot;开启&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;自动回复&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PreferenceCategory</span> <span class="attr">android:title</span>=<span class="string">&quot;SMS助手&quot;</span> &gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:defaultValue</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:key</span>=<span class="string">&quot;smsSilence&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:summaryOff</span>=<span class="string">&quot;关闭&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:summaryOn</span>=<span class="string">&quot;开启&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">&quot;静音&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">PreferenceScreen</span> <span class="attr">android:title</span>=<span class="string">&quot;更多选项&quot;</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:defaultValue</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;cb21&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOff</span>=<span class="string">&quot;关闭&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOn</span>=<span class="string">&quot;开启&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;功能1&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">CheckBoxPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:defaultValue</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;cb22&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOff</span>=<span class="string">&quot;停用&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summaryOn</span>=<span class="string">&quot;使用&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;功能2&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ListPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:dialogTitle</span>=<span class="string">&quot;请选择论坛&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:entries</span>=<span class="string">&quot;@array/listentry&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:entryValues</span>=<span class="string">&quot;@array/listvalue&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;list1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summary</span>=<span class="string">&quot;开发者论坛&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;android form&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">EditTextPreference</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:defaultValue</span>=<span class="string">&quot;Hello EditTextPreference&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:dialogTitle</span>=<span class="string">&quot;设置输入&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:key</span>=<span class="string">&quot;et1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:summary</span>=<span class="string">&quot;点击输入&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:title</span>=<span class="string">&quot;EditTextPreference Simple&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">PreferenceCategory</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PreferenceCategory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RingtonePreference</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:key</span>=<span class="string">&quot;rt1&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:summary</span>=<span class="string">&quot;选择铃声&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:title</span>=<span class="string">&quot;RingtonePreference Sample&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">PreferenceCategory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">PreferenceScreen</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summary</span>=<span class="string">&quot;System Preference imported using an intent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;Intent Preference&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">intent</span> <span class="attr">android:action</span>=<span class="string">&quot;android.settings.DISPLAY_SETTINGS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">PreferenceScreen</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>步骤2  实现Preference Fragment</p>
<ol>
<li>继承PreferenceFragment</li>
<li>在onCreate方法中调用addPreferencesFromResource。如下所示:</li>
</ol>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">PreferenceFragment</span></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) &#123;</span><br><span class="line">	<span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">	addPreferencesFromResource(<span class="type">R</span>.xml.setting);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>步骤3  创建Preferece Header</p>
<p>Preference Header 描述了Preference Fragment在Preference Activity中如何分组和显示，每个头都表示并允许显示一个特定的Preference Fragment。<br>Preference Header是XML资源，存储在res&#x2F;xml文件中，每个头的资源ID就是它的文件名。每个Preference Header都必须与一个特定的Preference Fragment关联，当选中该头的时候，Fragment就会显示出来，必须指定Preference Header的标题，还可以包含一个摘要和图片资源。还可以使用一个Intent调用.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">preference-headers</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fragment</span>=<span class="string">&quot;com.example.testpreferencefragment.UserSettings&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:summary</span>=<span class="string">&quot;系统设置&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">&quot;Setting&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">intent</span>  <span class="attr">android:action</span>=<span class="string">“android:settings.DISPLAY_SETTINGS”</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">preference-headers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>步骤4  实现Preference Activity</p>
<p>Preference Activity类用于包含由Preference Header资源定义的PreferenceFragment 层次结构。</p>
<ul>
<li>继承PreferenceActivity<br>public class MainActivity extends PreferenceActivity</li>
<li>去掉onCreate的实现</li>
<li>重写onBuildHeaders方法，在其中调用loadHeadersFromResource并指定一个Preference Header资源文件。</li>
</ul>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public void on<span class="constructor">BuildHeaders(List&lt;Header&gt; <span class="params">target</span>)</span> &#123;</span><br><span class="line">    load<span class="constructor">HeadersFromResource(R.<span class="params">xml</span>.<span class="params">preferenceheader</span>, <span class="params">target</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在Manifest清单文件中注册PreferenceActivity</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.testpreferencefragment.UserSettingActivity&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>为了显示在该Activity中包含的应用程序设置，需要调用startActivity或者startActivityForResult打开它。</li>
</ul>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">UserSettingActivity</span> <span class="keyword">extends</span> <span class="title">PreferenceActivity</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    public void onBuildHeaders(<span class="type">List</span>&lt;<span class="type">Header</span>&gt; target) &#123;</span><br><span class="line">        loadHeadersFromResource(<span class="type">R</span>.xml.preferenceheader, target);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> boolean isValidFragment(<span class="type">String</span> fragmentName) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>使用Preference Screen设置的Shared Preference：</li>
</ol>
<p>包括Activity ，Service 和BroadCast Receiver都能访问存储在应用程序沙袋中的Shered Preference值。可以使用如下方法:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">SharedPreferences prefs = <span class="module-access"><span class="module"><span class="identifier">PreferenceManager</span>.</span></span>get<span class="constructor">DefaultSharedPreferences(<span class="params">getApplicationContext</span>()</span>);</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>设置监听器</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">mSharedPreference = <span class="module-access"><span class="module"><span class="identifier">PreferenceManager</span>.</span></span>get<span class="constructor">DefaultSharedPreferences(<span class="params">this</span>)</span>;</span><br><span class="line">mSharedPreference.register<span class="constructor">OnSharedPreferenceChangeListener(<span class="params">new</span> OnSharedPreferenceChangeListener()</span> &#123;</span><br><span class="line">    public void on<span class="constructor">SharedPreferenceChanged(SharedPreferences <span class="params">shareferences</span>, String <span class="params">key</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(key.equals(<span class="string">&quot;autoBack&quot;</span>))&#123;</span><br><span class="line">            boolean autoBackStatus = 				</span><br><span class="line">            shareferences.get<span class="constructor">Boolean(<span class="string">&quot;autoBack&quot;</span>, <span class="params">false</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span>(autoBackStatus)&#123;<span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(<span class="string">&quot;PreferenceActivity&quot;</span>,<span class="string">&quot;true&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;<span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(<span class="string">&quot;PreferenceActivity&quot;</span>,<span class="string">&quot;false&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/1.png"></p>
<h4 id="FILE-文件"><a href="#FILE-文件" class="headerlink" title="FILE 文件"></a>FILE 文件</h4><p>文件一般存储在外部存储中：这些外部存储可以被所有应用程序访问，通过USB连接到设备后，可以被挂载到计算机文件系统，外部存储一般位于SD卡上，但是有些设备是在内部存储中将其作为一个独立的分区来实现。当在外部存储介质上存储文件时，对于存储这些文件是没有强制的安全保障的，任何程序都可以访问，重写或者删除这些存储在外部存储中的文件。同时外部存储可能不总是可用的，如果SD卡弹出或者这个设备通过被计算机挂载来访问，应用程序就不能在外部存储上读取文件了。</p>
<h5 id="使用raw文件作为资源"><a href="#使用raw文件作为资源" class="headerlink" title="使用raw文件作为资源"></a>使用raw文件作为资源</h5><p>可以将外部文件资源放置在项目层次结构的res&#x2F;raw文件夹中作为程序所需的外部文件资源，这些资源将在分发包中包含它们。<br>下面是读取raw文件夹下的一个歌词文件的例子，结果如下图，代码如下：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">inputStream = get<span class="constructor">Resources()</span>.<span class="keyword">open</span><span class="constructor">RawResource(R.<span class="params">raw</span>.<span class="params">rawfile</span>)</span>;</span><br><span class="line">Reader reader = <span class="keyword">new</span> <span class="constructor">InputStreamReader(<span class="params">inputStream</span>)</span>; </span><br><span class="line">BufferedReader br = <span class="keyword">new</span> <span class="constructor">BufferedReader(<span class="params">reader</span>)</span>;</span><br><span class="line">String lines = null;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>((lines = br.read<span class="constructor">Line()</span>)!=null)&#123;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">Log</span>.</span></span>i(<span class="string">&quot;MainActivity&quot;</span>, lines);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(inputStream!=null) &#123;</span><br><span class="line">        inputStream.close<span class="literal">()</span>;</span><br><span class="line">        inputStream = null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(br!=null) &#123;</span><br><span class="line">        br.close<span class="literal">()</span>;</span><br><span class="line">        br = null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; catch (IOException e) &#123;</span><br><span class="line">    e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/2.png"></p>
<p>在Android中使用File对象存储数据主要有两种方式：</p>
<p>1.使用Java提供的IO流体系<br>使用FileOutputStream类提供的openFileOutput()方法来打开相应的输出流。使用FileInputStream类提供的openFileInput()方法打开相应的输入流，默认情况下使用IO流保存的文件仅对当前应用程序可见，也就是仅仅能够从应用程序沙箱中读写文件，指定路径分隔符将会导致抛出一个异常，如果用户卸载了该应用程序，则保护数据文件也会一起被删除。<br>在创建FileOutputstream的时候，如果指定的文件名不存在，Android将会创建一个新的文件，如果文件已经存在那么默认的行为就是覆盖它，如果想要在已经存在的文件末尾添加内容，可以指定其模式为MODE_APPEND.<br>如果要将这些文件分享给其他应用可用可以使用Content Provider或者在创建的时候使用：MODE_WORLD_WRITEABLE和MODE_READABLE.<br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/4.png"><br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/5.png"></p>
<p>如果应用程序需要缓存临时文件，Android提供了可以管理的内部缓存和一个不能管理的外部缓存，分别调用getCacheDir和getExtenalCacheDir方法可以从当前的上下文中访问它们。<br>存储在任何一个该缓存位置中的文件在应用程序被卸载后都会被删除掉，当系统运行在低可用存储空间的时候，存储在内部缓存的文件可能被系统所删除，存储在外部缓存中的文件则不会被删除掉，因为系统不会跟踪外部媒介的可用存储空间。</p>
<p>使用Environment类提供的getExternalStorageDirectory方法对Android的SD卡进行数据读写。每个Android设备都支持共享的外部存储用来保存文件，这可以是SD卡等可以移除的存储介质，也可以是手机内存等不可移除的存储介质，保存的外部存储文件都是全局可读的，并且在用户使用USB连接电脑后可以修改这些文件。</p>
<p>使用Environment.getExtralStoragePublicDirectory可以用来找到存储应用程序文件的路径，返回的位置为用户通常存放和管理各类文件的位置。</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">DIRECTORY_ALARMS:</span>用户可选的警示音的可用的声音文件</span><br><span class="line"><span class="symbol">DIRECTORY_RINGTONES:</span>用户可选的铃声的可用的声音文件</span><br><span class="line"><span class="symbol">DIRECTORY_NOTIFICATIONS:</span>用户可选的通知音的可用的声音文件</span><br><span class="line"><span class="symbol">DIRECTORY_DCIM:</span>拍摄到的图片和视频</span><br><span class="line"><span class="symbol">DIRECTORY_PICTURES:</span>图片</span><br><span class="line"><span class="symbol">DIRECTORY_DOWNLOADS:</span>用户下载的文件</span><br><span class="line"><span class="symbol">DIRECTORY_MOVIES:</span>电影</span><br></pre></td></tr></table></figure>

<p>如果返回的目录不存在，必须在向该目录写入文件前先创建它。<br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/7.png"><br><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/8.png"></p>
<h4 id="SQLite-Content-Provider"><a href="#SQLite-Content-Provider" class="headerlink" title="SQLite + Content Provider"></a>SQLite + Content Provider</h4><h5 id="SQLite数据库"><a href="#SQLite数据库" class="headerlink" title="SQLite数据库"></a>SQLite数据库</h5><p>Android 通过结合使用SQLite数据库和Content Provider，提供了结构化数据的持久化功能。<br>Android应用程序的数据库存储在&#x2F;data&#x2F;data&#x2F;包名&#x2F;database，所有的数据库都是私有的，只能被创建它们的应用程序访问。<br>SQLite 数据库已经被实现为简洁的C语言库，并且是Android软件栈的一部分。通过作为一个库实现，而不是作为一个独立的进程不断执行，每个SQLite数据库成为创建它的应用程序的完整部分，这样做能够减少应用程序的外部依赖性，最小延迟，并简化事务锁定和同步。<br>SQLite在列定义中使用了一种松散类型的方式，即并不要求一列中的所有值都是同一种类型。</p>
<h5 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h5><p>在使用数据库的时候，最好将底层数据库封装起来，只公开与数据库进行交互时必须使用的公有方法和常量，这一般会用到辅助类，这个类用于公开数据库常量，特别是列名等公共元素。</p>
<p>SQLiteOpenHelper是一个抽象类，可以用来实现创建，打开，升级数据库等操作。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBOpenHelper</span> <span class="keyword">extends</span> <span class="title class_">SQLiteOpenHelper</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DBOpenHelper</span><span class="params">(Context context, String name, <span class="type">int</span> version)</span> &#123;</span><br><span class="line">	    <span class="built_in">super</span>(context, name, <span class="literal">null</span>, version);</span><br><span class="line">	    <span class="built_in">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(SQLiteDatabase db)</span> &#123;</span><br><span class="line">	    db.execSQL(AppConstant.CREATE_TABLE);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="type">int</span> oldVersion, <span class="type">int</span> newVersion)</span> &#123;</span><br><span class="line">	    db.execSQL(<span class="string">&quot;drop table if exists&quot;</span> + AppConstant.TABLE_NAME);</span><br><span class="line">	    onCreate(db);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="创建数据库所需的辅助常量"><a href="#创建数据库所需的辅助常量" class="headerlink" title="创建数据库所需的辅助常量"></a>创建数据库所需的辅助常量</h5><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConstant</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> DATABASE_NAME = <span class="string">&quot;userdatabase.db&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">int</span> DATABASE_VERSION = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> TABLE_NAME = <span class="string">&quot;usertable&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> USER_NAME = <span class="string">&quot;username&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> USER_PWD = <span class="string">&quot;userpwd&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> ID = <span class="string">&quot;_id&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> CREATE_TABLE = <span class="string">&quot;create table &quot;</span>+TABLE_NAME+<span class="string">&quot;(&quot;</span>+ID+<span class="string">&quot; integer primary key autoincrement, &quot;</span>+USER_NAME+<span class="string">&quot;  text not null, &quot;</span>+USER_PWD+<span class="string">&quot; text not null );&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="创建数据库操作类"><a href="#创建数据库操作类" class="headerlink" title="创建数据库操作类"></a>创建数据库操作类</h5><p>一般使用一个专门的类来执行对数据库条目的增删查改操作:<br>下面为数据库操作类的实现源码:</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> DBOperator &#123;</span><br><span class="line">    private SQLiteDatabase <span class="keyword">database</span> = <span class="keyword">null</span>;</span><br><span class="line">    private DBOpenHelper helper = <span class="keyword">null</span>;</span><br><span class="line">    private Context context = <span class="keyword">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">public</span> DBOperator(Context context) &#123;</span><br><span class="line">        helper = <span class="built_in">new</span> DBOpenHelper(context, AppConstant.DATABASE_NAME, AppConstant.DATABASE_VERSION);</span><br><span class="line">        <span class="keyword">database</span> = helper.getWritableDatabase();</span><br><span class="line">        this.context = context; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> String DataBasequry(String <span class="type">name</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Cursor</span> c = <span class="keyword">database</span>.query(AppConstant.<span class="built_in">TABLE_NAME</span>,<span class="keyword">null</span> ,AppConstant.USER_NAME+&quot;= ?&quot;,<span class="built_in">new</span> String[]&#123;<span class="type">name</span>&#125;, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        <span class="type">int</span> count = c.getCount();</span><br><span class="line">        <span class="keyword">if</span>(count&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            c.moveToFirst();</span><br><span class="line">            String pwd = c.getString(c.getColumnIndex(AppConstant.USER_PWD));</span><br><span class="line">            c.<span class="keyword">close</span>();</span><br><span class="line">            <span class="keyword">return</span> pwd;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            c.<span class="keyword">close</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> String ShowDataBase()&#123;</span><br><span class="line">        <span class="keyword">Cursor</span> c = <span class="keyword">database</span>.query(AppConstant.<span class="built_in">TABLE_NAME</span>,<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        StringBuilder sb = <span class="built_in">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">if</span>(c.getCount()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span>(c.moveToNext()) &#123;</span><br><span class="line">            sb.append(c.getString(c.getColumnIndex(AppConstant.USER_NAME))+&quot;\n&quot;+c.getString(c.getColumnIndex(AppConstant.USER_PWD))+&quot;\n&quot;);</span><br><span class="line">            sb.append(&quot;\n&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        c.<span class="keyword">close</span>();</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> DataBasedelete(String <span class="type">name</span>)&#123;</span><br><span class="line">        <span class="keyword">database</span>.<span class="keyword">delete</span>(AppConstant.<span class="built_in">TABLE_NAME</span>,AppConstant.USER_NAME+&quot;=?&quot;,<span class="built_in">new</span> String[]&#123;<span class="type">name</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> DataBaseinsert(String <span class="type">name</span>,String pwd)&#123;</span><br><span class="line">        ContentValues <span class="keyword">values</span> = <span class="built_in">new</span> ContentValues();</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_NAME, <span class="type">name</span>);</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_PWD, pwd);</span><br><span class="line">        <span class="keyword">database</span>.<span class="keyword">insert</span>(AppConstant.<span class="built_in">TABLE_NAME</span>, <span class="keyword">null</span>, <span class="keyword">values</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> DataBaseupdate(String <span class="type">name</span>,String pwd)&#123;</span><br><span class="line">        ContentValues <span class="keyword">values</span> = <span class="built_in">new</span> ContentValues();</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_NAME, <span class="type">name</span>);</span><br><span class="line">        <span class="keyword">values</span>.put(AppConstant.USER_PWD, pwd);</span><br><span class="line">        <span class="keyword">database</span>.<span class="keyword">update</span>(AppConstant.<span class="built_in">TABLE_NAME</span>, <span class="keyword">values</span> , AppConstant.USER_NAME+&quot;=?&quot;,<span class="built_in">new</span> String[]&#123;<span class="type">name</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Cursor"><a href="#Cursor" class="headerlink" title="Cursor"></a>Cursor</h5><p>数据库查询结果作为Cursor对象返回，Cursor是底层数据库中的结果集指针。Cursor类包含了多个导航函数：</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">moveToFirst </span> 把游标移动到查询结果中的第一行</span><br><span class="line"><span class="keyword">moveToNext </span>把游标向下移动到下一行</span><br><span class="line"><span class="keyword">moveToPrevious </span>把游标向上移动到上一行</span><br><span class="line"><span class="keyword">moveToPosition </span> 把游标移动到指定行</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">getPostion</span> 返回当前游标位置</span><br><span class="line"><span class="attribute">getColumnName</span> 返回指定列索引的名称</span><br><span class="line"><span class="attribute">getColumnNames</span> 返回当前Cursor中所有列名的字符串数组。</span><br><span class="line"><span class="attribute">getCount</span> 返回结果集中的行数</span><br><span class="line"><span class="attribute">getColumnIndexOrThrow</span> 返回具有指定名称的列的索引（如果不存在拥有该名称的列，就会抛出异常），索引从<span class="number">0</span>开始计数。</span><br><span class="line"><span class="attribute">getColumnIndex</span>与上述的方法功能相类似。</span><br></pre></td></tr></table></figure>

<p>当列有可能在一些情况中不存在时，使用getColumnIndex并检查结果是否为-1比较合适，当可以保证所有情况中都存在的时候使用getColumnIndexOrThrow 较为合适。</p>
<h5 id="Content-Provider-内容提供者"><a href="#Content-Provider-内容提供者" class="headerlink" title="Content Provider 内容提供者"></a>Content Provider 内容提供者</h5><p>Content Provider 提供了一个接口用来发布数据，通过Content Resolver来使用该数据，从而将使用数据的应用程序组件和底层的数据源分开。并提供了一种通用机制来允许一个应用程序共享它们的数据或者使用其他应用程序提供的数据。<br>Content Provider  内部如何保存数据由其设计者决定，但是所有的Content Provider 都实现一组通用的方法用来提供数据的增，删，查，改功能。<br>客户端通常不会直接调用这些方法，大多数是通过Content Resolver 对象实现对Content Provider 的操作，开发人员可以通过调用Activity或者其他应用程序组件的实现类中的getContentResolver来获取ContentResolver对象。</p>
<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/9.png"></p>
<h5 id="自定义Content-Provider"><a href="#自定义Content-Provider" class="headerlink" title="自定义Content Provider"></a>自定义Content Provider</h5><ul>
<li>创建一个Content Provider抽象类的子类:</li>
</ul>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyContentProvider</span> <span class="keyword">extends</span> <span class="title">ContentProvider</span> </span></span><br></pre></td></tr></table></figure>
<p>这时候会有如下方法需要重写:</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">boolean</span> <span class="title function_">onCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title class_">Cursor</span> <span class="title function_">query</span>(<span class="params">Uri uri, <span class="built_in">String</span>[] projection, <span class="built_in">String</span> selection,<span class="built_in">String</span>[] selectionArgs, <span class="built_in">String</span> sortOrder</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title class_">String</span> <span class="title function_">getType</span>(<span class="params">Uri uri</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title class_">Uri</span> <span class="title function_">insert</span>(<span class="params">Uri uri, ContentValues values</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> int <span class="title function_">delete</span>(<span class="params">Uri uri, <span class="built_in">String</span> selection, <span class="built_in">String</span>[] selectionArgs</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> int <span class="title function_">update</span>(<span class="params">Uri uri, ContentValues values, <span class="built_in">String</span> selection,<span class="built_in">String</span>[] selectionArgs</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>注册Content Provider:<br>为了让Content Resolver能够找到Content Provider必须在Android Manifest文件中对其进行注册，Content Provider注册是通过<provider>标签来实现的，必须指定name属性和authorities这两个属性。<br>authorities属性用来标记Content Provider的基本URI。Content Resolver使用它来找到想要交互的数据库。每个authorities必须唯一，因此可以使用应用的包名。</provider></li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;com.example.contentprovider.CustomProvider&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">&quot;com.example.provider.TestContentProvider&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>定义CONTENT_URI</li>
</ul>
<p>每个Content Provider 都需要使用一个公有的静态CONTENT_URI属性来公开它的授权。 CONTENT_URI可以按照如下形式定义:</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">public <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">Uri</span> CONTENT_URI = <span class="built_in">Uri</span>.parse(<span class="string">&quot;content://com.example.provider.TestContentProvider/data&quot;</span>); </span><br></pre></td></tr></table></figure>

<p>直接使用这种形式的查询表示请求所有行，而在结尾附加&#x2F;rownumber的查询如： </p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">content:<span class="regexp">//</span>com.example.provider.TestContentProvider<span class="regexp">/data/</span><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>所示表示请求一条记录。</p>
<ul>
<li>使用UriMatcher来解析URI请求:</li>
</ul>
<p>通过解析可以确定这个URI是请求所有数据还是单行数据。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SINGLE_ROW</span> <span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MULTI_ROWS</span> <span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">UriMatcher</span> <span class="variable">matcher</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">static</span>&#123;</span><br><span class="line">    matcher = <span class="keyword">new</span> <span class="title class_">UriMatcher</span>(UriMatcher.NO_MATCH);</span><br><span class="line">    matcher.addURI(<span class="string">&quot;com.example.provider.TestContentProvider&quot;</span>,<span class="string">&quot;data&quot;</span>, MULTI_ROWS);</span><br><span class="line">    matcher.addURI(<span class="string">&quot;com.example.provider.TestContentProvider&quot;</span>, <span class="string">&quot;data/#&quot;</span>, SINGLE_ROW);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现SQLiteOpenHelper 子类<br>该部分实现见SQL总结部分。代码如下：<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBConstant</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> DATABASE_NAME = <span class="string">&quot;mydatabase.db&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">int</span> DATABASE_VERSION = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> TABLE_NAME = <span class="string">&quot;testtable&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> ID=<span class="string">&quot;_id&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> USERNAME=<span class="string">&quot;name&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> PASSWORD=<span class="string">&quot;pwd&quot;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="type">static</span> <span class="keyword">final</span> <span class="type">String</span> CREATE_TABLE=</span><br><span class="line">	<span class="string">&quot;create table &quot;</span>+TABLE_NAME+<span class="string">&quot;(&quot;</span></span><br><span class="line">			+ID +<span class="string">&quot; integer primary key autoincrement,&quot;</span></span><br><span class="line">			+USERNAME+<span class="string">&quot; text not null,&quot;</span></span><br><span class="line">			+PASSWORD+<span class="string">&quot; text not null&quot;</span></span><br><span class="line">	+<span class="string">&quot;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DBOpenHelper</span> extends SQLiteOpenHelper &#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">DBOpenHelper</span><span class="params">(Context context, <span class="type">String</span> name,</span></span></span><br><span class="line"><span class="params"><span class="function">			<span class="type">int</span> version)</span> </span>&#123;</span><br><span class="line">		<span class="built_in">super</span>(context, name, null, version);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">onCreate</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</span><br><span class="line">		db.<span class="built_in">execSQL</span>(DBConstant.CREATE_TABLE);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="type">int</span> oldVersion, <span class="type">int</span> newVersion)</span> </span>&#123;</span><br><span class="line">		db.<span class="built_in">execSQL</span>(<span class="string">&quot;drop table if exists &quot;</span>+DBConstant.TABLE_NAME);</span><br><span class="line">		<span class="built_in">onCreate</span>(db);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>实现Content Provider抽象类中的方法:</li>
</ul>
<p>构造底层数据库</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">DBOpenHelper</span> <span class="variable">mOpenHelper</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="type">SQLiteDatabase</span> <span class="variable">database</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreate</span><span class="params">()</span> &#123;</span><br><span class="line">	mOpenHelper = <span class="keyword">new</span> <span class="title class_">DBOpenHelper</span>(getContext(),DBConstant.DATABASE_NAME,DBConstant.DATABASE_VERSION);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里并不打开数据库，直到需到执行一个查询或者事务的时候再打开。</p>
<ul>
<li>实现查询方法</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Cursor <span class="title">query</span><span class="params">(Uri uri, <span class="type">String</span>[] projection, <span class="type">String</span> selection,</span></span></span><br><span class="line"><span class="params"><span class="function">		    <span class="type">String</span>[] selectionArgs, <span class="type">String</span> sortOrder)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	database = mOpenHelper.<span class="built_in">getWritableDatabase</span>();</span><br><span class="line"></span><br><span class="line">	SQLiteQueryBuilder querybuilder = <span class="keyword">new</span> <span class="built_in">SQLiteQueryBuilder</span>();</span><br><span class="line">	querybuilder.<span class="built_in">setTables</span>(DBConstant.DATABASE_NAME);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> (matcher.<span class="built_in">match</span>(uri)) &#123;</span><br><span class="line">        <span class="keyword">case</span> SINGLE_ROW:</span><br><span class="line">            <span class="type">String</span> rowID = uri.<span class="built_in">getPathSegments</span>().<span class="built_in">get</span>(<span class="number">1</span>);</span><br><span class="line">            querybuilder.<span class="built_in">appendWhere</span>(DBConstant.ID+<span class="string">&quot; = &quot;</span>+rowID);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Cursor cursor = querybuilder.<span class="built_in">query</span>(database, projection, selection, 	selectionArgs,null,null, sortOrder);</span><br><span class="line">	<span class="keyword">return</span> cursor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现getType方法<br>如果要处理的数据类型是一种比较新的数据类型，实现查询后，还必须指定一个MIME类型来标识返回的数据，通过重写getType方法来返回唯一地描述该数据类型的字符串，返回的数据类型包括两种形式<br>单一项:</li>
</ul>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">vnd.android.<span class="built_in">cursor</span>.item/vnd.<span class="symbol">&lt;companyname&gt;</span>.<span class="symbol">&lt;contenttype&gt;</span></span><br></pre></td></tr></table></figure>

<p>所有项:</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">vnd.android.<span class="built_in">cursor</span>.dir/vnd.<span class="symbol">&lt;companyname&gt;</span>.<span class="symbol">&lt;contenttype&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="type">String</span> <span class="title">getType</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">switch</span> (matcher.<span class="built_in">match</span>(uri)) &#123;</span><br><span class="line">	<span class="keyword">case</span> SINGLE_ROW: <span class="keyword">return</span> <span class="string">&quot;vnd.android.cursor.item/vnd.example.data&quot;</span>;</span><br><span class="line">	<span class="keyword">case</span> MULTI_ROWS: <span class="keyword">return</span> <span class="string">&quot;vnd.android.cursor.dir/vnd.example.data&quot;</span>;</span><br><span class="line">	<span class="keyword">default</span>: <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">IllegalArgumentException</span>(<span class="string">&quot;不支持当前Uri:&quot;</span>+uri);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>实现插入操作:</li>
</ul>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> Uri <span class="keyword">insert</span>(Uri uri, ContentValues <span class="keyword">values</span>) &#123;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">database</span> = mOpenHelper.getWritableDatabase();</span><br><span class="line">	long id = <span class="keyword">database</span>.<span class="keyword">insert</span>(DBConstant.<span class="built_in">TABLE_NAME</span>, <span class="keyword">null</span>, <span class="keyword">values</span>);</span><br><span class="line">	<span class="keyword">if</span>(id &gt; <span class="number">-1</span>)&#123;</span><br><span class="line">		Uri insertUri = ContentUris.withAppendedId(uri, id);</span><br><span class="line">		getContext().getContentResolver().notifyChange(insertUri, </span><br><span class="line">		<span class="keyword">null</span>);</span><br><span class="line">		<span class="keyword">return</span> insertUri;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现更新操作</li>
</ul>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">public <span class="built_in">int</span> update(<span class="built_in">Uri</span> uri, ContentValues values, <span class="built_in">String</span> selection,</span><br><span class="line">			<span class="built_in">String</span>[] selectionArgs) &#123;</span><br><span class="line">		</span><br><span class="line">	database = mOpenHelper.getWritableDatabase();</span><br><span class="line">	<span class="keyword">switch</span> (matcher.match(uri)) &#123;</span><br><span class="line">	<span class="keyword">case</span> SINGLE_ROW:</span><br><span class="line">	<span class="built_in">String</span> rowId = uri.getPathSegments().<span class="keyword">get</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">String</span> whereID = DBConstant.ID +<span class="string">&quot; = &quot;</span>+rowId;</span><br><span class="line">	selection = ((selection == <span class="keyword">null</span>) ? selection:(whereID + <span class="string">&quot; AND &quot;</span>+<span class="string">&quot;(&quot;</span>+selection+<span class="string">&quot;)&quot;</span>));</span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="built_in">int</span> updateCount = database.update(DBConstant.TABLE_NAME,values, </span><br><span class="line">					selection,selectionArgs);</span><br><span class="line">	getContext().getContentResolver().notifyChange(uri, <span class="keyword">null</span>);</span><br><span class="line">	<span class="keyword">return</span> updateCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现删除操作:</li>
</ul>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">public <span class="built_in">int</span> delete(<span class="built_in">Uri</span> uri, <span class="built_in">String</span> selection, <span class="built_in">String</span>[] selectionArgs) &#123;</span><br><span class="line">	database = mOpenHelper.getWritableDatabase();</span><br><span class="line">	<span class="keyword">switch</span> (matcher.match(uri)) &#123;</span><br><span class="line">	<span class="keyword">case</span> SINGLE_ROW:</span><br><span class="line">	<span class="built_in">String</span> rowId = uri.getPathSegments().<span class="keyword">get</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">String</span> whereId = DBConstant.ID+<span class="string">&quot; = &quot;</span>+rowId;</span><br><span class="line">	selection = (TextUtils.isEmpty(selection) ?  </span><br><span class="line">		selection:<span class="string">&quot;( &quot;</span>+selection+<span class="string">&quot; )&quot;</span>+ <span class="string">&quot; AND &quot;</span>+whereId);    <span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="keyword">if</span> (selection==<span class="keyword">null</span>) &#123;selection=<span class="string">&quot;1&quot;</span>;&#125;</span><br><span class="line">	<span class="built_in">int</span> deleteCount = database.delete(DBConstant.TABLE_NAME, selection,selectionArgs);</span><br><span class="line">	getContext().getContentResolver().notifyChange(uri, <span class="keyword">null</span>);</span><br><span class="line">	<span class="keyword">return</span> deleteCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>要想返回删除项的数量，必须指定一条where子句，要删除所有行并返回一个值，则传入”1”</p>
<ul>
<li>将当前Content Provider公开，并设置读写权限 ：<br>首选定义readPermission:</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span>  <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.READPROVIDER“</span></span></span><br><span class="line"><span class="string"><span class="tag">android:protectionLevel=&quot;</span><span class="attr">normal</span>&quot; &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">permission</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>定义writePermission:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.WRITEPROVIDER&quot;</span>        </span></span><br><span class="line"><span class="tag"><span class="attr">android:protectionLevel</span>=<span class="string">&quot;normal&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">permission</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>将权限添加到Content provider</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;provider………. </span><br><span class="line">    name和 authorities定义</span><br><span class="line">    android:readPermission=<span class="string">&quot;com.example.provider.TestContentProvider.permission.READPROVIDER&quot;</span>          </span><br><span class="line">    android:writePermission=<span class="string">&quot;com.example.provider.TestContentProvider.permission.WRITEPROVIDER&quot;</span></span><br><span class="line">    android:exported=<span class="string">&quot;true&quot;</span> &gt;</span><br><span class="line">&lt;/provider&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Content-Resolver"><a href="#Content-Resolver" class="headerlink" title="Content Resolver"></a>Content Resolver</h4><p>当使用Content Provider公开数据到时候,Content Resoler是用来在这些Content Provider上进行查询和执行事务对应的类。Content Resolver 可以找到指定的ContentProvider并获取到Content Provider的数据。Content Resolver在开始的时候，Android系统将确定查询所需的ContentProvider ，并确认它是否启动并运行它。android系统负责初始化所有的内容提供者，不需要用户自己去创建。实际上Content Provider用户都不能直接访问到Content Provider实例，只能通过ContentResolver在中间代理。<br> 每个应用程序都有一个ContentResolver实例，可使用getContentResolver方法来获取。</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">ContentResolver  resolver <span class="operator">=</span> getContentResolver()<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<h5 id="使用Content-Resolver访问自定义的Provider"><a href="#使用Content-Resolver访问自定义的Provider" class="headerlink" title="使用Content Resolver访问自定义的Provider"></a>使用Content Resolver访问自定义的Provider</h5><ul>
<li>添加权限：</li>
</ul>
<p>由于上述自定义的Content Provider设置了权限，因此要访问它的Resolver必须添加对应的权限才能访问，权限添加如下：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.READPROVIDER&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.provider.TestContentProvider.permission.WRITEPROVIDER&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>实现与Provider的接口</li>
</ul>
<p>为了验证能够通过一个应用访问另一个应用开放的内容提供者，编写了一个TestContentResolver程序来访问之前实现的TestContentProvider，两者关系如下图， TestContentResolver使用CONTENT_URI从找到对应的内容提供者，当TestContentResolver执行query方法的时候TestContentProvider 便会对应得调用自己的Content Provider.query方法。</p>
<p><img src="/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/11.png"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> <span class="keyword">implements</span> <span class="title class_">OnClickListener</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ID</span> <span class="operator">=</span> <span class="string">&quot;_id&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">USERNAME</span> <span class="operator">=</span> <span class="string">&quot;name&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">PASSWORD</span> <span class="operator">=</span> <span class="string">&quot;pwd&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Uri</span> <span class="variable">CONTENT_URI</span> <span class="operator">=</span> Uri</span><br><span class="line">			.parse(<span class="string">&quot;content://com.example.provider.TestContentProvider/data&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mInsertBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mDeleteBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mQueryBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mUpdateBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">Button</span> <span class="variable">mDeleteAllBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">TextView</span> <span class="variable">mShowResultTv</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">EditText</span> <span class="variable">mNameET</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">EditText</span> <span class="variable">mPasswordET</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">ContentResolver</span> <span class="variable">resolver</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">		<span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">		setContentView(R.layout.activity_main);</span><br><span class="line">		mInsertBtn = (Button) findViewById(R.id.insertBtn);</span><br><span class="line">		mDeleteBtn = (Button) findViewById(R.id.deleteBtn);</span><br><span class="line">		mDeleteAllBtn = (Button) findViewById(R.id.deleteAllBtn);</span><br><span class="line">		mQueryBtn = (Button) findViewById(R.id.queryBtn);</span><br><span class="line">		mUpdateBtn = (Button) findViewById(R.id.updateBtn);</span><br><span class="line">		mShowResultTv = (TextView) findViewById(R.id.showResultTv);</span><br><span class="line">		mNameET = (EditText) findViewById(R.id.nameEd);</span><br><span class="line">		mPasswordET = (EditText) findViewById(R.id.pwdEd);</span><br><span class="line"></span><br><span class="line">		mInsertBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mDeleteBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mDeleteAllBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mQueryBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">		mUpdateBtn.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">		resolver = getContentResolver();</span><br><span class="line">		mShowResultTv.setText(showResult());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">		<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> mNameET.getText().toString().trim();</span><br><span class="line">		<span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> mPasswordET.getText().toString().trim();</span><br><span class="line">		<span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">		<span class="keyword">case</span> R.id.queryBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name)) &#123;</span><br><span class="line">				<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> queryProviderbyName(name);</span><br><span class="line">				<span class="keyword">while</span> (cursor.moveToNext()) &#123;</span><br><span class="line">					Toast.makeText(</span><br><span class="line">							MainActivity.<span class="built_in">this</span>,</span><br><span class="line">							name</span><br><span class="line">									+ <span class="string">&quot;的密码为:&quot;</span></span><br><span class="line">									+ cursor.getString(cursor</span><br><span class="line">											.getColumnIndex(PASSWORD)),</span><br><span class="line">							Toast.LENGTH_LONG).show();</span><br><span class="line">				&#125;</span><br><span class="line">				cursor.close();</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;请输入要查询用户的用户名&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.deleteBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name)) &#123;</span><br><span class="line">				deleteProvider(name);</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.deleteAllBtn:</span><br><span class="line">			deleteAllProvider();</span><br><span class="line">			<span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> showResult();</span><br><span class="line">			<span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				mShowResultTv.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.insertBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name) &amp;&amp; !TextUtils.isEmpty(password)) &#123;</span><br><span class="line">				insertProvider(name, password);</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;用户名和密码不能为空&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> R.id.updateBtn:</span><br><span class="line">			<span class="keyword">if</span> (!TextUtils.isEmpty(name) &amp;&amp; !TextUtils.isEmpty(password)) &#123;</span><br><span class="line">				<span class="type">ContentValues</span> <span class="variable">values</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ContentValues</span>();</span><br><span class="line">				values.put(USERNAME, <span class="string">&quot;new_&quot;</span> + name);</span><br><span class="line">				values.put(PASSWORD, <span class="string">&quot;new_&quot;</span> + password);</span><br><span class="line">				updateProvider(name, values);</span><br><span class="line">				mShowResultTv.setText(showResult());</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Cursor <span class="title function_">queryProviderbyName</span><span class="params">(String aname)</span> &#123;</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, USERNAME + <span class="string">&quot;=?&quot;</span>,</span><br><span class="line">				<span class="keyword">new</span> <span class="title class_">String</span>[] &#123; aname &#125;, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">return</span> cursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Cursor <span class="title function_">queryProviderbyId</span><span class="params">(<span class="type">int</span> aid)</span> &#123;</span><br><span class="line">		<span class="type">Uri</span> <span class="variable">rowaddr</span> <span class="operator">=</span> ContentUris.withAppendedId(CONTENT_URI, aid);</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> resolver.query(rowaddr, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">return</span> cursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Cursor <span class="title function_">queryProviderAll</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">cursor</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">return</span> cursor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">insertProvider</span><span class="params">(String aname, String apassword)</span> &#123;</span><br><span class="line">		<span class="type">ContentValues</span> <span class="variable">values</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ContentValues</span>();</span><br><span class="line">		values.put(USERNAME, aname);</span><br><span class="line">		values.put(PASSWORD, apassword);</span><br><span class="line">		resolver.insert(CONTENT_URI, values);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">deleteProvider</span><span class="params">(String aname)</span> &#123;</span><br><span class="line">		resolver.delete(CONTENT_URI, USERNAME + <span class="string">&quot; = ?&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; aname &#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">deleteAllProvider</span><span class="params">()</span> &#123;</span><br><span class="line">		resolver.delete(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">updateProvider</span><span class="params">(String aname, ContentValues avalue)</span> &#123;</span><br><span class="line">		resolver.update(CONTENT_URI, avalue, USERNAME + <span class="string">&quot; = ?&quot;</span>,</span><br><span class="line">				<span class="keyword">new</span> <span class="title class_">String</span>[] &#123; aname &#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String <span class="title function_">showResult</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">		<span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">Cursor</span> <span class="variable">c</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">		<span class="keyword">while</span> (c.moveToNext()) &#123;</span><br><span class="line">			name = c.getString(c.getColumnIndex(USERNAME));</span><br><span class="line">			pwd = c.getString(c.getColumnIndex(PASSWORD));</span><br><span class="line">			sb.append(name + <span class="string">&quot;    &quot;</span> + pwd + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		c.close();</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用CursorLoader实现异步查询"><a href="#使用CursorLoader实现异步查询" class="headerlink" title="使用CursorLoader实现异步查询"></a>使用CursorLoader实现异步查询</h4><p>数据库查询是耗时的操作，对于数据库Content Provider查询来说，最好不要在应用程序的主线程中执行，Android 3.0引入了Loader类来异步加载数据和监控底层数据源的变化。<br>Loader类可以实现从任何数据源加载任何数据类型的数据，其中最常用的为CursorLoader类，它允许针对Content Provider执行异步查询并返回一个结果Cursor<br>CursorLoader能够在Activity或者Fragment中使用Cursor所需的所有管理任务，包括管理Cursor的生命周期以确保在Activity终止的时候关闭Cursor。<br>CursorLoader同样会监控底层查询的改变，所以不需要实现Content Observer。</p>
<ul>
<li>实现Cursor Loader Callback<br>由于LoaderCallback是使用泛型实现的，所以在实现的时候应显示指定加载的类型，如下所示:</li>
</ul>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> <span class="title">implements</span> <span class="title">OnClickListener</span> ,<span class="title">LoaderCallbacks&lt;Cursor&gt;</span>  </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要使用Cursor Loader必须实现如下三个方法:</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">public Loader&lt;Cursor&gt; on<span class="constructor">CreateLoader(<span class="params">int</span> <span class="params">id</span>, Bundle <span class="params">args</span>)</span> &#123;</span><br><span class="line">    <span class="comment">//当Loader被初始化后，调用该方法返回一个Cursor Loader对象。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoadFinished(Loader&lt;<span class="keyword">Cursor</span>&gt; loader, <span class="keyword">Cursor</span> c) &#123;</span><br><span class="line">    //当Loader Manager 已经完成异步查询的时候该方法将会被调用，并把结果<span class="keyword">Cursor</span>作为参数传入，可以这个函数中使用<span class="keyword">Cursor</span>更新UI元素和数据适配器</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoaderReset(Loader&lt;<span class="keyword">Cursor</span>&gt; arg0) &#123;</span><br><span class="line">    //当Loader Manager 重置<span class="keyword">Cursor</span> Loader的时候，会调用该方法会被调用，在该方法中可以释放查询返回数据的引用，并重置相应的UI，但是不需要关闭<span class="keyword">Cursor</span>，Loader Manger会自动完成这个工作</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>使用CursorLoader来替换之前TestContentResolver代码中的showResult() 方法</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">public</span> Loader&lt;<span class="keyword">Cursor</span>&gt; onCreateLoader(<span class="type">int</span> id, Bundle args) &#123;</span><br><span class="line">	CursorLoader loader = <span class="built_in">new</span> CursorLoader(this, </span><br><span class="line">	CONTENT_URI, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">	<span class="keyword">return</span> loader;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoadFinished(Loader&lt;<span class="keyword">Cursor</span>&gt; loader, <span class="keyword">Cursor</span> c) &#123;</span><br><span class="line">	………….</span><br><span class="line">	<span class="keyword">while</span> (c.moveToNext()) &#123;</span><br><span class="line">        <span class="type">name</span> = c.getString(c.getColumnIndex(USERNAME));</span><br><span class="line">        pwd = c.getString(c.getColumnIndex(<span class="keyword">PASSWORD</span>));</span><br><span class="line">        sb.append(<span class="type">name</span> + &quot;    &quot; + pwd + &quot;\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">	mShowResultTv.setText(sb.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="type">void</span> onLoaderReset(Loader&lt;<span class="keyword">Cursor</span>&gt; arg0) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> String <span class="title function_">showResult</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">pwd</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Cursor</span> <span class="variable">c</span> <span class="operator">=</span> resolver.query(CONTENT_URI, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">while</span> (c.moveToNext()) &#123;</span><br><span class="line">        name = c.getString(c.getColumnIndex(USERNAME));</span><br><span class="line">        pwd = c.getString(c.getColumnIndex(PASSWORD));</span><br><span class="line">        sb.append(name + <span class="string">&quot;    &quot;</span> + pwd + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    c.close();</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="数据交换形式-XML-JSON"><a href="#数据交换形式-XML-JSON" class="headerlink" title="数据交换形式 XML JSON"></a>数据交换形式 XML JSON</h4><h5 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h5><h6 id="使用XmlSerializer创建一个XML文件"><a href="#使用XmlSerializer创建一个XML文件" class="headerlink" title="使用XmlSerializer创建一个XML文件"></a>使用XmlSerializer创建一个XML文件</h6><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">XmlSerializer xml = <span class="module-access"><span class="module"><span class="identifier">Xml</span>.</span></span><span class="keyword">new</span><span class="constructor">Serializer()</span>;</span><br><span class="line">File file = <span class="keyword">new</span> <span class="constructor">File(Environment.<span class="params">getExternalStorageDirectory</span>()</span>,<span class="string">&quot;xmlfile.xml&quot;</span>);</span><br><span class="line">FileOutputStream fos= <span class="keyword">new</span> <span class="constructor">FileOutputStream(<span class="params">file</span>)</span>;</span><br><span class="line">xml.set<span class="constructor">Output(<span class="params">fos</span>,<span class="string">&quot;utf-8&quot;</span>)</span>;</span><br><span class="line">xml.start<span class="constructor">Document(<span class="string">&quot;utf-8&quot;</span>,<span class="params">true</span>)</span>;</span><br><span class="line">xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;register&quot;</span>)</span>;</span><br><span class="line"><span class="keyword">for</span>(UserBean user:<span class="built_in">list</span>)&#123;</span><br><span class="line">	xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;user&quot;</span>)</span>;</span><br><span class="line">	xml.attribute(null,<span class="string">&quot;id&quot;</span>,user.get<span class="constructor">Id()</span>+<span class="string">&quot;&quot;</span>);</span><br><span class="line">	xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;name&quot;</span>)</span>;</span><br><span class="line">	xml.text(user.get<span class="constructor">Name()</span>);</span><br><span class="line">	xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;name&quot;</span>)</span>;</span><br><span class="line">				</span><br><span class="line">	xml.start<span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;password&quot;</span>)</span>;</span><br><span class="line">	xml.text(user.get<span class="constructor">Password()</span>);</span><br><span class="line">	xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;password&quot;</span>)</span>;</span><br><span class="line">	xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>, <span class="string">&quot;user&quot;</span>)</span>;</span><br><span class="line">&#125;xml.<span class="keyword">end</span><span class="constructor">Tag(<span class="params">null</span>,<span class="string">&quot;register&quot;</span>)</span>;</span><br><span class="line">xml.<span class="keyword">end</span><span class="constructor">Document()</span>;</span><br><span class="line">fos.close<span class="literal">()</span>;</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Toast</span>.</span></span>make<span class="constructor">Text(<span class="params">getApplicationContext</span>()</span>,<span class="string">&quot;创建成功&quot;</span>, <span class="number">0</span>).show<span class="literal">()</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="使用XmlPushParser来解析一个SD卡中的Xml文件"><a href="#使用XmlPushParser来解析一个SD卡中的Xml文件" class="headerlink" title="使用XmlPushParser来解析一个SD卡中的Xml文件"></a>使用XmlPushParser来解析一个SD卡中的Xml文件</h6><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">XmlPullParser xml = <span class="module-access"><span class="module"><span class="identifier">Xml</span>.</span></span><span class="keyword">new</span><span class="constructor">PullParser()</span>;</span><br><span class="line">File file = <span class="keyword">new</span> <span class="constructor">File(Environment.<span class="params">getExternalStorageDirectory</span>()</span>,<span class="string">&quot;xmlfile.xml&quot;</span>);</span><br><span class="line">FileInputStream fis;</span><br><span class="line">fis = <span class="keyword">new</span> <span class="constructor">FileInputStream(<span class="params">file</span>)</span>;</span><br><span class="line">xml.set<span class="constructor">Input(<span class="params">fis</span>, <span class="string">&quot;utf-8&quot;</span>)</span>;</span><br><span class="line"><span class="built_in">int</span> <span class="keyword">type</span> = xml.get<span class="constructor">EventType()</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">type</span> != XmlPullParser.END_DOCUMENT) &#123;</span><br><span class="line">	switch (<span class="keyword">type</span>) &#123;</span><br><span class="line">		case XmlPullParser.START_TAG: &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="string">&quot;register&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;<span class="comment">// 如果遇到整个文档的开头那么创建一个链表</span></span><br><span class="line">			<span class="built_in">list</span> = <span class="keyword">new</span> ArrayList&lt;UserBean&gt;<span class="literal">()</span>;						&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;user&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;</span><br><span class="line">			user = <span class="keyword">new</span> <span class="constructor">UserBean()</span>;<span class="comment">// 如果遇到一个大项则创建一个UserBean</span></span><br><span class="line">			user.set<span class="constructor">Id(Integer.<span class="params">parseInt</span>(<span class="params">xml</span>.<span class="params">getAttributeValue</span>(0)</span>));</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;name&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;</span><br><span class="line">			user.set<span class="constructor">Name(<span class="params">xml</span>.<span class="params">nextText</span>()</span>);						</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;password&quot;</span>.equals(xml.get<span class="constructor">Name()</span>)) &#123;							</span><br><span class="line">            user.set<span class="constructor">Password(<span class="params">xml</span>.<span class="params">nextText</span>()</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		&#125;break;</span><br><span class="line">		case XmlPullParser.END_TAG: &#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="string">&quot;user&quot;</span>.equals(xml.get<span class="constructor">Name()</span>))&#123;<span class="built_in">list</span>.add(user);user = null;&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		default:break;</span><br><span class="line">		&#125;</span><br><span class="line">	 <span class="keyword">type</span> = xml.next<span class="literal">()</span>;</span><br><span class="line">&#125;</span><br><span class="line">fis.close<span class="literal">()</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="使用XmlResourceParser解析xml文件夹下的Xml文件"><a href="#使用XmlResourceParser解析xml文件夹下的Xml文件" class="headerlink" title="使用XmlResourceParser解析xml文件夹下的Xml文件"></a>使用XmlResourceParser解析xml文件夹下的Xml文件</h6><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">XmlResourceParser <span class="type">xml</span> = getResources().getXml(R.xml.xmlfile);</span><br><span class="line"><span class="type">int</span> <span class="keyword">type</span>;</span><br><span class="line"><span class="keyword">type</span> = <span class="type">xml</span>.getEventType();</span><br><span class="line"><span class="keyword">while</span>(<span class="keyword">type</span>!=XmlResourceParser.END_DOCUMENT)&#123;</span><br><span class="line">	switch (<span class="keyword">type</span>) &#123;</span><br><span class="line">		<span class="keyword">case</span> XmlResourceParser.START_TAG:&#123;</span><br><span class="line">			<span class="keyword">if</span>(&quot;register&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				list = <span class="built_in">new</span> ArrayList&lt;UserBean&gt;();</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(&quot;user&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				<span class="keyword">user</span> = <span class="built_in">new</span> UserBean();</span><br><span class="line">				<span class="keyword">user</span>.setId(<span class="type">Integer</span>.parseInt(<span class="type">xml</span>.getAttributeValue(<span class="number">0</span>)));</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(&quot;name&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				<span class="keyword">user</span>.setName(<span class="type">xml</span>.nextText());</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(&quot;password&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				<span class="keyword">user</span>.setPassword(<span class="type">xml</span>.nextText());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;break;</span><br><span class="line">						</span><br><span class="line">		<span class="keyword">case</span> XmlResourceParser.END_TAG:&#123;</span><br><span class="line">			<span class="keyword">if</span>(&quot;user&quot;.equals(<span class="type">xml</span>.getName()))&#123;</span><br><span class="line">				list.<span class="keyword">add</span>(<span class="keyword">user</span>);</span><br><span class="line">				<span class="keyword">user</span> = <span class="keyword">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">default</span>:break;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">type</span> = <span class="type">xml</span>.next();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h5><p>JSON: (JavaScript Object Notation )  JavaScript对象表示法,它是存储和交换文本信息的语法，类似XML,但是JSON比XML 更小、更快，更易解析，它具有如下特点:<br>1.它是轻量级的文本数据交换格式<br>2.它独立于语言和平台</p>
<p>JSON的具体语法以及使用可以查看JSON中国网站：<br><a target="_blank" rel="noopener" href="http://www.json.org.cn/">http://www.json.org.cn/</a></p>
<p>下面是来自JSON中国网站上的JSON格式文本的一个例子:<br>该部分学习通过创建和解析这个JSON格式文本来学习在Android中JSON的使用。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JSON中国&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.json.org.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;page&quot;</span><span class="punctuation">:</span> <span class="number">88</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;isNonProfit&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;street&quot;</span><span class="punctuation">:</span> <span class="string">&quot;浙大路38号.&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="string">&quot;浙江杭州&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;country&quot;</span><span class="punctuation">:</span> <span class="string">&quot;中国&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Google&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.google.com&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Baidu&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.baidu.com&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SoSo&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://www.SoSo.com&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="Android-JSON解析常用的类"><a href="#Android-JSON解析常用的类" class="headerlink" title="Android JSON解析常用的类"></a>Android JSON解析常用的类</h6><p>Android的json解析部分都在包org.json下，主要有以下几个类： </p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">JSON</span><span class="built_in">Object</span>：<span class="title class_">JSON</span>对象,其包含一对(<span class="title class_">Key</span>/<span class="title class_">Value</span>)数值。最外被大括号包裹，其中的<span class="title class_">Key</span>和<span class="title class_">Value</span>被冒号<span class="string">&quot;:&quot;</span>分隔。在<span class="title class_">Key</span>和<span class="title class_">Value</span>之间是以逗号<span class="string">&quot;,&quot;</span>分隔。例如：&#123;<span class="string">&quot;JSON&quot;</span>: <span class="string">&quot;Hello, World&quot;</span>&#125;， <span class="title class_">Value</span>的类型包括：<span class="title class_">Boolean</span>、<span class="title class_">JSON</span><span class="built_in">Array</span>、<span class="title class_">JSON</span><span class="built_in">Object</span>、<span class="title class_">Number</span>、<span class="title class_">String</span>或者默认值<span class="title class_">JSON</span><span class="built_in">Object</span>.<span class="property">NULL</span>。</span><br><span class="line"><span class="title class_">JSON</span>Stringer：<span class="title class_">JSON</span>文本构建类 ，这个类可以帮助快速和便捷的创建<span class="title class_">JSON</span> text。其最大的优点在于可以减少由于格式的错误导致程序异常，引用这个类可以自动严格按照<span class="title class_">JSON</span>语法规则创建<span class="title class_">JSON</span> text。每个<span class="title class_">JSON</span>Stringer实体只能对应创建一个<span class="title class_">JSON</span> text。.</span><br><span class="line"><span class="title class_">JSON</span><span class="built_in">Array</span>：它代表一组有序的数值。数值以逗号”,”分隔（例如 [value1,value2,value3]。它的内部具有查询行为，<span class="title function_">get</span>()和<span class="title function_">opt</span>()两种方法都可以通过index索引返回指定的数值，<span class="title function_">put</span>()方法用来添加或者替换数值。同样这个类的value类型可以包括：<span class="title class_">Boolean</span>、<span class="title class_">JSON</span><span class="built_in">Array</span>、<span class="title class_">JSON</span><span class="built_in">Object</span>、<span class="title class_">Number</span>、<span class="title class_">String</span>或者默认值<span class="title class_">JSON</span><span class="built_in">Object</span>.<span class="property">NULL</span> <span class="built_in">object</span>。</span><br><span class="line"><span class="title class_">JSON</span>Tokener：<span class="title class_">Json</span>解析类 </span><br><span class="line"><span class="title class_">JSON</span>Exception：<span class="title class_">Json</span>用到的异常类 </span><br></pre></td></tr></table></figure>
<h6 id="创建JSON文件"><a href="#创建JSON文件" class="headerlink" title="创建JSON文件"></a>创建JSON文件</h6><p>下面为在SD卡根目录下使用JSONObject, JSONArray来创建上面提到的JSON文件的主要源码：</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">File jsonFile = <span class="keyword">new</span> <span class="constructor">File(Environment.<span class="params">getExternalStorageDirectory</span>()</span>,<span class="string">&quot;json.txt&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!jsonFile.exists<span class="literal">()</span>) &#123;</span><br><span class="line">    jsonFile.create<span class="constructor">NewFile()</span>;</span><br><span class="line">    JSONObject jsonRoot = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line"></span><br><span class="line">    jsonRoot.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;JSON中国&quot;</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;url&quot;</span>,<span class="string">&quot;http://www.json.org.cn&quot;</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;page&quot;</span>, <span class="number">88</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;isNonProfit&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    JSONObject address = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    address.put(<span class="string">&quot;street&quot;</span>, <span class="string">&quot;浙大路38号&quot;</span>);</span><br><span class="line">    address.put(<span class="string">&quot;city&quot;</span>, <span class="string">&quot;浙江杭州&quot;</span>);</span><br><span class="line">    address.put(<span class="string">&quot;country&quot;</span>, <span class="string">&quot;中国&quot;</span>);</span><br><span class="line">    jsonRoot.put(<span class="string">&quot;address&quot;</span>, address);</span><br><span class="line"></span><br><span class="line">    JSONArray <span class="built_in">array</span> = <span class="keyword">new</span> <span class="constructor">JSONArray()</span>;</span><br><span class="line">    JSONObject gooleWebsite = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    gooleWebsite.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Google&quot;</span>);</span><br><span class="line">    gooleWebsite.put(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;http://www.google.com&quot;</span>);</span><br><span class="line">    <span class="built_in">array</span>.put(gooleWebsite);</span><br><span class="line"></span><br><span class="line">    JSONObject baiduWebsite = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    baiduWebsite.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Baidu&quot;</span>);</span><br><span class="line">    baiduWebsite.put(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;http://www.baidu.com&quot;</span>);</span><br><span class="line">    <span class="built_in">array</span>.put(baiduWebsite);</span><br><span class="line"></span><br><span class="line">    JSONObject sosoWebsite = <span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">    sosoWebsite.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;SoSo&quot;</span>);</span><br><span class="line">    sosoWebsite.put(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;http://www.SoSo.com&quot;</span>);</span><br><span class="line">    <span class="built_in">array</span>.put(sosoWebsite);</span><br><span class="line"></span><br><span class="line">    jsonRoot.put(<span class="string">&quot;links&quot;</span>, <span class="built_in">array</span>);</span><br><span class="line"></span><br><span class="line">    FileOutputStream out = <span class="keyword">new</span> <span class="constructor">FileOutputStream(<span class="params">jsonFile</span>)</span>;</span><br><span class="line">    OutputStreamWriter writer = <span class="keyword">new</span> <span class="constructor">OutputStreamWriter(<span class="params">out</span>)</span>;</span><br><span class="line">    BufferedWriter bw = <span class="keyword">new</span> <span class="constructor">BufferedWriter(<span class="params">writer</span>)</span>;</span><br><span class="line">    bw.write(jsonRoot.<span class="keyword">to</span><span class="constructor">String()</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="解析JSON格式的文件"><a href="#解析JSON格式的文件" class="headerlink" title="解析JSON格式的文件"></a>解析JSON格式的文件</h6><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">InputStreamReader reader = <span class="keyword">new</span> <span class="constructor">InputStreamReader(<span class="params">new</span> FileInputStream(<span class="params">jsonFiles</span>)</span>);</span><br><span class="line">BufferedReader br = <span class="keyword">new</span> <span class="constructor">BufferedReader(<span class="params">reader</span>)</span>;</span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> <span class="constructor">StringBuilder()</span>;</span><br><span class="line">String line = null;</span><br><span class="line"><span class="keyword">while</span>((line = br.read<span class="constructor">Line()</span>)!=null)&#123;</span><br><span class="line">    sb.append(line+<span class="character">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">JSONObject jsonsroot = <span class="keyword">new</span> <span class="constructor">JSONObject(<span class="params">sb</span>.<span class="params">toString</span>()</span>);</span><br><span class="line">String name = jsonsroot.get<span class="constructor">String(<span class="string">&quot;name&quot;</span>)</span>;</span><br><span class="line">String url = jsonsroot.get<span class="constructor">String(<span class="string">&quot;url&quot;</span>)</span>;</span><br><span class="line"><span class="built_in">int</span> page = jsonsroot.get<span class="constructor">Int(<span class="string">&quot;page&quot;</span>)</span>;</span><br><span class="line">Boolean isNonProfit = jsonsroot.get<span class="constructor">Boolean(<span class="string">&quot;isNonProfit&quot;</span>)</span>;</span><br><span class="line"></span><br><span class="line">JSONObject address = jsonsroot.get<span class="constructor">JSONObject(<span class="string">&quot;address&quot;</span>)</span>;</span><br><span class="line">String street = address.get<span class="constructor">String(<span class="string">&quot;street&quot;</span>)</span>; </span><br><span class="line">String city = address.get<span class="constructor">String(<span class="string">&quot;city&quot;</span>)</span>; </span><br><span class="line">String country = address.get<span class="constructor">String(<span class="string">&quot;country&quot;</span>)</span>; </span><br><span class="line"></span><br><span class="line">JSONArray links = jsonsroot.get<span class="constructor">JSONArray(<span class="string">&quot;links&quot;</span>)</span>;</span><br><span class="line">Links linkArray<span class="literal">[]</span> = <span class="keyword">new</span> Links<span class="literal">[<span class="identifier">links</span>.<span class="identifier">length</span>()]</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> looper=<span class="number">0</span>;looper&lt;links.length<span class="literal">()</span>;looper++)&#123;</span><br><span class="line">    JSONObject Obj = links.get<span class="constructor">JSONObject(<span class="params">looper</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    linkArray<span class="literal">[<span class="identifier">looper</span>]</span> = <span class="keyword">new</span> <span class="constructor">Links()</span>;</span><br><span class="line">    linkArray<span class="literal">[<span class="identifier">looper</span>]</span>.set<span class="constructor">Name(Obj.<span class="params">getString</span>(<span class="string">&quot;name&quot;</span>)</span>);</span><br><span class="line">    linkArray<span class="literal">[<span class="identifier">looper</span>]</span>.set<span class="constructor">Url(Obj.<span class="params">getString</span>(<span class="string">&quot;url&quot;</span>)</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String result = <span class="string">&quot;name:&quot;</span>+name+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;url:&quot;</span>+url+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;page:&quot;</span>+page+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;isNonProfit:&quot;</span>+isNonProfit+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;street:&quot;</span>+street+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;city:&quot;</span>+city+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;country:&quot;</span>+country+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;linkArray[0].name:&quot;</span>+linkArray<span class="literal">[<span class="number">0</span>]</span>.get<span class="constructor">Name()</span>+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;linkArray[0].url:&quot;</span>+linkArray<span class="literal">[<span class="number">0</span>]</span>.get<span class="constructor">Url()</span>+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;linkArray[1].name:&quot;</span>+linkArray<span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">Name()</span>+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;linkArray[1].url:&quot;</span>+linkArray<span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">Url()</span>+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        +<span class="string">&quot;linkArray[2].name:&quot;</span>+linkArray<span class="literal">[<span class="number">2</span>]</span>.get<span class="constructor">Name()</span>+<span class="character">&#x27;\n&#x27;</span>+<span class="string">&quot;linkArray[2].url:&quot;</span>+linkArray<span class="literal">[<span class="number">2</span>]</span>.get<span class="constructor">Url()</span>+<span class="character">&#x27;\n&#x27;</span></span><br><span class="line">        ;</span><br><span class="line">mShowJsonTv.set<span class="constructor">Text(<span class="params">result</span>)</span>;</span><br></pre></td></tr></table></figure>
























  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android%E5%88%9D%E6%AD%A5/">Android初步</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>



</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2016/04/01/Android-初步之ListView/" title="Android 初步之Adapter 与 ListView">
  <span>
  Android 初步之Adapter 与 ListView</span>
</a>
</div>


<div class="next">
<a href="/2016/03/30/Android-初步之资源的使用/"  title="Android 初步之资源的使用">
 <span>Android 初步之资源的使用
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2016/03/31/Android-初步之数据存储/" data-title="Android 初步之数据存储" data-url="http://yoursite.com/2016/03/31/Android-%E5%88%9D%E6%AD%A5%E4%B9%8B%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/"></div>
</section>


<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#SharedPreferences"><span class="toc-number">1.</span> <span class="toc-text">SharedPreferences</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SharedPreferences%E7%9A%84%E8%8E%B7%E5%8F%96%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">SharedPreferences的获取：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%91SharedPreferences%E7%B1%BB%E4%B8%AD%E5%A2%9E%E5%8A%A0%E5%80%BC%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">向SharedPreferences类中增加值：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%99%E5%85%A5sharedPreferences"><span class="toc-number">1.3.</span> <span class="toc-text">写入sharedPreferences</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%87%BAsharedPreferences"><span class="toc-number">1.4.</span> <span class="toc-text">读出sharedPreferences</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.5.</span> <span class="toc-text">数据存储模式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Preference-Activity"><span class="toc-number">2.</span> <span class="toc-text">Preference Activity</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Preference-Activity-%E7%BB%84%E6%88%90"><span class="toc-number">2.0.1.</span> <span class="toc-text">Preference Activity 组成</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAPreference-Activity"><span class="toc-number">2.0.2.</span> <span class="toc-text">实现一个Preference Activity</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FILE-%E6%96%87%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">FILE 文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8raw%E6%96%87%E4%BB%B6%E4%BD%9C%E4%B8%BA%E8%B5%84%E6%BA%90"><span class="toc-number">3.1.</span> <span class="toc-text">使用raw文件作为资源</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQLite-Content-Provider"><span class="toc-number">4.</span> <span class="toc-text">SQLite + Content Provider</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SQLite%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.1.</span> <span class="toc-text">SQLite数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.2.</span> <span class="toc-text">创建数据库</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E6%89%80%E9%9C%80%E7%9A%84%E8%BE%85%E5%8A%A9%E5%B8%B8%E9%87%8F"><span class="toc-number">4.3.</span> <span class="toc-text">创建数据库所需的辅助常量</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E7%B1%BB"><span class="toc-number">4.4.</span> <span class="toc-text">创建数据库操作类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Cursor"><span class="toc-number">4.5.</span> <span class="toc-text">Cursor</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Content-Provider-%E5%86%85%E5%AE%B9%E6%8F%90%E4%BE%9B%E8%80%85"><span class="toc-number">4.6.</span> <span class="toc-text">Content Provider 内容提供者</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Content-Provider"><span class="toc-number">4.7.</span> <span class="toc-text">自定义Content Provider</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Content-Resolver"><span class="toc-number">5.</span> <span class="toc-text">Content Resolver</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Content-Resolver%E8%AE%BF%E9%97%AE%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84Provider"><span class="toc-number">5.1.</span> <span class="toc-text">使用Content Resolver访问自定义的Provider</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8CursorLoader%E5%AE%9E%E7%8E%B0%E5%BC%82%E6%AD%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.</span> <span class="toc-text">使用CursorLoader实现异步查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2%E5%BD%A2%E5%BC%8F-XML-JSON"><span class="toc-number">7.</span> <span class="toc-text">数据交换形式 XML JSON</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#XML"><span class="toc-number">7.1.</span> <span class="toc-text">XML</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8XmlSerializer%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAXML%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.1.</span> <span class="toc-text">使用XmlSerializer创建一个XML文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8XmlPushParser%E6%9D%A5%E8%A7%A3%E6%9E%90%E4%B8%80%E4%B8%AASD%E5%8D%A1%E4%B8%AD%E7%9A%84Xml%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.2.</span> <span class="toc-text">使用XmlPushParser来解析一个SD卡中的Xml文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8XmlResourceParser%E8%A7%A3%E6%9E%90xml%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84Xml%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.3.</span> <span class="toc-text">使用XmlResourceParser解析xml文件夹下的Xml文件</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JSON"><span class="toc-number">7.2.</span> <span class="toc-text">JSON</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Android-JSON%E8%A7%A3%E6%9E%90%E5%B8%B8%E7%94%A8%E7%9A%84%E7%B1%BB"><span class="toc-number">7.2.1.</span> <span class="toc-text">Android JSON解析常用的类</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAJSON%E6%96%87%E4%BB%B6"><span class="toc-number">7.2.2.</span> <span class="toc-text">创建JSON文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90JSON%E6%A0%BC%E5%BC%8F%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">7.2.3.</span> <span class="toc-text">解析JSON格式的文件</span></a></li></ol></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">
<div id="authorInfo">
	
		<div class="author-img"></div>		
	
	<div class="social-info" class="clearfix">
		
		
		<a href="https://github.com/tbfungeek" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		
		<a href="mailto:tbfungeek@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		

	</div>
</div>

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Android-小经验/" title="Android 小经验">Android 小经验<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android-源码分析/" title="Android 源码分析">Android 源码分析<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android其他/" title="Android其他">Android其他<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android初步/" title="Android初步">Android初步<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/Android进阶/" title="Android进阶">Android进阶<sup>100</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hexo-使用/" title="Hexo 使用">Hexo 使用<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/JavaScript理论/" title="JavaScript理论">JavaScript理论<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Objective-C-相关/" title="Objective C 相关">Objective C 相关<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/OpenCV/" title="OpenCV">OpenCV<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/ROS/" title="ROS">ROS<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-工具使用/" title="iOS 工具使用">iOS 工具使用<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-开源库分析/" title="iOS 开源库分析">iOS 开源库分析<sup>36</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-理论基础/" title="iOS 理论基础">iOS 理论基础<sup>14</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS-进阶/" title="iOS 进阶">iOS 进阶<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/个人收藏/" title="个人收藏">个人收藏<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/代码规范/" title="代码规范">代码规范<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/其他/" title="其他">其他<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/博客分类目录/" title="博客分类目录">博客分类目录<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/叨叨系列/" title="叨叨系列">叨叨系列<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/开源代码分析/" title="开源代码分析">开源代码分析<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/开源库分析/" title="开源库分析">开源库分析<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/树莓派/" title="树莓派">树莓派<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/版本控制/" title="版本控制">版本控制<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/直播/" title="直播">直播<sup>6</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/iOS-开源库分析/" title="iOS 开源库分析">iOS 开源库分析<sup>36</sup></a></li>
			
		
			
				<li><a href="/tags/Android-设计模式/" title="Android 设计模式">Android 设计模式<sup>29</sup></a></li>
			
		
			
				<li><a href="/tags/Objective-C-相关/" title="Objective C 相关">Objective C 相关<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/Android基础/" title="Android基础">Android基础<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/AOSP-源码/" title="AOSP 源码">AOSP 源码<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/Android-常用第三方库/" title="Android 常用第三方库">Android 常用第三方库<sup>15</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-理论基础/" title="iOS 理论基础">iOS 理论基础<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo-使用/" title="Hexo 使用">Hexo 使用<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/ROS/" title="ROS">ROS<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Android-动画进阶/" title="Android 动画进阶">Android 动画进阶<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Android-JNI/" title="Android JNI">Android JNI<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-绘图进阶/" title="Android 绘图进阶">Android 绘图进阶<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android性能优化/" title="Android性能优化">Android性能优化<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-自动化测试/" title="Android 自动化测试">Android 自动化测试<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/OpenCV/" title="OpenCV">OpenCV<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/直播/" title="直播">直播<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Android-开源源码/" title="Android 开源源码">Android 开源源码<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Android-自定义View进阶/" title="Android 自定义View进阶">Android 自定义View进阶<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/树莓派/" title="树莓派">树莓派<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/iOS-进阶/" title="iOS 进阶">iOS 进阶<sup>4</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://hexo.io" target="_blank" title="Hexo">Hexo</a>
            
          </li>
        
          <li>
            
            	<a href="https://pages.github.com/" target="_blank" title="GitHub">GitHub</a>
            
          </li>
        
          <li>
            
            	<a href="http://pf18.github.io/" target="_blank" title="PF18">PF18</a>
            
          </li>
        
          <li>
            
            	<a href="http://toutiao.io/" target="_blank" title="开发者头条">开发者头条</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.jcodecraeer.com/" target="_blank" title="泡在网上的日子">泡在网上的日子</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="atom.xml" target="_blank" title="rss">RSS</a>
</div>

  
  <div class="tagcloudlist">
    <p class="asidetitle">Tag Cloud</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/AOSP-%E6%BA%90%E7%A0%81/" style="font-size: 17.14px;">AOSP 源码</a> <a href="/tags/Android-APK-%E7%AD%BE%E5%90%8D/" style="font-size: 10px;">Android APK 签名</a> <a href="/tags/Android-JNI/" style="font-size: 12.86px;">Android JNI</a> <a href="/tags/Android-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E8%BF%9B%E9%98%B6/" style="font-size: 10.71px;">Android 事件处理进阶</a> <a href="/tags/Android-%E5%8A%A8%E7%94%BB%E8%BF%9B%E9%98%B6/" style="font-size: 13.57px;">Android 动画进阶</a> <a href="/tags/Android-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%BC%80%E5%8F%91/" style="font-size: 10px;">Android 多线程开发</a> <a href="/tags/Android-%E5%B0%8F%E7%BB%8F%E9%AA%8C/" style="font-size: 10px;">Android 小经验</a> <a href="/tags/Android-%E5%B8%B8%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/" style="font-size: 16.43px;">Android 常用第三方库</a> <a href="/tags/Android-%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" style="font-size: 10px;">Android 开发流程</a> <a href="/tags/Android-%E5%BC%80%E6%BA%90%E6%BA%90%E7%A0%81/" style="font-size: 12.14px;">Android 开源源码</a> <a href="/tags/Android-%E7%BB%98%E5%9B%BE%E8%BF%9B%E9%98%B6/" style="font-size: 12.86px;">Android 绘图进阶</a> <a href="/tags/Android-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" style="font-size: 12.86px;">Android 自动化测试</a> <a href="/tags/Android-%E8%87%AA%E5%AE%9A%E4%B9%89View%E8%BF%9B%E9%98%B6/" style="font-size: 12.14px;">Android 自定义View进阶</a> <a href="/tags/Android-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 19.29px;">Android 设计模式</a> <a href="/tags/Android%E5%85%B6%E4%BB%96/" style="font-size: 10px;">Android其他</a> <a href="/tags/Android%E5%9F%BA%E7%A1%80/" style="font-size: 17.86px;">Android基础</a> <a href="/tags/Android%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" style="font-size: 10px;">Android开发流程</a> <a href="/tags/Android%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" style="font-size: 12.86px;">Android性能优化</a> <a href="/tags/Android%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF/" style="font-size: 10px;">Android混淆技术</a> <a href="/tags/Android%E8%B4%A8%E9%87%8F%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/" style="font-size: 11.43px;">Android质量管理工具</a> <a href="/tags/Android%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" style="font-size: 10px;">Android逆向工程</a> <a href="/tags/Git-github/" style="font-size: 10px;">Git && github</a> <a href="/tags/Hexo-%E4%BD%BF%E7%94%A8/" style="font-size: 15px;">Hexo 使用</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Linux-%E4%BD%BF%E7%94%A8/" style="font-size: 10px;">Linux 使用</a> <a href="/tags/Objective-C-%E7%9B%B8%E5%85%B3/" style="font-size: 18.57px;">Objective C 相关</a> <a href="/tags/OpenCV/" style="font-size: 12.86px;">OpenCV</a> <a href="/tags/ROS/" style="font-size: 14.29px;">ROS</a> <a href="/tags/iOS-%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" style="font-size: 10.71px;">iOS 工具使用</a> <a href="/tags/iOS-%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%86%E6%9E%90/" style="font-size: 20px;">iOS 开源库分析</a> <a href="/tags/iOS-%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80/" style="font-size: 15.71px;">iOS 理论基础</a> <a href="/tags/iOS-%E8%BF%9B%E9%98%B6/" style="font-size: 12.14px;">iOS 进阶</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 10px;">代码规范</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%88%86%E7%B1%BB%E7%9B%AE%E5%BD%95/" style="font-size: 10.71px;">博客分类目录</a> <a href="/tags/%E5%8F%A8%E5%8F%A8%E7%B3%BB%E5%88%97/" style="font-size: 10px;">叨叨系列</a> <a href="/tags/%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" style="font-size: 11.43px;">工具的使用</a> <a href="/tags/%E5%BC%80%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 10.71px;">开源代码分析</a> <a href="/tags/%E5%BC%80%E6%BA%90%E5%BA%93%E5%88%86%E6%9E%90/" style="font-size: 10px;">开源库分析</a> <a href="/tags/%E6%9D%82%E7%B1%BB/" style="font-size: 10px;">杂类</a> <a href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" style="font-size: 12.14px;">树莓派</a> <a href="/tags/%E7%9B%B4%E6%92%AD/" style="font-size: 12.86px;">直播</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7/" style="font-size: 10.71px;">编程技巧</a> <a href="/tags/%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F/" style="font-size: 10px;">网站收藏</a> <a href="/tags/%E9%87%8D%E8%A6%81%E6%8E%A7%E4%BB%B6/" style="font-size: 11.43px;">重要控件</a>
    </div>
  </div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
		
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/hsihohuang/kiddochan" target="_blank" title="Kiddochan">Kiddochan</a> © 2022 
		
		<a href="/about" target="_blank" title="Edgar">Edgar</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          c.click();
        }
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"tbfungeek"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 


<script type="text/javascript">

var disqus_shortname = 'tbfungeek';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7c9443b0374f1cf6b1dbb5ab84d939cb";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
